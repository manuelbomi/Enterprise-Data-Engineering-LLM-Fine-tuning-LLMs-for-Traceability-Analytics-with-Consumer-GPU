[
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple TV+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10192 used Paramount+ on Game Console under the Basic plan costing $16.73 in region BR.",
    "output": {
      "customer_id": "CUST-10192",
      "service_name": "Paramount+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 16.73,
      "device_type": "Game Console",
      "region": "BR",
      "usage_hours": 10.91,
      "event_timestamp": "2024-08-16T05:00:08"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "14x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_paramount+_stream",
      "description": "Real-time streaming pipeline for Paramount+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Spotify subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_spotify_agg",
      "description": "Weekly aggregation pipeline for Spotify metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_apple_music_stream",
      "description": "Real-time streaming pipeline for Apple Music events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process YouTube Premium subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_youtube_premium_legacy",
      "description": "Migration pipeline for legacy YouTube Premium data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10374 used Amazon Prime Video on Desktop under the Family plan costing $7.39 in region CA.",
    "output": {
      "customer_id": "CUST-10374",
      "service_name": "Amazon Prime Video",
      "subscription_plan": "Family",
      "monthly_price_usd": 7.39,
      "device_type": "Desktop",
      "region": "CA",
      "usage_hours": 6.01,
      "event_timestamp": "2024-09-02T16:31:16"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10187 used Netflix on Laptop under the Basic plan costing $28.33 in region IT.",
    "output": {
      "customer_id": "CUST-10187",
      "service_name": "Netflix",
      "subscription_plan": "Basic",
      "monthly_price_usd": 28.33,
      "device_type": "Laptop",
      "region": "IT",
      "usage_hours": 10.56,
      "event_timestamp": "2024-06-18T17:11:17"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple TV+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Amazon Prime Video subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_amazon_prime_video_legacy",
      "description": "Migration pipeline for legacy Amazon Prime Video data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "14x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10124 used Twitch on Game Console under the Family plan costing $21.35 in region CA.",
    "output": {
      "customer_id": "CUST-10124",
      "service_name": "Twitch",
      "subscription_plan": "Family",
      "monthly_price_usd": 21.35,
      "device_type": "Game Console",
      "region": "CA",
      "usage_hours": 11.89,
      "event_timestamp": "2024-12-02T11:40:19"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Disney+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_apple_music_stream",
      "description": "Real-time streaming pipeline for Apple Music events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10011 used Crunchyroll on Smart TV under the Family plan costing $17.66 in region DE.",
    "output": {
      "customer_id": "CUST-10011",
      "service_name": "Crunchyroll",
      "subscription_plan": "Family",
      "monthly_price_usd": 17.66,
      "device_type": "Smart TV",
      "region": "DE",
      "usage_hours": 7.2,
      "event_timestamp": "2024-11-26T06:06:57"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process HBO Max subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_hbo_max_agg",
      "description": "Weekly aggregation pipeline for HBO Max metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10193 used Paramount+ on Laptop under the Premium plan costing $26.89 in region FR.",
    "output": {
      "customer_id": "CUST-10193",
      "service_name": "Paramount+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 26.89,
      "device_type": "Laptop",
      "region": "FR",
      "usage_hours": 1.01,
      "event_timestamp": "2024-11-25T00:29:41"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process YouTube Premium subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_youtube_premium_legacy",
      "description": "Migration pipeline for legacy YouTube Premium data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple TV+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_netflix_legacy",
      "description": "Migration pipeline for legacy Netflix data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Amazon Prime Video subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_amazon_prime_video_legacy",
      "description": "Migration pipeline for legacy Amazon Prime Video data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10037 used Peacock on Smart TV under the Premium plan costing $29.59 in region JP.",
    "output": {
      "customer_id": "CUST-10037",
      "service_name": "Peacock",
      "subscription_plan": "Premium",
      "monthly_price_usd": 29.59,
      "device_type": "Smart TV",
      "region": "JP",
      "usage_hours": 11.24,
      "event_timestamp": "2024-01-11T10:44:53"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10164 used Apple TV+ on Desktop under the Basic plan costing $5.74 in region AU.",
    "output": {
      "customer_id": "CUST-10164",
      "service_name": "Apple TV+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 5.74,
      "device_type": "Desktop",
      "region": "AU",
      "usage_hours": 5.9,
      "event_timestamp": "2024-07-17T22:09:17"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10021 used Hulu on Laptop under the Premium plan costing $27.87 in region IN.",
    "output": {
      "customer_id": "CUST-10021",
      "service_name": "Hulu",
      "subscription_plan": "Premium",
      "monthly_price_usd": 27.87,
      "device_type": "Laptop",
      "region": "IN",
      "usage_hours": 3.81,
      "event_timestamp": "2024-05-21T17:02:42"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple TV+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process HBO Max subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_hbo_max_stream",
      "description": "Real-time streaming pipeline for HBO Max events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process HBO Max subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_hbo_max_legacy",
      "description": "Migration pipeline for legacy HBO Max data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Disney+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_disney+_legacy",
      "description": "Migration pipeline for legacy Disney+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "14x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple TV+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Disney+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Peacock subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_hulu_stream",
      "description": "Real-time streaming pipeline for Hulu events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10067 used Discovery+ on Game Console under the Family plan costing $23.95 in region IT.",
    "output": {
      "customer_id": "CUST-10067",
      "service_name": "Discovery+",
      "subscription_plan": "Family",
      "monthly_price_usd": 23.95,
      "device_type": "Game Console",
      "region": "IT",
      "usage_hours": 3.75,
      "event_timestamp": "2024-10-21T04:08:17"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_apple_music_legacy",
      "description": "Migration pipeline for legacy Apple Music data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple TV+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking HBO Max subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "7x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10033 used Hulu on Mobile under the Student plan costing $12.94 in region CN.",
    "output": {
      "customer_id": "CUST-10033",
      "service_name": "Hulu",
      "subscription_plan": "Student",
      "monthly_price_usd": 12.94,
      "device_type": "Mobile",
      "region": "CN",
      "usage_hours": 6.14,
      "event_timestamp": "2024-10-24T05:35:38"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_paramount+_stream",
      "description": "Real-time streaming pipeline for Paramount+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10341 used YouTube Premium on Smart TV under the Student plan costing $28.38 in region MX.",
    "output": {
      "customer_id": "CUST-10341",
      "service_name": "YouTube Premium",
      "subscription_plan": "Student",
      "monthly_price_usd": 28.38,
      "device_type": "Smart TV",
      "region": "MX",
      "usage_hours": 4.9,
      "event_timestamp": "2024-06-10T22:59:29"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_netflix_legacy",
      "description": "Migration pipeline for legacy Netflix data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_paramount+_agg",
      "description": "Weekly aggregation pipeline for Paramount+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_netflix_legacy",
      "description": "Migration pipeline for legacy Netflix data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_paramount+_stream",
      "description": "Real-time streaming pipeline for Paramount+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10134 used Discovery+ on Tablet under the Student plan costing $18.19 in region US.",
    "output": {
      "customer_id": "CUST-10134",
      "service_name": "Discovery+",
      "subscription_plan": "Student",
      "monthly_price_usd": 18.19,
      "device_type": "Tablet",
      "region": "US",
      "usage_hours": 8.11,
      "event_timestamp": "2024-04-28T12:37:35"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_paramount+_etl",
      "description": "Daily ETL pipeline for Paramount+ subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10326 used HBO Max on Game Console under the Family plan costing $17.27 in region CA.",
    "output": {
      "customer_id": "CUST-10326",
      "service_name": "HBO Max",
      "subscription_plan": "Family",
      "monthly_price_usd": 17.27,
      "device_type": "Game Console",
      "region": "CA",
      "usage_hours": 10.55,
      "event_timestamp": "2024-06-20T10:33:52"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10287 used Spotify on Tablet under the Annual plan costing $10.78 in region MX.",
    "output": {
      "customer_id": "CUST-10287",
      "service_name": "Spotify",
      "subscription_plan": "Annual",
      "monthly_price_usd": 10.78,
      "device_type": "Tablet",
      "region": "MX",
      "usage_hours": 8.49,
      "event_timestamp": "2024-07-01T21:01:42"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10216 used Discovery+ on Smart TV under the Annual plan costing $18.46 in region MX.",
    "output": {
      "customer_id": "CUST-10216",
      "service_name": "Discovery+",
      "subscription_plan": "Annual",
      "monthly_price_usd": 18.46,
      "device_type": "Smart TV",
      "region": "MX",
      "usage_hours": 3.69,
      "event_timestamp": "2024-09-22T00:31:22"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10158 used Amazon Prime Video on Smart TV under the Student plan costing $24.42 in region UK.",
    "output": {
      "customer_id": "CUST-10158",
      "service_name": "Amazon Prime Video",
      "subscription_plan": "Student",
      "monthly_price_usd": 24.42,
      "device_type": "Smart TV",
      "region": "UK",
      "usage_hours": 8.34,
      "event_timestamp": "2024-01-19T02:13:29"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10397 used Crunchyroll on Game Console under the Basic plan costing $27.79 in region MX.",
    "output": {
      "customer_id": "CUST-10397",
      "service_name": "Crunchyroll",
      "subscription_plan": "Basic",
      "monthly_price_usd": 27.79,
      "device_type": "Game Console",
      "region": "MX",
      "usage_hours": 0.63,
      "event_timestamp": "2024-03-14T03:59:55"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Amazon Prime Video subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_amazon_prime_video_stream",
      "description": "Real-time streaming pipeline for Amazon Prime Video events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10010 used Twitch on Laptop under the Premium plan costing $6.12 in region BR.",
    "output": {
      "customer_id": "CUST-10010",
      "service_name": "Twitch",
      "subscription_plan": "Premium",
      "monthly_price_usd": 6.12,
      "device_type": "Laptop",
      "region": "BR",
      "usage_hours": 9.08,
      "event_timestamp": "2024-06-12T13:48:39"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Spotify subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_spotify_agg",
      "description": "Weekly aggregation pipeline for Spotify metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking HBO Max subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10142 used Peacock on Tablet under the Basic plan costing $13.58 in region KR.",
    "output": {
      "customer_id": "CUST-10142",
      "service_name": "Peacock",
      "subscription_plan": "Basic",
      "monthly_price_usd": 13.58,
      "device_type": "Tablet",
      "region": "KR",
      "usage_hours": 5.94,
      "event_timestamp": "2024-06-17T04:16:37"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10198 used Apple TV+ on Desktop under the Annual plan costing $15.68 in region IT.",
    "output": {
      "customer_id": "CUST-10198",
      "service_name": "Apple TV+",
      "subscription_plan": "Annual",
      "monthly_price_usd": 15.68,
      "device_type": "Desktop",
      "region": "IT",
      "usage_hours": 11.01,
      "event_timestamp": "2024-06-04T21:06:52"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10205 used Apple TV+ on Desktop under the Basic plan costing $11.60 in region US.",
    "output": {
      "customer_id": "CUST-10205",
      "service_name": "Apple TV+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 11.6,
      "device_type": "Desktop",
      "region": "US",
      "usage_hours": 11.26,
      "event_timestamp": "2024-03-14T03:35:04"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process ESPN+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_espn+_stream",
      "description": "Real-time streaming pipeline for ESPN+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10230 used Amazon Prime Video on Tablet under the Basic plan costing $25.70 in region BR.",
    "output": {
      "customer_id": "CUST-10230",
      "service_name": "Amazon Prime Video",
      "subscription_plan": "Basic",
      "monthly_price_usd": 25.7,
      "device_type": "Tablet",
      "region": "BR",
      "usage_hours": 2.85,
      "event_timestamp": "2024-07-18T19:22:40"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10170 used Amazon Prime Video on Smart TV under the Annual plan costing $5.73 in region US.",
    "output": {
      "customer_id": "CUST-10170",
      "service_name": "Amazon Prime Video",
      "subscription_plan": "Annual",
      "monthly_price_usd": 5.73,
      "device_type": "Smart TV",
      "region": "US",
      "usage_hours": 1.02,
      "event_timestamp": "2024-08-19T09:01:41"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "12x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Hulu subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking ESPN+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10226 used Crunchyroll on Game Console under the Basic plan costing $19.57 in region IN.",
    "output": {
      "customer_id": "CUST-10226",
      "service_name": "Crunchyroll",
      "subscription_plan": "Basic",
      "monthly_price_usd": 19.57,
      "device_type": "Game Console",
      "region": "IN",
      "usage_hours": 5.48,
      "event_timestamp": "2024-02-02T21:21:14"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Twitch subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_twitch_etl",
      "description": "Daily ETL pipeline for Twitch subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Spotify subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_spotify_legacy",
      "description": "Migration pipeline for legacy Spotify data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10218 used Paramount+ on Smart TV under the Premium plan costing $15.42 in region ES.",
    "output": {
      "customer_id": "CUST-10218",
      "service_name": "Paramount+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 15.42,
      "device_type": "Smart TV",
      "region": "ES",
      "usage_hours": 0.63,
      "event_timestamp": "2024-02-01T22:39:50"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10176 used Amazon Prime Video on Game Console under the Family plan costing $24.35 in region JP.",
    "output": {
      "customer_id": "CUST-10176",
      "service_name": "Amazon Prime Video",
      "subscription_plan": "Family",
      "monthly_price_usd": 24.35,
      "device_type": "Game Console",
      "region": "JP",
      "usage_hours": 7.09,
      "event_timestamp": "2024-03-02T13:43:06"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "7x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process HBO Max subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_hbo_max_etl",
      "description": "Daily ETL pipeline for HBO Max subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10060 used YouTube Premium on Desktop under the Basic plan costing $14.38 in region CA.",
    "output": {
      "customer_id": "CUST-10060",
      "service_name": "YouTube Premium",
      "subscription_plan": "Basic",
      "monthly_price_usd": 14.38,
      "device_type": "Desktop",
      "region": "CA",
      "usage_hours": 7.89,
      "event_timestamp": "2024-02-19T02:42:35"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking ESPN+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "7x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10057 used HBO Max on Smart TV under the Family plan costing $10.97 in region US.",
    "output": {
      "customer_id": "CUST-10057",
      "service_name": "HBO Max",
      "subscription_plan": "Family",
      "monthly_price_usd": 10.97,
      "device_type": "Smart TV",
      "region": "US",
      "usage_hours": 5.9,
      "event_timestamp": "2024-01-01T23:32:02"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process ESPN+ subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_espn+_etl",
      "description": "Daily ETL pipeline for ESPN+ subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_discovery+_stream",
      "description": "Real-time streaming pipeline for Discovery+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10332 used Peacock on Mobile under the Family plan costing $25.57 in region US.",
    "output": {
      "customer_id": "CUST-10332",
      "service_name": "Peacock",
      "subscription_plan": "Family",
      "monthly_price_usd": 25.57,
      "device_type": "Mobile",
      "region": "US",
      "usage_hours": 11.74,
      "event_timestamp": "2024-04-19T20:50:09"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_netflix_stream",
      "description": "Real-time streaming pipeline for Netflix events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple TV+ subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_apple_tv+_etl",
      "description": "Daily ETL pipeline for Apple TV+ subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10128 used Crunchyroll on Mobile under the Student plan costing $17.81 in region DE.",
    "output": {
      "customer_id": "CUST-10128",
      "service_name": "Crunchyroll",
      "subscription_plan": "Student",
      "monthly_price_usd": 17.81,
      "device_type": "Mobile",
      "region": "DE",
      "usage_hours": 7.84,
      "event_timestamp": "2024-12-22T00:03:23"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Crunchyroll subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_crunchyroll_etl",
      "description": "Daily ETL pipeline for Crunchyroll subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_paramount+_etl",
      "description": "Daily ETL pipeline for Paramount+ subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "7x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Disney+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Peacock subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_peacock_legacy",
      "description": "Migration pipeline for legacy Peacock data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process HBO Max subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_hbo_max_stream",
      "description": "Real-time streaming pipeline for HBO Max events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process HBO Max subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_hbo_max_etl",
      "description": "Daily ETL pipeline for HBO Max subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "14x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Peacock subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Crunchyroll subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_crunchyroll_legacy",
      "description": "Migration pipeline for legacy Crunchyroll data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Twitch subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_twitch_legacy",
      "description": "Migration pipeline for legacy Twitch data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking HBO Max subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10162 used Spotify on Smart TV under the Student plan costing $22.01 in region DE.",
    "output": {
      "customer_id": "CUST-10162",
      "service_name": "Spotify",
      "subscription_plan": "Student",
      "monthly_price_usd": 22.01,
      "device_type": "Smart TV",
      "region": "DE",
      "usage_hours": 8.43,
      "event_timestamp": "2024-09-21T01:38:22"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_apple_music_etl",
      "description": "Daily ETL pipeline for Apple Music subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_hulu_legacy",
      "description": "Migration pipeline for legacy Hulu data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10185 used Paramount+ on Mobile under the Premium plan costing $5.15 in region FR.",
    "output": {
      "customer_id": "CUST-10185",
      "service_name": "Paramount+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 5.15,
      "device_type": "Mobile",
      "region": "FR",
      "usage_hours": 0.56,
      "event_timestamp": "2024-09-08T01:45:42"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_netflix_legacy",
      "description": "Migration pipeline for legacy Netflix data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Amazon Prime Video subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_amazon_prime_video_etl",
      "description": "Daily ETL pipeline for Amazon Prime Video subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "14x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10133 used Twitch on Laptop under the Annual plan costing $27.24 in region MX.",
    "output": {
      "customer_id": "CUST-10133",
      "service_name": "Twitch",
      "subscription_plan": "Annual",
      "monthly_price_usd": 27.24,
      "device_type": "Laptop",
      "region": "MX",
      "usage_hours": 10.99,
      "event_timestamp": "2024-02-26T13:17:44"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Peacock subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking YouTube Premium subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking HBO Max subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_apple_music_agg",
      "description": "Weekly aggregation pipeline for Apple Music metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_discovery+_agg",
      "description": "Weekly aggregation pipeline for Discovery+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10095 used HBO Max on Desktop under the Premium plan costing $28.80 in region SG.",
    "output": {
      "customer_id": "CUST-10095",
      "service_name": "HBO Max",
      "subscription_plan": "Premium",
      "monthly_price_usd": 28.8,
      "device_type": "Desktop",
      "region": "SG",
      "usage_hours": 0.83,
      "event_timestamp": "2024-04-18T03:01:31"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "7x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10390 used Hulu on Mobile under the Student plan costing $23.27 in region SG.",
    "output": {
      "customer_id": "CUST-10390",
      "service_name": "Hulu",
      "subscription_plan": "Student",
      "monthly_price_usd": 23.27,
      "device_type": "Mobile",
      "region": "SG",
      "usage_hours": 5.78,
      "event_timestamp": "2024-02-08T20:00:39"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Amazon Prime Video subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_amazon_prime_video_stream",
      "description": "Real-time streaming pipeline for Amazon Prime Video events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10350 used ESPN+ on Smart TV under the Basic plan costing $15.37 in region SG.",
    "output": {
      "customer_id": "CUST-10350",
      "service_name": "ESPN+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 15.37,
      "device_type": "Smart TV",
      "region": "SG",
      "usage_hours": 7.69,
      "event_timestamp": "2024-02-19T23:35:24"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10275 used Crunchyroll on Mobile under the Student plan costing $12.73 in region KR.",
    "output": {
      "customer_id": "CUST-10275",
      "service_name": "Crunchyroll",
      "subscription_plan": "Student",
      "monthly_price_usd": 12.73,
      "device_type": "Mobile",
      "region": "KR",
      "usage_hours": 3.6,
      "event_timestamp": "2024-03-21T05:41:12"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking ESPN+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Crunchyroll subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_crunchyroll_etl",
      "description": "Daily ETL pipeline for Crunchyroll subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10324 used Spotify on Game Console under the Basic plan costing $29.96 in region CA.",
    "output": {
      "customer_id": "CUST-10324",
      "service_name": "Spotify",
      "subscription_plan": "Basic",
      "monthly_price_usd": 29.96,
      "device_type": "Game Console",
      "region": "CA",
      "usage_hours": 6.69,
      "event_timestamp": "2024-08-04T20:42:25"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Disney+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_disney+_stream",
      "description": "Real-time streaming pipeline for Disney+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10178 used Apple Music on Game Console under the Premium plan costing $16.54 in region ES.",
    "output": {
      "customer_id": "CUST-10178",
      "service_name": "Apple Music",
      "subscription_plan": "Premium",
      "monthly_price_usd": 16.54,
      "device_type": "Game Console",
      "region": "ES",
      "usage_hours": 10.88,
      "event_timestamp": "2024-08-23T04:24:28"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_hulu_legacy",
      "description": "Migration pipeline for legacy Hulu data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Disney+ subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_disney+_etl",
      "description": "Daily ETL pipeline for Disney+ subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_apple_music_stream",
      "description": "Real-time streaming pipeline for Apple Music events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10285 used Crunchyroll on Mobile under the Basic plan costing $6.30 in region SG.",
    "output": {
      "customer_id": "CUST-10285",
      "service_name": "Crunchyroll",
      "subscription_plan": "Basic",
      "monthly_price_usd": 6.3,
      "device_type": "Mobile",
      "region": "SG",
      "usage_hours": 1.33,
      "event_timestamp": "2024-12-18T16:45:47"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Amazon Prime Video subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_amazon_prime_video_agg",
      "description": "Weekly aggregation pipeline for Amazon Prime Video metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10132 used Disney+ on Game Console under the Basic plan costing $8.42 in region ES.",
    "output": {
      "customer_id": "CUST-10132",
      "service_name": "Disney+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 8.42,
      "device_type": "Game Console",
      "region": "ES",
      "usage_hours": 4.62,
      "event_timestamp": "2024-12-19T16:01:33"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process YouTube Premium subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_youtube_premium_agg",
      "description": "Weekly aggregation pipeline for YouTube Premium metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_paramount+_agg",
      "description": "Weekly aggregation pipeline for Paramount+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Spotify subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_spotify_etl",
      "description": "Daily ETL pipeline for Spotify subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_hulu_etl",
      "description": "Daily ETL pipeline for Hulu subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple Music subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10161 used Paramount+ on Smart TV under the Basic plan costing $20.53 in region SG.",
    "output": {
      "customer_id": "CUST-10161",
      "service_name": "Paramount+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 20.53,
      "device_type": "Smart TV",
      "region": "SG",
      "usage_hours": 10.73,
      "event_timestamp": "2024-06-22T18:07:25"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Amazon Prime Video subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_amazon_prime_video_stream",
      "description": "Real-time streaming pipeline for Amazon Prime Video events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10362 used Apple TV+ on Desktop under the Annual plan costing $11.92 in region JP.",
    "output": {
      "customer_id": "CUST-10362",
      "service_name": "Apple TV+",
      "subscription_plan": "Annual",
      "monthly_price_usd": 11.92,
      "device_type": "Desktop",
      "region": "JP",
      "usage_hours": 11.75,
      "event_timestamp": "2024-05-27T00:24:11"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Spotify subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_spotify_stream",
      "description": "Real-time streaming pipeline for Spotify events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10208 used YouTube Premium on Desktop under the Premium plan costing $19.34 in region SG.",
    "output": {
      "customer_id": "CUST-10208",
      "service_name": "YouTube Premium",
      "subscription_plan": "Premium",
      "monthly_price_usd": 19.34,
      "device_type": "Desktop",
      "region": "SG",
      "usage_hours": 1.92,
      "event_timestamp": "2024-03-22T21:21:59"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10082 used Apple TV+ on Game Console under the Student plan costing $9.87 in region KR.",
    "output": {
      "customer_id": "CUST-10082",
      "service_name": "Apple TV+",
      "subscription_plan": "Student",
      "monthly_price_usd": 9.87,
      "device_type": "Game Console",
      "region": "KR",
      "usage_hours": 7.75,
      "event_timestamp": "2024-11-20T14:15:39"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Crunchyroll subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10232 used ESPN+ on Desktop under the Annual plan costing $24.18 in region CA.",
    "output": {
      "customer_id": "CUST-10232",
      "service_name": "ESPN+",
      "subscription_plan": "Annual",
      "monthly_price_usd": 24.18,
      "device_type": "Desktop",
      "region": "CA",
      "usage_hours": 11.39,
      "event_timestamp": "2024-11-07T18:57:44"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_paramount+_agg",
      "description": "Weekly aggregation pipeline for Paramount+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10221 used Netflix on Laptop under the Annual plan costing $24.53 in region IN.",
    "output": {
      "customer_id": "CUST-10221",
      "service_name": "Netflix",
      "subscription_plan": "Annual",
      "monthly_price_usd": 24.53,
      "device_type": "Laptop",
      "region": "IN",
      "usage_hours": 6.68,
      "event_timestamp": "2024-10-27T11:36:55"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_paramount+_etl",
      "description": "Daily ETL pipeline for Paramount+ subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10126 used Paramount+ on Mobile under the Basic plan costing $7.91 in region AU.",
    "output": {
      "customer_id": "CUST-10126",
      "service_name": "Paramount+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 7.91,
      "device_type": "Mobile",
      "region": "AU",
      "usage_hours": 7.14,
      "event_timestamp": "2024-06-06T14:40:29"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10081 used Discovery+ on Laptop under the Student plan costing $11.00 in region IT.",
    "output": {
      "customer_id": "CUST-10081",
      "service_name": "Discovery+",
      "subscription_plan": "Student",
      "monthly_price_usd": 11.0,
      "device_type": "Laptop",
      "region": "IT",
      "usage_hours": 2.69,
      "event_timestamp": "2024-04-13T03:15:06"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10019 used Hulu on Tablet under the Premium plan costing $24.10 in region IT.",
    "output": {
      "customer_id": "CUST-10019",
      "service_name": "Hulu",
      "subscription_plan": "Premium",
      "monthly_price_usd": 24.1,
      "device_type": "Tablet",
      "region": "IT",
      "usage_hours": 5.94,
      "event_timestamp": "2024-01-08T13:26:33"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10063 used Apple TV+ on Smart TV under the Premium plan costing $16.38 in region FR.",
    "output": {
      "customer_id": "CUST-10063",
      "service_name": "Apple TV+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 16.38,
      "device_type": "Smart TV",
      "region": "FR",
      "usage_hours": 4.42,
      "event_timestamp": "2024-09-22T00:53:46"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple Music subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_discovery+_stream",
      "description": "Real-time streaming pipeline for Discovery+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10123 used Apple Music on Tablet under the Premium plan costing $5.25 in region US.",
    "output": {
      "customer_id": "CUST-10123",
      "service_name": "Apple Music",
      "subscription_plan": "Premium",
      "monthly_price_usd": 5.25,
      "device_type": "Tablet",
      "region": "US",
      "usage_hours": 4.35,
      "event_timestamp": "2024-02-04T05:13:37"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10092 used Twitch on Laptop under the Annual plan costing $10.03 in region IN.",
    "output": {
      "customer_id": "CUST-10092",
      "service_name": "Twitch",
      "subscription_plan": "Annual",
      "monthly_price_usd": 10.03,
      "device_type": "Laptop",
      "region": "IN",
      "usage_hours": 6.86,
      "event_timestamp": "2024-02-27T21:06:53"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Twitch subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_twitch_legacy",
      "description": "Migration pipeline for legacy Twitch data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10076 used Disney+ on Desktop under the Basic plan costing $5.21 in region JP.",
    "output": {
      "customer_id": "CUST-10076",
      "service_name": "Disney+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 5.21,
      "device_type": "Desktop",
      "region": "JP",
      "usage_hours": 1.79,
      "event_timestamp": "2024-05-06T13:39:58"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Crunchyroll subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10061 used Amazon Prime Video on Desktop under the Basic plan costing $17.88 in region CA.",
    "output": {
      "customer_id": "CUST-10061",
      "service_name": "Amazon Prime Video",
      "subscription_plan": "Basic",
      "monthly_price_usd": 17.88,
      "device_type": "Desktop",
      "region": "CA",
      "usage_hours": 8.17,
      "event_timestamp": "2024-05-09T07:57:48"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Twitch subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_twitch_agg",
      "description": "Weekly aggregation pipeline for Twitch metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10102 used Peacock on Desktop under the Basic plan costing $7.47 in region ES.",
    "output": {
      "customer_id": "CUST-10102",
      "service_name": "Peacock",
      "subscription_plan": "Basic",
      "monthly_price_usd": 7.47,
      "device_type": "Desktop",
      "region": "ES",
      "usage_hours": 8.85,
      "event_timestamp": "2024-06-28T00:00:02"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Disney+ subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_disney+_etl",
      "description": "Daily ETL pipeline for Disney+ subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "14x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10302 used ESPN+ on Smart TV under the Basic plan costing $12.86 in region DE.",
    "output": {
      "customer_id": "CUST-10302",
      "service_name": "ESPN+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 12.86,
      "device_type": "Smart TV",
      "region": "DE",
      "usage_hours": 6.61,
      "event_timestamp": "2024-09-20T21:06:20"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process YouTube Premium subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_youtube_premium_agg",
      "description": "Weekly aggregation pipeline for YouTube Premium metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_apple_music_stream",
      "description": "Real-time streaming pipeline for Apple Music events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10027 used Discovery+ on Desktop under the Student plan costing $19.57 in region US.",
    "output": {
      "customer_id": "CUST-10027",
      "service_name": "Discovery+",
      "subscription_plan": "Student",
      "monthly_price_usd": 19.57,
      "device_type": "Desktop",
      "region": "US",
      "usage_hours": 11.91,
      "event_timestamp": "2024-12-03T12:16:57"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_discovery+_legacy",
      "description": "Migration pipeline for legacy Discovery+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Disney+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_discovery+_agg",
      "description": "Weekly aggregation pipeline for Discovery+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking HBO Max subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10048 used Hulu on Smart TV under the Basic plan costing $22.56 in region CA.",
    "output": {
      "customer_id": "CUST-10048",
      "service_name": "Hulu",
      "subscription_plan": "Basic",
      "monthly_price_usd": 22.56,
      "device_type": "Smart TV",
      "region": "CA",
      "usage_hours": 8.08,
      "event_timestamp": "2024-07-09T16:21:17"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "12x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10271 used Crunchyroll on Mobile under the Premium plan costing $22.28 in region US.",
    "output": {
      "customer_id": "CUST-10271",
      "service_name": "Crunchyroll",
      "subscription_plan": "Premium",
      "monthly_price_usd": 22.28,
      "device_type": "Mobile",
      "region": "US",
      "usage_hours": 6.17,
      "event_timestamp": "2024-12-28T01:02:43"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10171 used Crunchyroll on Desktop under the Student plan costing $8.39 in region CN.",
    "output": {
      "customer_id": "CUST-10171",
      "service_name": "Crunchyroll",
      "subscription_plan": "Student",
      "monthly_price_usd": 8.39,
      "device_type": "Desktop",
      "region": "CN",
      "usage_hours": 1.13,
      "event_timestamp": "2024-07-05T14:34:29"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "12x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Amazon Prime Video subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_amazon_prime_video_legacy",
      "description": "Migration pipeline for legacy Amazon Prime Video data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "7x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "14x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10003 used Apple Music on Desktop under the Premium plan costing $7.56 in region JP.",
    "output": {
      "customer_id": "CUST-10003",
      "service_name": "Apple Music",
      "subscription_plan": "Premium",
      "monthly_price_usd": 7.56,
      "device_type": "Desktop",
      "region": "JP",
      "usage_hours": 5.42,
      "event_timestamp": "2024-06-27T05:55:07"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Disney+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple TV+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Spotify subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_spotify_agg",
      "description": "Weekly aggregation pipeline for Spotify metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Crunchyroll subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_crunchyroll_agg",
      "description": "Weekly aggregation pipeline for Crunchyroll metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Hulu subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Spotify subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_spotify_legacy",
      "description": "Migration pipeline for legacy Spotify data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple TV+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_paramount+_legacy",
      "description": "Migration pipeline for legacy Paramount+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "7x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_apple_music_stream",
      "description": "Real-time streaming pipeline for Apple Music events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Peacock subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_peacock_agg",
      "description": "Weekly aggregation pipeline for Peacock metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10309 used ESPN+ on Mobile under the Basic plan costing $11.96 in region SG.",
    "output": {
      "customer_id": "CUST-10309",
      "service_name": "ESPN+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 11.96,
      "device_type": "Mobile",
      "region": "SG",
      "usage_hours": 8.81,
      "event_timestamp": "2024-10-26T22:07:09"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Hulu subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Disney+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_disney+_agg",
      "description": "Weekly aggregation pipeline for Disney+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Hulu subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10199 used ESPN+ on Smart TV under the Premium plan costing $22.61 in region ES.",
    "output": {
      "customer_id": "CUST-10199",
      "service_name": "ESPN+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 22.61,
      "device_type": "Smart TV",
      "region": "ES",
      "usage_hours": 0.76,
      "event_timestamp": "2024-02-16T15:12:26"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_discovery+_legacy",
      "description": "Migration pipeline for legacy Discovery+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple Music subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Peacock subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Hulu subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "12x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10020 used Crunchyroll on Smart TV under the Annual plan costing $28.10 in region JP.",
    "output": {
      "customer_id": "CUST-10020",
      "service_name": "Crunchyroll",
      "subscription_plan": "Annual",
      "monthly_price_usd": 28.1,
      "device_type": "Smart TV",
      "region": "JP",
      "usage_hours": 5.79,
      "event_timestamp": "2024-04-08T01:15:08"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10291 used Twitch on Smart TV under the Basic plan costing $26.04 in region KR.",
    "output": {
      "customer_id": "CUST-10291",
      "service_name": "Twitch",
      "subscription_plan": "Basic",
      "monthly_price_usd": 26.04,
      "device_type": "Smart TV",
      "region": "KR",
      "usage_hours": 9.51,
      "event_timestamp": "2024-12-18T01:06:22"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Twitch subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_twitch_stream",
      "description": "Real-time streaming pipeline for Twitch events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10196 used Amazon Prime Video on Game Console under the Annual plan costing $8.04 in region CA.",
    "output": {
      "customer_id": "CUST-10196",
      "service_name": "Amazon Prime Video",
      "subscription_plan": "Annual",
      "monthly_price_usd": 8.04,
      "device_type": "Game Console",
      "region": "CA",
      "usage_hours": 1.48,
      "event_timestamp": "2024-12-26T03:18:55"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_discovery+_agg",
      "description": "Weekly aggregation pipeline for Discovery+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10114 used Apple TV+ on Game Console under the Family plan costing $25.63 in region US.",
    "output": {
      "customer_id": "CUST-10114",
      "service_name": "Apple TV+",
      "subscription_plan": "Family",
      "monthly_price_usd": 25.63,
      "device_type": "Game Console",
      "region": "US",
      "usage_hours": 11.84,
      "event_timestamp": "2024-04-16T06:53:59"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10155 used HBO Max on Desktop under the Family plan costing $13.54 in region MX.",
    "output": {
      "customer_id": "CUST-10155",
      "service_name": "HBO Max",
      "subscription_plan": "Family",
      "monthly_price_usd": 13.54,
      "device_type": "Desktop",
      "region": "MX",
      "usage_hours": 2.08,
      "event_timestamp": "2024-08-03T15:21:57"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10252 used Disney+ on Desktop under the Basic plan costing $27.44 in region AU.",
    "output": {
      "customer_id": "CUST-10252",
      "service_name": "Disney+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 27.44,
      "device_type": "Desktop",
      "region": "AU",
      "usage_hours": 9.47,
      "event_timestamp": "2024-05-17T05:24:55"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10313 used Hulu on Desktop under the Annual plan costing $29.36 in region KR.",
    "output": {
      "customer_id": "CUST-10313",
      "service_name": "Hulu",
      "subscription_plan": "Annual",
      "monthly_price_usd": 29.36,
      "device_type": "Desktop",
      "region": "KR",
      "usage_hours": 5.29,
      "event_timestamp": "2024-10-04T07:35:46"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_netflix_agg",
      "description": "Weekly aggregation pipeline for Netflix metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "12x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Disney+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_disney+_legacy",
      "description": "Migration pipeline for legacy Disney+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Disney+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_disney+_stream",
      "description": "Real-time streaming pipeline for Disney+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_hulu_agg",
      "description": "Weekly aggregation pipeline for Hulu metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process YouTube Premium subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_youtube_premium_agg",
      "description": "Weekly aggregation pipeline for YouTube Premium metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Peacock subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_discovery+_stream",
      "description": "Real-time streaming pipeline for Discovery+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10263 used Crunchyroll on Laptop under the Family plan costing $8.03 in region CN.",
    "output": {
      "customer_id": "CUST-10263",
      "service_name": "Crunchyroll",
      "subscription_plan": "Family",
      "monthly_price_usd": 8.03,
      "device_type": "Laptop",
      "region": "CN",
      "usage_hours": 1.69,
      "event_timestamp": "2024-10-18T12:57:55"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Crunchyroll subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10333 used HBO Max on Game Console under the Basic plan costing $13.62 in region FR.",
    "output": {
      "customer_id": "CUST-10333",
      "service_name": "HBO Max",
      "subscription_plan": "Basic",
      "monthly_price_usd": 13.62,
      "device_type": "Game Console",
      "region": "FR",
      "usage_hours": 1.05,
      "event_timestamp": "2024-04-15T00:30:10"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Paramount+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_discovery+_stream",
      "description": "Real-time streaming pipeline for Discovery+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10211 used Hulu on Desktop under the Premium plan costing $10.30 in region MX.",
    "output": {
      "customer_id": "CUST-10211",
      "service_name": "Hulu",
      "subscription_plan": "Premium",
      "monthly_price_usd": 10.3,
      "device_type": "Desktop",
      "region": "MX",
      "usage_hours": 5.38,
      "event_timestamp": "2024-08-03T15:26:01"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process ESPN+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_espn+_legacy",
      "description": "Migration pipeline for legacy ESPN+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10071 used Hulu on Mobile under the Basic plan costing $13.47 in region FR.",
    "output": {
      "customer_id": "CUST-10071",
      "service_name": "Hulu",
      "subscription_plan": "Basic",
      "monthly_price_usd": 13.47,
      "device_type": "Mobile",
      "region": "FR",
      "usage_hours": 4.6,
      "event_timestamp": "2024-09-05T20:01:04"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "14x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking ESPN+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Hulu subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10127 used Discovery+ on Tablet under the Premium plan costing $11.39 in region ES.",
    "output": {
      "customer_id": "CUST-10127",
      "service_name": "Discovery+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 11.39,
      "device_type": "Tablet",
      "region": "ES",
      "usage_hours": 6.0,
      "event_timestamp": "2024-02-27T18:45:45"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10145 used Crunchyroll on Laptop under the Basic plan costing $25.19 in region CN.",
    "output": {
      "customer_id": "CUST-10145",
      "service_name": "Crunchyroll",
      "subscription_plan": "Basic",
      "monthly_price_usd": 25.19,
      "device_type": "Laptop",
      "region": "CN",
      "usage_hours": 4.85,
      "event_timestamp": "2024-06-28T04:49:35"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10039 used Paramount+ on Smart TV under the Family plan costing $14.36 in region JP.",
    "output": {
      "customer_id": "CUST-10039",
      "service_name": "Paramount+",
      "subscription_plan": "Family",
      "monthly_price_usd": 14.36,
      "device_type": "Smart TV",
      "region": "JP",
      "usage_hours": 11.57,
      "event_timestamp": "2024-02-18T05:58:29"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_hulu_legacy",
      "description": "Migration pipeline for legacy Hulu data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Paramount+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process ESPN+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_espn+_stream",
      "description": "Real-time streaming pipeline for ESPN+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "12x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10107 used Discovery+ on Tablet under the Annual plan costing $25.56 in region JP.",
    "output": {
      "customer_id": "CUST-10107",
      "service_name": "Discovery+",
      "subscription_plan": "Annual",
      "monthly_price_usd": 25.56,
      "device_type": "Tablet",
      "region": "JP",
      "usage_hours": 4.89,
      "event_timestamp": "2024-07-28T06:52:25"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process ESPN+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_espn+_agg",
      "description": "Weekly aggregation pipeline for ESPN+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_hulu_stream",
      "description": "Real-time streaming pipeline for Hulu events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10399 used Crunchyroll on Smart TV under the Family plan costing $17.85 in region CN.",
    "output": {
      "customer_id": "CUST-10399",
      "service_name": "Crunchyroll",
      "subscription_plan": "Family",
      "monthly_price_usd": 17.85,
      "device_type": "Smart TV",
      "region": "CN",
      "usage_hours": 6.17,
      "event_timestamp": "2024-01-23T21:36:04"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10274 used Disney+ on Laptop under the Annual plan costing $18.51 in region KR.",
    "output": {
      "customer_id": "CUST-10274",
      "service_name": "Disney+",
      "subscription_plan": "Annual",
      "monthly_price_usd": 18.51,
      "device_type": "Laptop",
      "region": "KR",
      "usage_hours": 6.13,
      "event_timestamp": "2024-10-27T17:48:57"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10087 used Disney+ on Game Console under the Basic plan costing $16.65 in region DE.",
    "output": {
      "customer_id": "CUST-10087",
      "service_name": "Disney+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 16.65,
      "device_type": "Game Console",
      "region": "DE",
      "usage_hours": 3.22,
      "event_timestamp": "2024-11-24T17:27:07"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking YouTube Premium subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Disney+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_disney+_agg",
      "description": "Weekly aggregation pipeline for Disney+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Peacock subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10388 used HBO Max on Laptop under the Premium plan costing $6.13 in region IT.",
    "output": {
      "customer_id": "CUST-10388",
      "service_name": "HBO Max",
      "subscription_plan": "Premium",
      "monthly_price_usd": 6.13,
      "device_type": "Laptop",
      "region": "IT",
      "usage_hours": 4.17,
      "event_timestamp": "2024-07-19T22:12:33"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple Music subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10024 used Hulu on Tablet under the Premium plan costing $24.23 in region BR.",
    "output": {
      "customer_id": "CUST-10024",
      "service_name": "Hulu",
      "subscription_plan": "Premium",
      "monthly_price_usd": 24.23,
      "device_type": "Tablet",
      "region": "BR",
      "usage_hours": 4.54,
      "event_timestamp": "2024-01-14T20:50:47"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10376 used Spotify on Tablet under the Premium plan costing $12.40 in region BR.",
    "output": {
      "customer_id": "CUST-10376",
      "service_name": "Spotify",
      "subscription_plan": "Premium",
      "monthly_price_usd": 12.4,
      "device_type": "Tablet",
      "region": "BR",
      "usage_hours": 6.27,
      "event_timestamp": "2024-03-09T18:37:18"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_netflix_stream",
      "description": "Real-time streaming pipeline for Netflix events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Disney+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_disney+_agg",
      "description": "Weekly aggregation pipeline for Disney+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple TV+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_apple_tv+_agg",
      "description": "Weekly aggregation pipeline for Apple TV+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10347 used Netflix on Smart TV under the Family plan costing $10.75 in region AU.",
    "output": {
      "customer_id": "CUST-10347",
      "service_name": "Netflix",
      "subscription_plan": "Family",
      "monthly_price_usd": 10.75,
      "device_type": "Smart TV",
      "region": "AU",
      "usage_hours": 8.16,
      "event_timestamp": "2024-10-04T21:58:35"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10248 used Twitch on Game Console under the Basic plan costing $7.76 in region BR.",
    "output": {
      "customer_id": "CUST-10248",
      "service_name": "Twitch",
      "subscription_plan": "Basic",
      "monthly_price_usd": 7.76,
      "device_type": "Game Console",
      "region": "BR",
      "usage_hours": 3.63,
      "event_timestamp": "2024-07-08T00:05:19"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple TV+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_apple_tv+_legacy",
      "description": "Migration pipeline for legacy Apple TV+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process HBO Max subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_hbo_max_etl",
      "description": "Daily ETL pipeline for HBO Max subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking ESPN+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_netflix_etl",
      "description": "Daily ETL pipeline for Netflix subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_paramount+_agg",
      "description": "Weekly aggregation pipeline for Paramount+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10269 used Spotify on Game Console under the Family plan costing $5.91 in region US.",
    "output": {
      "customer_id": "CUST-10269",
      "service_name": "Spotify",
      "subscription_plan": "Family",
      "monthly_price_usd": 5.91,
      "device_type": "Game Console",
      "region": "US",
      "usage_hours": 6.56,
      "event_timestamp": "2024-01-01T20:46:26"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10310 used Peacock on Game Console under the Student plan costing $8.05 in region BR.",
    "output": {
      "customer_id": "CUST-10310",
      "service_name": "Peacock",
      "subscription_plan": "Student",
      "monthly_price_usd": 8.05,
      "device_type": "Game Console",
      "region": "BR",
      "usage_hours": 6.01,
      "event_timestamp": "2024-02-11T15:07:54"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10327 used Crunchyroll on Tablet under the Family plan costing $14.86 in region US.",
    "output": {
      "customer_id": "CUST-10327",
      "service_name": "Crunchyroll",
      "subscription_plan": "Family",
      "monthly_price_usd": 14.86,
      "device_type": "Tablet",
      "region": "US",
      "usage_hours": 2.46,
      "event_timestamp": "2024-04-19T06:58:42"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Paramount+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking HBO Max subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process ESPN+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_espn+_legacy",
      "description": "Migration pipeline for legacy ESPN+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking YouTube Premium subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10121 used Apple Music on Desktop under the Family plan costing $8.55 in region SG.",
    "output": {
      "customer_id": "CUST-10121",
      "service_name": "Apple Music",
      "subscription_plan": "Family",
      "monthly_price_usd": 8.55,
      "device_type": "Desktop",
      "region": "SG",
      "usage_hours": 8.94,
      "event_timestamp": "2024-10-21T05:00:17"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Spotify subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_spotify_legacy",
      "description": "Migration pipeline for legacy Spotify data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10223 used Discovery+ on Game Console under the Premium plan costing $5.61 in region IT.",
    "output": {
      "customer_id": "CUST-10223",
      "service_name": "Discovery+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 5.61,
      "device_type": "Game Console",
      "region": "IT",
      "usage_hours": 3.78,
      "event_timestamp": "2024-12-28T13:05:10"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10136 used Disney+ on Smart TV under the Family plan costing $25.51 in region AU.",
    "output": {
      "customer_id": "CUST-10136",
      "service_name": "Disney+",
      "subscription_plan": "Family",
      "monthly_price_usd": 25.51,
      "device_type": "Smart TV",
      "region": "AU",
      "usage_hours": 7.73,
      "event_timestamp": "2024-02-08T19:39:00"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10386 used Disney+ on Smart TV under the Basic plan costing $10.83 in region MX.",
    "output": {
      "customer_id": "CUST-10386",
      "service_name": "Disney+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 10.83,
      "device_type": "Smart TV",
      "region": "MX",
      "usage_hours": 8.96,
      "event_timestamp": "2024-01-12T15:37:37"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10206 used Crunchyroll on Desktop under the Basic plan costing $15.28 in region ES.",
    "output": {
      "customer_id": "CUST-10206",
      "service_name": "Crunchyroll",
      "subscription_plan": "Basic",
      "monthly_price_usd": 15.28,
      "device_type": "Desktop",
      "region": "ES",
      "usage_hours": 5.35,
      "event_timestamp": "2024-08-06T08:46:47"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Twitch subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_twitch_stream",
      "description": "Real-time streaming pipeline for Twitch events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Spotify subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_spotify_agg",
      "description": "Weekly aggregation pipeline for Spotify metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10195 used ESPN+ on Mobile under the Family plan costing $15.42 in region IN.",
    "output": {
      "customer_id": "CUST-10195",
      "service_name": "ESPN+",
      "subscription_plan": "Family",
      "monthly_price_usd": 15.42,
      "device_type": "Mobile",
      "region": "IN",
      "usage_hours": 10.46,
      "event_timestamp": "2024-08-27T07:58:00"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process YouTube Premium subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_youtube_premium_agg",
      "description": "Weekly aggregation pipeline for YouTube Premium metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Peacock subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_peacock_etl",
      "description": "Daily ETL pipeline for Peacock subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10214 used Spotify on Mobile under the Premium plan costing $21.62 in region ES.",
    "output": {
      "customer_id": "CUST-10214",
      "service_name": "Spotify",
      "subscription_plan": "Premium",
      "monthly_price_usd": 21.62,
      "device_type": "Mobile",
      "region": "ES",
      "usage_hours": 4.26,
      "event_timestamp": "2024-10-07T10:06:29"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Crunchyroll subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_crunchyroll_agg",
      "description": "Weekly aggregation pipeline for Crunchyroll metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10319 used Paramount+ on Desktop under the Family plan costing $16.25 in region UK.",
    "output": {
      "customer_id": "CUST-10319",
      "service_name": "Paramount+",
      "subscription_plan": "Family",
      "monthly_price_usd": 16.25,
      "device_type": "Desktop",
      "region": "UK",
      "usage_hours": 8.15,
      "event_timestamp": "2024-05-09T02:08:59"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Peacock subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_peacock_legacy",
      "description": "Migration pipeline for legacy Peacock data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10017 used Discovery+ on Mobile under the Family plan costing $11.67 in region IT.",
    "output": {
      "customer_id": "CUST-10017",
      "service_name": "Discovery+",
      "subscription_plan": "Family",
      "monthly_price_usd": 11.67,
      "device_type": "Mobile",
      "region": "IT",
      "usage_hours": 1.07,
      "event_timestamp": "2024-01-02T03:57:44"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_paramount+_legacy",
      "description": "Migration pipeline for legacy Paramount+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_apple_music_legacy",
      "description": "Migration pipeline for legacy Apple Music data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process YouTube Premium subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_youtube_premium_etl",
      "description": "Daily ETL pipeline for YouTube Premium subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10210 used Spotify on Game Console under the Annual plan costing $12.31 in region DE.",
    "output": {
      "customer_id": "CUST-10210",
      "service_name": "Spotify",
      "subscription_plan": "Annual",
      "monthly_price_usd": 12.31,
      "device_type": "Game Console",
      "region": "DE",
      "usage_hours": 9.84,
      "event_timestamp": "2024-03-08T06:59:47"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple TV+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_apple_tv+_agg",
      "description": "Weekly aggregation pipeline for Apple TV+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10030 used Spotify on Smart TV under the Student plan costing $19.65 in region FR.",
    "output": {
      "customer_id": "CUST-10030",
      "service_name": "Spotify",
      "subscription_plan": "Student",
      "monthly_price_usd": 19.65,
      "device_type": "Smart TV",
      "region": "FR",
      "usage_hours": 4.27,
      "event_timestamp": "2024-12-19T08:22:42"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "7x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10351 used Disney+ on Laptop under the Student plan costing $25.12 in region ES.",
    "output": {
      "customer_id": "CUST-10351",
      "service_name": "Disney+",
      "subscription_plan": "Student",
      "monthly_price_usd": 25.12,
      "device_type": "Laptop",
      "region": "ES",
      "usage_hours": 2.0,
      "event_timestamp": "2024-07-13T05:42:55"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Disney+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_paramount+_legacy",
      "description": "Migration pipeline for legacy Paramount+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10117 used Apple TV+ on Mobile under the Student plan costing $6.60 in region BR.",
    "output": {
      "customer_id": "CUST-10117",
      "service_name": "Apple TV+",
      "subscription_plan": "Student",
      "monthly_price_usd": 6.6,
      "device_type": "Mobile",
      "region": "BR",
      "usage_hours": 1.22,
      "event_timestamp": "2024-06-20T13:03:47"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10179 used Twitch on Smart TV under the Premium plan costing $28.54 in region KR.",
    "output": {
      "customer_id": "CUST-10179",
      "service_name": "Twitch",
      "subscription_plan": "Premium",
      "monthly_price_usd": 28.54,
      "device_type": "Smart TV",
      "region": "KR",
      "usage_hours": 4.1,
      "event_timestamp": "2024-08-21T22:11:48"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "14x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10255 used Hulu on Desktop under the Family plan costing $15.22 in region AU.",
    "output": {
      "customer_id": "CUST-10255",
      "service_name": "Hulu",
      "subscription_plan": "Family",
      "monthly_price_usd": 15.22,
      "device_type": "Desktop",
      "region": "AU",
      "usage_hours": 9.08,
      "event_timestamp": "2024-06-03T08:56:45"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10189 used Discovery+ on Smart TV under the Annual plan costing $14.78 in region JP.",
    "output": {
      "customer_id": "CUST-10189",
      "service_name": "Discovery+",
      "subscription_plan": "Annual",
      "monthly_price_usd": 14.78,
      "device_type": "Smart TV",
      "region": "JP",
      "usage_hours": 9.41,
      "event_timestamp": "2024-07-28T02:22:39"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10228 used Discovery+ on Mobile under the Premium plan costing $19.27 in region AU.",
    "output": {
      "customer_id": "CUST-10228",
      "service_name": "Discovery+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 19.27,
      "device_type": "Mobile",
      "region": "AU",
      "usage_hours": 9.63,
      "event_timestamp": "2024-02-09T19:17:38"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10360 used Amazon Prime Video on Smart TV under the Basic plan costing $6.09 in region ES.",
    "output": {
      "customer_id": "CUST-10360",
      "service_name": "Amazon Prime Video",
      "subscription_plan": "Basic",
      "monthly_price_usd": 6.09,
      "device_type": "Smart TV",
      "region": "ES",
      "usage_hours": 5.78,
      "event_timestamp": "2024-07-13T02:04:09"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "14x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Crunchyroll subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_crunchyroll_etl",
      "description": "Daily ETL pipeline for Crunchyroll subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple Music subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Twitch subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_twitch_legacy",
      "description": "Migration pipeline for legacy Twitch data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Spotify subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_spotify_etl",
      "description": "Daily ETL pipeline for Spotify subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Twitch subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_twitch_etl",
      "description": "Daily ETL pipeline for Twitch subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Peacock subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_peacock_legacy",
      "description": "Migration pipeline for legacy Peacock data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10016 used Crunchyroll on Desktop under the Annual plan costing $15.93 in region JP.",
    "output": {
      "customer_id": "CUST-10016",
      "service_name": "Crunchyroll",
      "subscription_plan": "Annual",
      "monthly_price_usd": 15.93,
      "device_type": "Desktop",
      "region": "JP",
      "usage_hours": 4.5,
      "event_timestamp": "2024-09-23T11:45:13"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Crunchyroll subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_crunchyroll_stream",
      "description": "Real-time streaming pipeline for Crunchyroll events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10094 used ESPN+ on Mobile under the Basic plan costing $10.49 in region CN.",
    "output": {
      "customer_id": "CUST-10094",
      "service_name": "ESPN+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 10.49,
      "device_type": "Mobile",
      "region": "CN",
      "usage_hours": 2.18,
      "event_timestamp": "2024-03-08T07:37:12"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10379 used Twitch on Mobile under the Basic plan costing $12.96 in region AU.",
    "output": {
      "customer_id": "CUST-10379",
      "service_name": "Twitch",
      "subscription_plan": "Basic",
      "monthly_price_usd": 12.96,
      "device_type": "Mobile",
      "region": "AU",
      "usage_hours": 8.99,
      "event_timestamp": "2024-06-02T03:46:19"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10383 used Spotify on Mobile under the Premium plan costing $11.67 in region ES.",
    "output": {
      "customer_id": "CUST-10383",
      "service_name": "Spotify",
      "subscription_plan": "Premium",
      "monthly_price_usd": 11.67,
      "device_type": "Mobile",
      "region": "ES",
      "usage_hours": 2.68,
      "event_timestamp": "2024-02-18T17:12:47"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10249 used YouTube Premium on Tablet under the Student plan costing $27.56 in region DE.",
    "output": {
      "customer_id": "CUST-10249",
      "service_name": "YouTube Premium",
      "subscription_plan": "Student",
      "monthly_price_usd": 27.56,
      "device_type": "Tablet",
      "region": "DE",
      "usage_hours": 9.19,
      "event_timestamp": "2024-03-08T21:49:47"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10163 used HBO Max on Game Console under the Family plan costing $7.36 in region DE.",
    "output": {
      "customer_id": "CUST-10163",
      "service_name": "HBO Max",
      "subscription_plan": "Family",
      "monthly_price_usd": 7.36,
      "device_type": "Game Console",
      "region": "DE",
      "usage_hours": 2.22,
      "event_timestamp": "2024-10-20T09:55:40"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10041 used Peacock on Mobile under the Family plan costing $21.53 in region IN.",
    "output": {
      "customer_id": "CUST-10041",
      "service_name": "Peacock",
      "subscription_plan": "Family",
      "monthly_price_usd": 21.53,
      "device_type": "Mobile",
      "region": "IN",
      "usage_hours": 6.43,
      "event_timestamp": "2024-03-10T09:38:12"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process YouTube Premium subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_youtube_premium_legacy",
      "description": "Migration pipeline for legacy YouTube Premium data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_paramount+_stream",
      "description": "Real-time streaming pipeline for Paramount+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10159 used Apple TV+ on Tablet under the Annual plan costing $11.95 in region MX.",
    "output": {
      "customer_id": "CUST-10159",
      "service_name": "Apple TV+",
      "subscription_plan": "Annual",
      "monthly_price_usd": 11.95,
      "device_type": "Tablet",
      "region": "MX",
      "usage_hours": 8.02,
      "event_timestamp": "2024-09-17T12:19:49"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Disney+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process YouTube Premium subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_youtube_premium_legacy",
      "description": "Migration pipeline for legacy YouTube Premium data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Disney+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10336 used Twitch on Game Console under the Basic plan costing $27.33 in region CN.",
    "output": {
      "customer_id": "CUST-10336",
      "service_name": "Twitch",
      "subscription_plan": "Basic",
      "monthly_price_usd": 27.33,
      "device_type": "Game Console",
      "region": "CN",
      "usage_hours": 9.66,
      "event_timestamp": "2024-01-14T15:34:46"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking ESPN+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10149 used Amazon Prime Video on Mobile under the Annual plan costing $25.89 in region KR.",
    "output": {
      "customer_id": "CUST-10149",
      "service_name": "Amazon Prime Video",
      "subscription_plan": "Annual",
      "monthly_price_usd": 25.89,
      "device_type": "Mobile",
      "region": "KR",
      "usage_hours": 10.94,
      "event_timestamp": "2024-02-28T22:19:04"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Peacock subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking ESPN+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10236 used Peacock on Game Console under the Premium plan costing $16.55 in region FR.",
    "output": {
      "customer_id": "CUST-10236",
      "service_name": "Peacock",
      "subscription_plan": "Premium",
      "monthly_price_usd": 16.55,
      "device_type": "Game Console",
      "region": "FR",
      "usage_hours": 0.52,
      "event_timestamp": "2024-04-03T04:06:56"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple TV+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_apple_tv+_legacy",
      "description": "Migration pipeline for legacy Apple TV+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_hulu_etl",
      "description": "Daily ETL pipeline for Hulu subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10212 used Apple Music on Desktop under the Annual plan costing $11.61 in region DE.",
    "output": {
      "customer_id": "CUST-10212",
      "service_name": "Apple Music",
      "subscription_plan": "Annual",
      "monthly_price_usd": 11.61,
      "device_type": "Desktop",
      "region": "DE",
      "usage_hours": 11.82,
      "event_timestamp": "2024-09-22T06:21:54"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10254 used Paramount+ on Smart TV under the Annual plan costing $22.58 in region CN.",
    "output": {
      "customer_id": "CUST-10254",
      "service_name": "Paramount+",
      "subscription_plan": "Annual",
      "monthly_price_usd": 22.58,
      "device_type": "Smart TV",
      "region": "CN",
      "usage_hours": 4.75,
      "event_timestamp": "2024-08-01T14:00:41"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10314 used Disney+ on Game Console under the Premium plan costing $22.68 in region SG.",
    "output": {
      "customer_id": "CUST-10314",
      "service_name": "Disney+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 22.68,
      "device_type": "Game Console",
      "region": "SG",
      "usage_hours": 3.52,
      "event_timestamp": "2024-10-27T09:54:45"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "14x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10393 used Netflix on Laptop under the Student plan costing $8.82 in region ES.",
    "output": {
      "customer_id": "CUST-10393",
      "service_name": "Netflix",
      "subscription_plan": "Student",
      "monthly_price_usd": 8.82,
      "device_type": "Laptop",
      "region": "ES",
      "usage_hours": 5.24,
      "event_timestamp": "2024-04-01T10:44:05"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Spotify subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_spotify_legacy",
      "description": "Migration pipeline for legacy Spotify data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Peacock subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_peacock_etl",
      "description": "Daily ETL pipeline for Peacock subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Paramount+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Peacock subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_peacock_etl",
      "description": "Daily ETL pipeline for Peacock subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10343 used Hulu on Mobile under the Basic plan costing $5.99 in region IN.",
    "output": {
      "customer_id": "CUST-10343",
      "service_name": "Hulu",
      "subscription_plan": "Basic",
      "monthly_price_usd": 5.99,
      "device_type": "Mobile",
      "region": "IN",
      "usage_hours": 1.75,
      "event_timestamp": "2024-06-27T16:42:48"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process HBO Max subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_hbo_max_agg",
      "description": "Weekly aggregation pipeline for HBO Max metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Disney+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Amazon Prime Video subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_amazon_prime_video_stream",
      "description": "Real-time streaming pipeline for Amazon Prime Video events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10184 used Netflix on Smart TV under the Student plan costing $15.26 in region BR.",
    "output": {
      "customer_id": "CUST-10184",
      "service_name": "Netflix",
      "subscription_plan": "Student",
      "monthly_price_usd": 15.26,
      "device_type": "Smart TV",
      "region": "BR",
      "usage_hours": 11.87,
      "event_timestamp": "2024-02-08T10:02:22"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process YouTube Premium subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_youtube_premium_stream",
      "description": "Real-time streaming pipeline for YouTube Premium events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10266 used ESPN+ on Game Console under the Premium plan costing $15.23 in region MX.",
    "output": {
      "customer_id": "CUST-10266",
      "service_name": "ESPN+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 15.23,
      "device_type": "Game Console",
      "region": "MX",
      "usage_hours": 6.34,
      "event_timestamp": "2024-04-01T02:35:34"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "7x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10130 used Netflix on Laptop under the Premium plan costing $22.99 in region ES.",
    "output": {
      "customer_id": "CUST-10130",
      "service_name": "Netflix",
      "subscription_plan": "Premium",
      "monthly_price_usd": 22.99,
      "device_type": "Laptop",
      "region": "ES",
      "usage_hours": 4.05,
      "event_timestamp": "2024-12-15T07:15:18"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10231 used ESPN+ on Desktop under the Basic plan costing $11.94 in region DE.",
    "output": {
      "customer_id": "CUST-10231",
      "service_name": "ESPN+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 11.94,
      "device_type": "Desktop",
      "region": "DE",
      "usage_hours": 1.94,
      "event_timestamp": "2024-11-26T18:37:57"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10079 used Crunchyroll on Smart TV under the Family plan costing $8.17 in region IN.",
    "output": {
      "customer_id": "CUST-10079",
      "service_name": "Crunchyroll",
      "subscription_plan": "Family",
      "monthly_price_usd": 8.17,
      "device_type": "Smart TV",
      "region": "IN",
      "usage_hours": 4.8,
      "event_timestamp": "2024-02-26T22:26:13"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10050 used Spotify on Laptop under the Basic plan costing $20.09 in region ES.",
    "output": {
      "customer_id": "CUST-10050",
      "service_name": "Spotify",
      "subscription_plan": "Basic",
      "monthly_price_usd": 20.09,
      "device_type": "Laptop",
      "region": "ES",
      "usage_hours": 5.25,
      "event_timestamp": "2024-06-07T01:08:21"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Crunchyroll subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_crunchyroll_etl",
      "description": "Daily ETL pipeline for Crunchyroll subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process HBO Max subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_hbo_max_stream",
      "description": "Real-time streaming pipeline for HBO Max events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Crunchyroll subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Crunchyroll subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_crunchyroll_agg",
      "description": "Weekly aggregation pipeline for Crunchyroll metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_discovery+_etl",
      "description": "Daily ETL pipeline for Discovery+ subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Paramount+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process ESPN+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_espn+_legacy",
      "description": "Migration pipeline for legacy ESPN+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking HBO Max subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Peacock subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_apple_music_agg",
      "description": "Weekly aggregation pipeline for Apple Music metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_hulu_stream",
      "description": "Real-time streaming pipeline for Hulu events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10038 used Apple Music on Laptop under the Basic plan costing $20.03 in region SG.",
    "output": {
      "customer_id": "CUST-10038",
      "service_name": "Apple Music",
      "subscription_plan": "Basic",
      "monthly_price_usd": 20.03,
      "device_type": "Laptop",
      "region": "SG",
      "usage_hours": 3.33,
      "event_timestamp": "2024-06-28T12:11:21"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10146 used Discovery+ on Game Console under the Premium plan costing $15.13 in region MX.",
    "output": {
      "customer_id": "CUST-10146",
      "service_name": "Discovery+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 15.13,
      "device_type": "Game Console",
      "region": "MX",
      "usage_hours": 4.9,
      "event_timestamp": "2024-04-01T08:50:22"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Peacock subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Twitch subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_twitch_stream",
      "description": "Real-time streaming pipeline for Twitch events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_discovery+_etl",
      "description": "Daily ETL pipeline for Discovery+ subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_apple_music_stream",
      "description": "Real-time streaming pipeline for Apple Music events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process HBO Max subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_hbo_max_agg",
      "description": "Weekly aggregation pipeline for HBO Max metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking ESPN+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_apple_music_etl",
      "description": "Daily ETL pipeline for Apple Music subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "7x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10286 used Amazon Prime Video on Mobile under the Family plan costing $5.95 in region ES.",
    "output": {
      "customer_id": "CUST-10286",
      "service_name": "Amazon Prime Video",
      "subscription_plan": "Family",
      "monthly_price_usd": 5.95,
      "device_type": "Mobile",
      "region": "ES",
      "usage_hours": 11.04,
      "event_timestamp": "2024-12-01T02:14:44"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10289 used HBO Max on Game Console under the Premium plan costing $6.07 in region AU.",
    "output": {
      "customer_id": "CUST-10289",
      "service_name": "HBO Max",
      "subscription_plan": "Premium",
      "monthly_price_usd": 6.07,
      "device_type": "Game Console",
      "region": "AU",
      "usage_hours": 9.85,
      "event_timestamp": "2024-02-24T04:55:42"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10293 used Spotify on Desktop under the Premium plan costing $15.24 in region JP.",
    "output": {
      "customer_id": "CUST-10293",
      "service_name": "Spotify",
      "subscription_plan": "Premium",
      "monthly_price_usd": 15.24,
      "device_type": "Desktop",
      "region": "JP",
      "usage_hours": 9.73,
      "event_timestamp": "2024-07-18T02:12:58"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10240 used YouTube Premium on Mobile under the Student plan costing $16.97 in region ES.",
    "output": {
      "customer_id": "CUST-10240",
      "service_name": "YouTube Premium",
      "subscription_plan": "Student",
      "monthly_price_usd": 16.97,
      "device_type": "Mobile",
      "region": "ES",
      "usage_hours": 8.93,
      "event_timestamp": "2024-11-22T08:35:03"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking ESPN+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10352 used Twitch on Tablet under the Family plan costing $23.70 in region CA.",
    "output": {
      "customer_id": "CUST-10352",
      "service_name": "Twitch",
      "subscription_plan": "Family",
      "monthly_price_usd": 23.7,
      "device_type": "Tablet",
      "region": "CA",
      "usage_hours": 5.38,
      "event_timestamp": "2024-02-09T17:53:25"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Hulu subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10000 used Peacock on Tablet under the Basic plan costing $11.15 in region KR.",
    "output": {
      "customer_id": "CUST-10000",
      "service_name": "Peacock",
      "subscription_plan": "Basic",
      "monthly_price_usd": 11.15,
      "device_type": "Tablet",
      "region": "KR",
      "usage_hours": 2.37,
      "event_timestamp": "2024-12-24T13:52:43"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10015 used Discovery+ on Desktop under the Family plan costing $12.25 in region UK.",
    "output": {
      "customer_id": "CUST-10015",
      "service_name": "Discovery+",
      "subscription_plan": "Family",
      "monthly_price_usd": 12.25,
      "device_type": "Desktop",
      "region": "UK",
      "usage_hours": 8.1,
      "event_timestamp": "2024-01-23T21:08:32"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process ESPN+ subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_espn+_etl",
      "description": "Daily ETL pipeline for ESPN+ subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10338 used Twitch on Game Console under the Premium plan costing $12.21 in region UK.",
    "output": {
      "customer_id": "CUST-10338",
      "service_name": "Twitch",
      "subscription_plan": "Premium",
      "monthly_price_usd": 12.21,
      "device_type": "Game Console",
      "region": "UK",
      "usage_hours": 2.05,
      "event_timestamp": "2024-02-14T06:34:28"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "7x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Spotify subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_spotify_stream",
      "description": "Real-time streaming pipeline for Spotify events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Hulu subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10194 used Disney+ on Desktop under the Student plan costing $18.00 in region MX.",
    "output": {
      "customer_id": "CUST-10194",
      "service_name": "Disney+",
      "subscription_plan": "Student",
      "monthly_price_usd": 18.0,
      "device_type": "Desktop",
      "region": "MX",
      "usage_hours": 4.97,
      "event_timestamp": "2024-09-18T05:12:30"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Spotify subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_spotify_etl",
      "description": "Daily ETL pipeline for Spotify subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10253 used Crunchyroll on Laptop under the Student plan costing $28.97 in region JP.",
    "output": {
      "customer_id": "CUST-10253",
      "service_name": "Crunchyroll",
      "subscription_plan": "Student",
      "monthly_price_usd": 28.97,
      "device_type": "Laptop",
      "region": "JP",
      "usage_hours": 7.78,
      "event_timestamp": "2024-11-28T00:57:26"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10321 used Amazon Prime Video on Smart TV under the Annual plan costing $13.19 in region UK.",
    "output": {
      "customer_id": "CUST-10321",
      "service_name": "Amazon Prime Video",
      "subscription_plan": "Annual",
      "monthly_price_usd": 13.19,
      "device_type": "Smart TV",
      "region": "UK",
      "usage_hours": 10.05,
      "event_timestamp": "2024-04-03T19:12:04"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking YouTube Premium subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_paramount+_agg",
      "description": "Weekly aggregation pipeline for Paramount+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking YouTube Premium subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Hulu subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_hulu_legacy",
      "description": "Migration pipeline for legacy Hulu data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10251 used Netflix on Smart TV under the Student plan costing $29.77 in region ES.",
    "output": {
      "customer_id": "CUST-10251",
      "service_name": "Netflix",
      "subscription_plan": "Student",
      "monthly_price_usd": 29.77,
      "device_type": "Smart TV",
      "region": "ES",
      "usage_hours": 8.67,
      "event_timestamp": "2024-07-24T04:43:20"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Crunchyroll subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_crunchyroll_legacy",
      "description": "Migration pipeline for legacy Crunchyroll data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10005 used Netflix on Laptop under the Student plan costing $23.40 in region UK.",
    "output": {
      "customer_id": "CUST-10005",
      "service_name": "Netflix",
      "subscription_plan": "Student",
      "monthly_price_usd": 23.4,
      "device_type": "Laptop",
      "region": "UK",
      "usage_hours": 7.48,
      "event_timestamp": "2024-06-24T10:26:21"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Peacock subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_peacock_etl",
      "description": "Daily ETL pipeline for Peacock subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10235 used Disney+ on Smart TV under the Premium plan costing $14.22 in region DE.",
    "output": {
      "customer_id": "CUST-10235",
      "service_name": "Disney+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 14.22,
      "device_type": "Smart TV",
      "region": "DE",
      "usage_hours": 9.53,
      "event_timestamp": "2024-06-22T11:05:22"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking YouTube Premium subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "12x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Amazon Prime Video subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_amazon_prime_video_stream",
      "description": "Real-time streaming pipeline for Amazon Prime Video events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10144 used Crunchyroll on Laptop under the Student plan costing $15.75 in region FR.",
    "output": {
      "customer_id": "CUST-10144",
      "service_name": "Crunchyroll",
      "subscription_plan": "Student",
      "monthly_price_usd": 15.75,
      "device_type": "Laptop",
      "region": "FR",
      "usage_hours": 6.64,
      "event_timestamp": "2024-08-23T01:39:02"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Spotify subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_spotify_legacy",
      "description": "Migration pipeline for legacy Spotify data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10225 used Peacock on Game Console under the Premium plan costing $10.94 in region CN.",
    "output": {
      "customer_id": "CUST-10225",
      "service_name": "Peacock",
      "subscription_plan": "Premium",
      "monthly_price_usd": 10.94,
      "device_type": "Game Console",
      "region": "CN",
      "usage_hours": 4.63,
      "event_timestamp": "2024-01-16T10:01:02"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10277 used Apple Music on Tablet under the Basic plan costing $15.50 in region MX.",
    "output": {
      "customer_id": "CUST-10277",
      "service_name": "Apple Music",
      "subscription_plan": "Basic",
      "monthly_price_usd": 15.5,
      "device_type": "Tablet",
      "region": "MX",
      "usage_hours": 4.48,
      "event_timestamp": "2024-04-13T04:47:47"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Peacock subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process ESPN+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_espn+_agg",
      "description": "Weekly aggregation pipeline for ESPN+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10256 used ESPN+ on Mobile under the Premium plan costing $9.18 in region CA.",
    "output": {
      "customer_id": "CUST-10256",
      "service_name": "ESPN+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 9.18,
      "device_type": "Mobile",
      "region": "CA",
      "usage_hours": 1.31,
      "event_timestamp": "2024-02-03T06:01:03"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Paramount+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10023 used Crunchyroll on Mobile under the Family plan costing $26.50 in region CA.",
    "output": {
      "customer_id": "CUST-10023",
      "service_name": "Crunchyroll",
      "subscription_plan": "Family",
      "monthly_price_usd": 26.5,
      "device_type": "Mobile",
      "region": "CA",
      "usage_hours": 10.74,
      "event_timestamp": "2024-10-27T12:41:19"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10069 used Twitch on Smart TV under the Premium plan costing $5.93 in region DE.",
    "output": {
      "customer_id": "CUST-10069",
      "service_name": "Twitch",
      "subscription_plan": "Premium",
      "monthly_price_usd": 5.93,
      "device_type": "Smart TV",
      "region": "DE",
      "usage_hours": 8.54,
      "event_timestamp": "2024-02-15T10:59:07"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking ESPN+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10197 used ESPN+ on Tablet under the Family plan costing $27.36 in region MX.",
    "output": {
      "customer_id": "CUST-10197",
      "service_name": "ESPN+",
      "subscription_plan": "Family",
      "monthly_price_usd": 27.36,
      "device_type": "Tablet",
      "region": "MX",
      "usage_hours": 8.21,
      "event_timestamp": "2024-03-21T21:12:46"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10177 used Peacock on Smart TV under the Annual plan costing $5.74 in region JP.",
    "output": {
      "customer_id": "CUST-10177",
      "service_name": "Peacock",
      "subscription_plan": "Annual",
      "monthly_price_usd": 5.74,
      "device_type": "Smart TV",
      "region": "JP",
      "usage_hours": 8.11,
      "event_timestamp": "2024-02-23T05:14:36"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "12x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10012 used Paramount+ on Smart TV under the Family plan costing $26.75 in region CA.",
    "output": {
      "customer_id": "CUST-10012",
      "service_name": "Paramount+",
      "subscription_plan": "Family",
      "monthly_price_usd": 26.75,
      "device_type": "Smart TV",
      "region": "CA",
      "usage_hours": 11.24,
      "event_timestamp": "2024-02-16T14:09:48"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10268 used Crunchyroll on Tablet under the Premium plan costing $10.99 in region CN.",
    "output": {
      "customer_id": "CUST-10268",
      "service_name": "Crunchyroll",
      "subscription_plan": "Premium",
      "monthly_price_usd": 10.99,
      "device_type": "Tablet",
      "region": "CN",
      "usage_hours": 2.03,
      "event_timestamp": "2024-11-05T15:44:12"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_discovery+_stream",
      "description": "Real-time streaming pipeline for Discovery+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Crunchyroll subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_crunchyroll_stream",
      "description": "Real-time streaming pipeline for Crunchyroll events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10097 used Discovery+ on Game Console under the Annual plan costing $28.54 in region JP.",
    "output": {
      "customer_id": "CUST-10097",
      "service_name": "Discovery+",
      "subscription_plan": "Annual",
      "monthly_price_usd": 28.54,
      "device_type": "Game Console",
      "region": "JP",
      "usage_hours": 9.23,
      "event_timestamp": "2024-10-13T10:12:09"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_paramount+_agg",
      "description": "Weekly aggregation pipeline for Paramount+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10122 used Apple Music on Desktop under the Student plan costing $19.20 in region MX.",
    "output": {
      "customer_id": "CUST-10122",
      "service_name": "Apple Music",
      "subscription_plan": "Student",
      "monthly_price_usd": 19.2,
      "device_type": "Desktop",
      "region": "MX",
      "usage_hours": 1.15,
      "event_timestamp": "2024-11-23T16:17:39"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple TV+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_apple_tv+_agg",
      "description": "Weekly aggregation pipeline for Apple TV+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10368 used Discovery+ on Smart TV under the Premium plan costing $21.80 in region UK.",
    "output": {
      "customer_id": "CUST-10368",
      "service_name": "Discovery+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 21.8,
      "device_type": "Smart TV",
      "region": "UK",
      "usage_hours": 4.26,
      "event_timestamp": "2024-10-03T21:17:06"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_netflix_stream",
      "description": "Real-time streaming pipeline for Netflix events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "7x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking YouTube Premium subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10247 used Apple TV+ on Game Console under the Family plan costing $29.83 in region JP.",
    "output": {
      "customer_id": "CUST-10247",
      "service_name": "Apple TV+",
      "subscription_plan": "Family",
      "monthly_price_usd": 29.83,
      "device_type": "Game Console",
      "region": "JP",
      "usage_hours": 6.18,
      "event_timestamp": "2024-01-22T04:54:06"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10354 used Netflix on Mobile under the Family plan costing $22.98 in region JP.",
    "output": {
      "customer_id": "CUST-10354",
      "service_name": "Netflix",
      "subscription_plan": "Family",
      "monthly_price_usd": 22.98,
      "device_type": "Mobile",
      "region": "JP",
      "usage_hours": 0.87,
      "event_timestamp": "2024-07-26T06:41:42"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process HBO Max subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_hbo_max_agg",
      "description": "Weekly aggregation pipeline for HBO Max metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Twitch subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_twitch_agg",
      "description": "Weekly aggregation pipeline for Twitch metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10125 used YouTube Premium on Tablet under the Premium plan costing $13.17 in region US.",
    "output": {
      "customer_id": "CUST-10125",
      "service_name": "YouTube Premium",
      "subscription_plan": "Premium",
      "monthly_price_usd": 13.17,
      "device_type": "Tablet",
      "region": "US",
      "usage_hours": 4.62,
      "event_timestamp": "2024-01-06T12:03:13"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process HBO Max subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_hbo_max_legacy",
      "description": "Migration pipeline for legacy HBO Max data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10105 used Discovery+ on Mobile under the Student plan costing $27.80 in region SG.",
    "output": {
      "customer_id": "CUST-10105",
      "service_name": "Discovery+",
      "subscription_plan": "Student",
      "monthly_price_usd": 27.8,
      "device_type": "Mobile",
      "region": "SG",
      "usage_hours": 2.72,
      "event_timestamp": "2024-07-20T09:22:46"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_paramount+_etl",
      "description": "Daily ETL pipeline for Paramount+ subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process ESPN+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_espn+_legacy",
      "description": "Migration pipeline for legacy ESPN+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process HBO Max subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_hbo_max_agg",
      "description": "Weekly aggregation pipeline for HBO Max metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10157 used ESPN+ on Game Console under the Family plan costing $24.91 in region JP.",
    "output": {
      "customer_id": "CUST-10157",
      "service_name": "ESPN+",
      "subscription_plan": "Family",
      "monthly_price_usd": 24.91,
      "device_type": "Game Console",
      "region": "JP",
      "usage_hours": 10.06,
      "event_timestamp": "2024-10-17T17:28:48"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking ESPN+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10335 used Paramount+ on Laptop under the Basic plan costing $20.50 in region CA.",
    "output": {
      "customer_id": "CUST-10335",
      "service_name": "Paramount+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 20.5,
      "device_type": "Laptop",
      "region": "CA",
      "usage_hours": 5.25,
      "event_timestamp": "2024-02-10T10:27:21"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple TV+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_apple_tv+_stream",
      "description": "Real-time streaming pipeline for Apple TV+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10283 used Apple TV+ on Desktop under the Family plan costing $15.94 in region DE.",
    "output": {
      "customer_id": "CUST-10283",
      "service_name": "Apple TV+",
      "subscription_plan": "Family",
      "monthly_price_usd": 15.94,
      "device_type": "Desktop",
      "region": "DE",
      "usage_hours": 1.72,
      "event_timestamp": "2024-11-10T10:17:28"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking ESPN+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process ESPN+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_espn+_legacy",
      "description": "Migration pipeline for legacy ESPN+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Amazon Prime Video subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_amazon_prime_video_agg",
      "description": "Weekly aggregation pipeline for Amazon Prime Video metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_apple_music_agg",
      "description": "Weekly aggregation pipeline for Apple Music metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_apple_music_legacy",
      "description": "Migration pipeline for legacy Apple Music data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple Music subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10182 used Apple TV+ on Tablet under the Annual plan costing $19.12 in region CN.",
    "output": {
      "customer_id": "CUST-10182",
      "service_name": "Apple TV+",
      "subscription_plan": "Annual",
      "monthly_price_usd": 19.12,
      "device_type": "Tablet",
      "region": "CN",
      "usage_hours": 6.8,
      "event_timestamp": "2024-08-06T13:04:24"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10080 used Netflix on Smart TV under the Student plan costing $13.19 in region IT.",
    "output": {
      "customer_id": "CUST-10080",
      "service_name": "Netflix",
      "subscription_plan": "Student",
      "monthly_price_usd": 13.19,
      "device_type": "Smart TV",
      "region": "IT",
      "usage_hours": 2.3,
      "event_timestamp": "2024-07-18T00:06:06"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_apple_music_etl",
      "description": "Daily ETL pipeline for Apple Music subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Peacock subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "14x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Peacock subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_peacock_etl",
      "description": "Daily ETL pipeline for Peacock subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10380 used Paramount+ on Smart TV under the Family plan costing $21.72 in region DE.",
    "output": {
      "customer_id": "CUST-10380",
      "service_name": "Paramount+",
      "subscription_plan": "Family",
      "monthly_price_usd": 21.72,
      "device_type": "Smart TV",
      "region": "DE",
      "usage_hours": 2.7,
      "event_timestamp": "2024-10-16T18:29:29"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "12x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Spotify subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_spotify_legacy",
      "description": "Migration pipeline for legacy Spotify data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Peacock subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10272 used Amazon Prime Video on Smart TV under the Basic plan costing $10.78 in region IT.",
    "output": {
      "customer_id": "CUST-10272",
      "service_name": "Amazon Prime Video",
      "subscription_plan": "Basic",
      "monthly_price_usd": 10.78,
      "device_type": "Smart TV",
      "region": "IT",
      "usage_hours": 8.42,
      "event_timestamp": "2024-04-23T10:53:07"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "12x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_discovery+_agg",
      "description": "Weekly aggregation pipeline for Discovery+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10345 used Paramount+ on Game Console under the Family plan costing $23.07 in region KR.",
    "output": {
      "customer_id": "CUST-10345",
      "service_name": "Paramount+",
      "subscription_plan": "Family",
      "monthly_price_usd": 23.07,
      "device_type": "Game Console",
      "region": "KR",
      "usage_hours": 1.61,
      "event_timestamp": "2024-12-28T09:08:39"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Crunchyroll subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_crunchyroll_etl",
      "description": "Daily ETL pipeline for Crunchyroll subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Paramount+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10298 used Apple Music on Laptop under the Basic plan costing $10.80 in region DE.",
    "output": {
      "customer_id": "CUST-10298",
      "service_name": "Apple Music",
      "subscription_plan": "Basic",
      "monthly_price_usd": 10.8,
      "device_type": "Laptop",
      "region": "DE",
      "usage_hours": 6.19,
      "event_timestamp": "2024-03-05T00:26:36"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Crunchyroll subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "12x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "12x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10219 used Netflix on Tablet under the Student plan costing $14.99 in region IT.",
    "output": {
      "customer_id": "CUST-10219",
      "service_name": "Netflix",
      "subscription_plan": "Student",
      "monthly_price_usd": 14.99,
      "device_type": "Tablet",
      "region": "IT",
      "usage_hours": 11.85,
      "event_timestamp": "2024-05-10T10:54:50"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Crunchyroll subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_crunchyroll_stream",
      "description": "Real-time streaming pipeline for Crunchyroll events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Crunchyroll subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10086 used Amazon Prime Video on Smart TV under the Basic plan costing $18.95 in region IT.",
    "output": {
      "customer_id": "CUST-10086",
      "service_name": "Amazon Prime Video",
      "subscription_plan": "Basic",
      "monthly_price_usd": 18.95,
      "device_type": "Smart TV",
      "region": "IT",
      "usage_hours": 10.39,
      "event_timestamp": "2024-04-25T01:09:35"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10356 used Hulu on Smart TV under the Basic plan costing $19.51 in region IN.",
    "output": {
      "customer_id": "CUST-10356",
      "service_name": "Hulu",
      "subscription_plan": "Basic",
      "monthly_price_usd": 19.51,
      "device_type": "Smart TV",
      "region": "IN",
      "usage_hours": 7.21,
      "event_timestamp": "2024-04-20T00:10:14"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_paramount+_legacy",
      "description": "Migration pipeline for legacy Paramount+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking HBO Max subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Crunchyroll subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_crunchyroll_legacy",
      "description": "Migration pipeline for legacy Crunchyroll data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10242 used HBO Max on Desktop under the Annual plan costing $15.36 in region SG.",
    "output": {
      "customer_id": "CUST-10242",
      "service_name": "HBO Max",
      "subscription_plan": "Annual",
      "monthly_price_usd": 15.36,
      "device_type": "Desktop",
      "region": "SG",
      "usage_hours": 9.09,
      "event_timestamp": "2024-04-27T08:11:56"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10303 used Hulu on Mobile under the Annual plan costing $29.77 in region MX.",
    "output": {
      "customer_id": "CUST-10303",
      "service_name": "Hulu",
      "subscription_plan": "Annual",
      "monthly_price_usd": 29.77,
      "device_type": "Mobile",
      "region": "MX",
      "usage_hours": 9.06,
      "event_timestamp": "2024-08-14T14:49:12"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10115 used ESPN+ on Laptop under the Basic plan costing $29.38 in region JP.",
    "output": {
      "customer_id": "CUST-10115",
      "service_name": "ESPN+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 29.38,
      "device_type": "Laptop",
      "region": "JP",
      "usage_hours": 9.94,
      "event_timestamp": "2024-07-28T16:58:25"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10349 used Hulu on Tablet under the Premium plan costing $20.68 in region BR.",
    "output": {
      "customer_id": "CUST-10349",
      "service_name": "Hulu",
      "subscription_plan": "Premium",
      "monthly_price_usd": 20.68,
      "device_type": "Tablet",
      "region": "BR",
      "usage_hours": 11.77,
      "event_timestamp": "2024-05-28T12:34:04"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_netflix_etl",
      "description": "Daily ETL pipeline for Netflix subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_hulu_legacy",
      "description": "Migration pipeline for legacy Hulu data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "7x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple TV+ subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_apple_tv+_etl",
      "description": "Daily ETL pipeline for Apple TV+ subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Peacock subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_peacock_stream",
      "description": "Real-time streaming pipeline for Peacock events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_netflix_stream",
      "description": "Real-time streaming pipeline for Netflix events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple Music subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "12x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Spotify subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_spotify_etl",
      "description": "Daily ETL pipeline for Spotify subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_paramount+_etl",
      "description": "Daily ETL pipeline for Paramount+ subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "14x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Hulu subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10138 used Amazon Prime Video on Mobile under the Family plan costing $23.63 in region ES.",
    "output": {
      "customer_id": "CUST-10138",
      "service_name": "Amazon Prime Video",
      "subscription_plan": "Family",
      "monthly_price_usd": 23.63,
      "device_type": "Mobile",
      "region": "ES",
      "usage_hours": 9.05,
      "event_timestamp": "2024-11-04T12:53:09"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10273 used Twitch on Mobile under the Student plan costing $6.93 in region US.",
    "output": {
      "customer_id": "CUST-10273",
      "service_name": "Twitch",
      "subscription_plan": "Student",
      "monthly_price_usd": 6.93,
      "device_type": "Mobile",
      "region": "US",
      "usage_hours": 6.17,
      "event_timestamp": "2024-10-07T07:50:37"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10028 used ESPN+ on Laptop under the Basic plan costing $19.47 in region UK.",
    "output": {
      "customer_id": "CUST-10028",
      "service_name": "ESPN+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 19.47,
      "device_type": "Laptop",
      "region": "UK",
      "usage_hours": 8.06,
      "event_timestamp": "2024-05-26T12:23:41"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10365 used Disney+ on Laptop under the Basic plan costing $27.94 in region CN.",
    "output": {
      "customer_id": "CUST-10365",
      "service_name": "Disney+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 27.94,
      "device_type": "Laptop",
      "region": "CN",
      "usage_hours": 0.94,
      "event_timestamp": "2024-02-16T04:34:07"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10359 used Twitch on Tablet under the Basic plan costing $5.20 in region UK.",
    "output": {
      "customer_id": "CUST-10359",
      "service_name": "Twitch",
      "subscription_plan": "Basic",
      "monthly_price_usd": 5.2,
      "device_type": "Tablet",
      "region": "UK",
      "usage_hours": 5.62,
      "event_timestamp": "2024-12-07T01:11:00"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10348 used Spotify on Desktop under the Annual plan costing $24.49 in region UK.",
    "output": {
      "customer_id": "CUST-10348",
      "service_name": "Spotify",
      "subscription_plan": "Annual",
      "monthly_price_usd": 24.49,
      "device_type": "Desktop",
      "region": "UK",
      "usage_hours": 5.12,
      "event_timestamp": "2024-10-24T00:31:46"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10004 used Hulu on Game Console under the Premium plan costing $29.61 in region JP.",
    "output": {
      "customer_id": "CUST-10004",
      "service_name": "Hulu",
      "subscription_plan": "Premium",
      "monthly_price_usd": 29.61,
      "device_type": "Game Console",
      "region": "JP",
      "usage_hours": 3.89,
      "event_timestamp": "2024-02-23T04:22:09"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Peacock subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_peacock_legacy",
      "description": "Migration pipeline for legacy Peacock data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process HBO Max subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_hbo_max_etl",
      "description": "Daily ETL pipeline for HBO Max subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10104 used Peacock on Mobile under the Annual plan costing $25.85 in region CN.",
    "output": {
      "customer_id": "CUST-10104",
      "service_name": "Peacock",
      "subscription_plan": "Annual",
      "monthly_price_usd": 25.85,
      "device_type": "Mobile",
      "region": "CN",
      "usage_hours": 2.21,
      "event_timestamp": "2024-02-18T22:39:32"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Twitch subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_twitch_legacy",
      "description": "Migration pipeline for legacy Twitch data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "12x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Crunchyroll subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process YouTube Premium subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_youtube_premium_stream",
      "description": "Real-time streaming pipeline for YouTube Premium events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple TV+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_discovery+_legacy",
      "description": "Migration pipeline for legacy Discovery+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10229 used Discovery+ on Smart TV under the Premium plan costing $21.48 in region CA.",
    "output": {
      "customer_id": "CUST-10229",
      "service_name": "Discovery+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 21.48,
      "device_type": "Smart TV",
      "region": "CA",
      "usage_hours": 0.92,
      "event_timestamp": "2024-01-05T06:13:39"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking HBO Max subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple TV+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10175 used Spotify on Tablet under the Student plan costing $26.38 in region CN.",
    "output": {
      "customer_id": "CUST-10175",
      "service_name": "Spotify",
      "subscription_plan": "Student",
      "monthly_price_usd": 26.38,
      "device_type": "Tablet",
      "region": "CN",
      "usage_hours": 4.85,
      "event_timestamp": "2024-02-13T04:07:10"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10049 used Disney+ on Mobile under the Family plan costing $23.13 in region FR.",
    "output": {
      "customer_id": "CUST-10049",
      "service_name": "Disney+",
      "subscription_plan": "Family",
      "monthly_price_usd": 23.13,
      "device_type": "Mobile",
      "region": "FR",
      "usage_hours": 7.4,
      "event_timestamp": "2024-06-20T05:16:04"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Paramount+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Twitch subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_twitch_etl",
      "description": "Daily ETL pipeline for Twitch subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_netflix_agg",
      "description": "Weekly aggregation pipeline for Netflix metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10200 used Netflix on Smart TV under the Family plan costing $11.98 in region UK.",
    "output": {
      "customer_id": "CUST-10200",
      "service_name": "Netflix",
      "subscription_plan": "Family",
      "monthly_price_usd": 11.98,
      "device_type": "Smart TV",
      "region": "UK",
      "usage_hours": 2.24,
      "event_timestamp": "2024-09-26T12:44:21"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10098 used Twitch on Smart TV under the Student plan costing $15.94 in region CN.",
    "output": {
      "customer_id": "CUST-10098",
      "service_name": "Twitch",
      "subscription_plan": "Student",
      "monthly_price_usd": 15.94,
      "device_type": "Smart TV",
      "region": "CN",
      "usage_hours": 1.62,
      "event_timestamp": "2024-11-24T12:33:02"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple TV+ subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_apple_tv+_etl",
      "description": "Daily ETL pipeline for Apple TV+ subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "12x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10202 used Spotify on Laptop under the Annual plan costing $5.76 in region AU.",
    "output": {
      "customer_id": "CUST-10202",
      "service_name": "Spotify",
      "subscription_plan": "Annual",
      "monthly_price_usd": 5.76,
      "device_type": "Laptop",
      "region": "AU",
      "usage_hours": 8.49,
      "event_timestamp": "2024-12-19T14:46:17"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking ESPN+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking ESPN+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10378 used Spotify on Smart TV under the Basic plan costing $15.60 in region CN.",
    "output": {
      "customer_id": "CUST-10378",
      "service_name": "Spotify",
      "subscription_plan": "Basic",
      "monthly_price_usd": 15.6,
      "device_type": "Smart TV",
      "region": "CN",
      "usage_hours": 1.98,
      "event_timestamp": "2024-05-20T10:14:35"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Crunchyroll subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_apple_music_agg",
      "description": "Weekly aggregation pipeline for Apple Music metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_discovery+_etl",
      "description": "Daily ETL pipeline for Discovery+ subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10153 used Apple Music on Desktop under the Student plan costing $9.31 in region FR.",
    "output": {
      "customer_id": "CUST-10153",
      "service_name": "Apple Music",
      "subscription_plan": "Student",
      "monthly_price_usd": 9.31,
      "device_type": "Desktop",
      "region": "FR",
      "usage_hours": 10.99,
      "event_timestamp": "2024-07-12T06:46:49"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_netflix_etl",
      "description": "Daily ETL pipeline for Netflix subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "14x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10088 used HBO Max on Mobile under the Premium plan costing $12.15 in region US.",
    "output": {
      "customer_id": "CUST-10088",
      "service_name": "HBO Max",
      "subscription_plan": "Premium",
      "monthly_price_usd": 12.15,
      "device_type": "Mobile",
      "region": "US",
      "usage_hours": 1.56,
      "event_timestamp": "2024-10-27T07:17:56"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple TV+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_apple_tv+_stream",
      "description": "Real-time streaming pipeline for Apple TV+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Hulu subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "14x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple Music subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Disney+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Spotify subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_spotify_stream",
      "description": "Real-time streaming pipeline for Spotify events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process HBO Max subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_hbo_max_etl",
      "description": "Daily ETL pipeline for HBO Max subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_netflix_etl",
      "description": "Daily ETL pipeline for Netflix subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "12x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Twitch subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_twitch_legacy",
      "description": "Migration pipeline for legacy Twitch data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Disney+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10363 used Peacock on Smart TV under the Family plan costing $26.23 in region AU.",
    "output": {
      "customer_id": "CUST-10363",
      "service_name": "Peacock",
      "subscription_plan": "Family",
      "monthly_price_usd": 26.23,
      "device_type": "Smart TV",
      "region": "AU",
      "usage_hours": 7.37,
      "event_timestamp": "2024-10-06T00:39:40"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple TV+ subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_apple_tv+_etl",
      "description": "Daily ETL pipeline for Apple TV+ subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "12x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process ESPN+ subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_espn+_etl",
      "description": "Daily ETL pipeline for ESPN+ subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10276 used Hulu on Game Console under the Student plan costing $13.75 in region FR.",
    "output": {
      "customer_id": "CUST-10276",
      "service_name": "Hulu",
      "subscription_plan": "Student",
      "monthly_price_usd": 13.75,
      "device_type": "Game Console",
      "region": "FR",
      "usage_hours": 10.04,
      "event_timestamp": "2024-05-18T10:19:43"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Crunchyroll subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10357 used Peacock on Game Console under the Student plan costing $20.31 in region US.",
    "output": {
      "customer_id": "CUST-10357",
      "service_name": "Peacock",
      "subscription_plan": "Student",
      "monthly_price_usd": 20.31,
      "device_type": "Game Console",
      "region": "US",
      "usage_hours": 11.75,
      "event_timestamp": "2024-04-17T14:47:56"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Paramount+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10342 used ESPN+ on Smart TV under the Family plan costing $5.27 in region FR.",
    "output": {
      "customer_id": "CUST-10342",
      "service_name": "ESPN+",
      "subscription_plan": "Family",
      "monthly_price_usd": 5.27,
      "device_type": "Smart TV",
      "region": "FR",
      "usage_hours": 1.88,
      "event_timestamp": "2024-05-25T07:00:16"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_apple_music_etl",
      "description": "Daily ETL pipeline for Apple Music subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Crunchyroll subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_crunchyroll_agg",
      "description": "Weekly aggregation pipeline for Crunchyroll metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Twitch subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_twitch_legacy",
      "description": "Migration pipeline for legacy Twitch data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10292 used Amazon Prime Video on Mobile under the Premium plan costing $23.34 in region FR.",
    "output": {
      "customer_id": "CUST-10292",
      "service_name": "Amazon Prime Video",
      "subscription_plan": "Premium",
      "monthly_price_usd": 23.34,
      "device_type": "Mobile",
      "region": "FR",
      "usage_hours": 0.63,
      "event_timestamp": "2024-08-21T00:55:55"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10139 used Disney+ on Mobile under the Basic plan costing $12.85 in region DE.",
    "output": {
      "customer_id": "CUST-10139",
      "service_name": "Disney+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 12.85,
      "device_type": "Mobile",
      "region": "DE",
      "usage_hours": 6.09,
      "event_timestamp": "2024-09-02T03:41:20"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10073 used Amazon Prime Video on Mobile under the Annual plan costing $26.11 in region DE.",
    "output": {
      "customer_id": "CUST-10073",
      "service_name": "Amazon Prime Video",
      "subscription_plan": "Annual",
      "monthly_price_usd": 26.11,
      "device_type": "Mobile",
      "region": "DE",
      "usage_hours": 9.64,
      "event_timestamp": "2024-10-05T20:11:03"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Peacock subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_peacock_agg",
      "description": "Weekly aggregation pipeline for Peacock metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "7x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking ESPN+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Twitch subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_twitch_etl",
      "description": "Daily ETL pipeline for Twitch subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10022 used Disney+ on Smart TV under the Annual plan costing $16.91 in region KR.",
    "output": {
      "customer_id": "CUST-10022",
      "service_name": "Disney+",
      "subscription_plan": "Annual",
      "monthly_price_usd": 16.91,
      "device_type": "Smart TV",
      "region": "KR",
      "usage_hours": 1.29,
      "event_timestamp": "2024-05-18T10:05:05"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking HBO Max subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Crunchyroll subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_crunchyroll_agg",
      "description": "Weekly aggregation pipeline for Crunchyroll metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "14x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10311 used Twitch on Laptop under the Family plan costing $5.06 in region BR.",
    "output": {
      "customer_id": "CUST-10311",
      "service_name": "Twitch",
      "subscription_plan": "Family",
      "monthly_price_usd": 5.06,
      "device_type": "Laptop",
      "region": "BR",
      "usage_hours": 6.82,
      "event_timestamp": "2024-12-23T05:41:50"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Crunchyroll subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_hulu_agg",
      "description": "Weekly aggregation pipeline for Hulu metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Twitch subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_twitch_stream",
      "description": "Real-time streaming pipeline for Twitch events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "12x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_paramount+_stream",
      "description": "Real-time streaming pipeline for Paramount+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process HBO Max subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_hbo_max_stream",
      "description": "Real-time streaming pipeline for HBO Max events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10051 used HBO Max on Laptop under the Family plan costing $12.28 in region KR.",
    "output": {
      "customer_id": "CUST-10051",
      "service_name": "HBO Max",
      "subscription_plan": "Family",
      "monthly_price_usd": 12.28,
      "device_type": "Laptop",
      "region": "KR",
      "usage_hours": 10.41,
      "event_timestamp": "2024-02-28T01:00:38"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10014 used Hulu on Game Console under the Student plan costing $24.99 in region BR.",
    "output": {
      "customer_id": "CUST-10014",
      "service_name": "Hulu",
      "subscription_plan": "Student",
      "monthly_price_usd": 24.99,
      "device_type": "Game Console",
      "region": "BR",
      "usage_hours": 0.7,
      "event_timestamp": "2024-05-11T02:00:12"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking ESPN+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple TV+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_apple_tv+_agg",
      "description": "Weekly aggregation pipeline for Apple TV+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Amazon Prime Video subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_amazon_prime_video_agg",
      "description": "Weekly aggregation pipeline for Amazon Prime Video metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Peacock subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10243 used YouTube Premium on Laptop under the Student plan costing $11.10 in region AU.",
    "output": {
      "customer_id": "CUST-10243",
      "service_name": "YouTube Premium",
      "subscription_plan": "Student",
      "monthly_price_usd": 11.1,
      "device_type": "Laptop",
      "region": "AU",
      "usage_hours": 0.75,
      "event_timestamp": "2024-02-24T18:36:39"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Crunchyroll subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10106 used Twitch on Desktop under the Student plan costing $11.00 in region FR.",
    "output": {
      "customer_id": "CUST-10106",
      "service_name": "Twitch",
      "subscription_plan": "Student",
      "monthly_price_usd": 11.0,
      "device_type": "Desktop",
      "region": "FR",
      "usage_hours": 11.7,
      "event_timestamp": "2024-04-26T02:49:59"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10340 used YouTube Premium on Laptop under the Student plan costing $24.72 in region JP.",
    "output": {
      "customer_id": "CUST-10340",
      "service_name": "YouTube Premium",
      "subscription_plan": "Student",
      "monthly_price_usd": 24.72,
      "device_type": "Laptop",
      "region": "JP",
      "usage_hours": 7.9,
      "event_timestamp": "2024-09-10T16:34:12"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Paramount+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Hulu subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Spotify subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_spotify_etl",
      "description": "Daily ETL pipeline for Spotify subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process HBO Max subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_hbo_max_stream",
      "description": "Real-time streaming pipeline for HBO Max events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "14x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10156 used Peacock on Tablet under the Annual plan costing $16.74 in region US.",
    "output": {
      "customer_id": "CUST-10156",
      "service_name": "Peacock",
      "subscription_plan": "Annual",
      "monthly_price_usd": 16.74,
      "device_type": "Tablet",
      "region": "US",
      "usage_hours": 0.69,
      "event_timestamp": "2024-02-25T05:30:02"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple TV+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_apple_tv+_stream",
      "description": "Real-time streaming pipeline for Apple TV+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10044 used Peacock on Desktop under the Student plan costing $21.52 in region US.",
    "output": {
      "customer_id": "CUST-10044",
      "service_name": "Peacock",
      "subscription_plan": "Student",
      "monthly_price_usd": 21.52,
      "device_type": "Desktop",
      "region": "US",
      "usage_hours": 8.28,
      "event_timestamp": "2024-10-04T02:20:55"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking ESPN+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Hulu subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process YouTube Premium subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_youtube_premium_etl",
      "description": "Daily ETL pipeline for YouTube Premium subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple Music subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10203 used YouTube Premium on Mobile under the Student plan costing $11.75 in region IT.",
    "output": {
      "customer_id": "CUST-10203",
      "service_name": "YouTube Premium",
      "subscription_plan": "Student",
      "monthly_price_usd": 11.75,
      "device_type": "Mobile",
      "region": "IT",
      "usage_hours": 10.34,
      "event_timestamp": "2024-10-06T10:14:37"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_discovery+_legacy",
      "description": "Migration pipeline for legacy Discovery+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Crunchyroll subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_crunchyroll_agg",
      "description": "Weekly aggregation pipeline for Crunchyroll metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10047 used Discovery+ on Mobile under the Premium plan costing $11.81 in region US.",
    "output": {
      "customer_id": "CUST-10047",
      "service_name": "Discovery+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 11.81,
      "device_type": "Mobile",
      "region": "US",
      "usage_hours": 5.8,
      "event_timestamp": "2024-12-27T15:08:11"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process HBO Max subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_hbo_max_legacy",
      "description": "Migration pipeline for legacy HBO Max data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10150 used Netflix on Tablet under the Premium plan costing $12.76 in region CA.",
    "output": {
      "customer_id": "CUST-10150",
      "service_name": "Netflix",
      "subscription_plan": "Premium",
      "monthly_price_usd": 12.76,
      "device_type": "Tablet",
      "region": "CA",
      "usage_hours": 4.49,
      "event_timestamp": "2024-10-18T01:50:34"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Peacock subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_peacock_agg",
      "description": "Weekly aggregation pipeline for Peacock metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple TV+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_apple_tv+_stream",
      "description": "Real-time streaming pipeline for Apple TV+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_hulu_etl",
      "description": "Daily ETL pipeline for Hulu subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process YouTube Premium subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_youtube_premium_etl",
      "description": "Daily ETL pipeline for YouTube Premium subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking HBO Max subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Amazon Prime Video subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_amazon_prime_video_stream",
      "description": "Real-time streaming pipeline for Amazon Prime Video events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Peacock subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking HBO Max subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10239 used Paramount+ on Laptop under the Annual plan costing $28.11 in region IN.",
    "output": {
      "customer_id": "CUST-10239",
      "service_name": "Paramount+",
      "subscription_plan": "Annual",
      "monthly_price_usd": 28.11,
      "device_type": "Laptop",
      "region": "IN",
      "usage_hours": 4.74,
      "event_timestamp": "2024-04-26T18:52:11"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10361 used Twitch on Tablet under the Basic plan costing $5.44 in region BR.",
    "output": {
      "customer_id": "CUST-10361",
      "service_name": "Twitch",
      "subscription_plan": "Basic",
      "monthly_price_usd": 5.44,
      "device_type": "Tablet",
      "region": "BR",
      "usage_hours": 8.28,
      "event_timestamp": "2024-08-13T02:49:33"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Hulu subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10135 used Amazon Prime Video on Desktop under the Student plan costing $28.79 in region FR.",
    "output": {
      "customer_id": "CUST-10135",
      "service_name": "Amazon Prime Video",
      "subscription_plan": "Student",
      "monthly_price_usd": 28.79,
      "device_type": "Desktop",
      "region": "FR",
      "usage_hours": 2.64,
      "event_timestamp": "2024-09-04T16:00:08"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "14x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_apple_music_etl",
      "description": "Daily ETL pipeline for Apple Music subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple TV+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_netflix_agg",
      "description": "Weekly aggregation pipeline for Netflix metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple TV+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "12x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple TV+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "12x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_discovery+_legacy",
      "description": "Migration pipeline for legacy Discovery+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10100 used YouTube Premium on Mobile under the Annual plan costing $17.42 in region DE.",
    "output": {
      "customer_id": "CUST-10100",
      "service_name": "YouTube Premium",
      "subscription_plan": "Annual",
      "monthly_price_usd": 17.42,
      "device_type": "Mobile",
      "region": "DE",
      "usage_hours": 2.56,
      "event_timestamp": "2024-07-17T20:04:43"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "12x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process YouTube Premium subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_youtube_premium_stream",
      "description": "Real-time streaming pipeline for YouTube Premium events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_apple_music_agg",
      "description": "Weekly aggregation pipeline for Apple Music metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_paramount+_legacy",
      "description": "Migration pipeline for legacy Paramount+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Crunchyroll subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_crunchyroll_stream",
      "description": "Real-time streaming pipeline for Crunchyroll events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10045 used HBO Max on Laptop under the Premium plan costing $20.77 in region US.",
    "output": {
      "customer_id": "CUST-10045",
      "service_name": "HBO Max",
      "subscription_plan": "Premium",
      "monthly_price_usd": 20.77,
      "device_type": "Laptop",
      "region": "US",
      "usage_hours": 1.31,
      "event_timestamp": "2024-10-23T20:56:37"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10334 used Netflix on Game Console under the Basic plan costing $16.05 in region CN.",
    "output": {
      "customer_id": "CUST-10334",
      "service_name": "Netflix",
      "subscription_plan": "Basic",
      "monthly_price_usd": 16.05,
      "device_type": "Game Console",
      "region": "CN",
      "usage_hours": 6.82,
      "event_timestamp": "2024-01-01T08:48:29"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10339 used Disney+ on Smart TV under the Family plan costing $13.84 in region MX.",
    "output": {
      "customer_id": "CUST-10339",
      "service_name": "Disney+",
      "subscription_plan": "Family",
      "monthly_price_usd": 13.84,
      "device_type": "Smart TV",
      "region": "MX",
      "usage_hours": 10.6,
      "event_timestamp": "2024-08-14T17:16:39"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10119 used Hulu on Game Console under the Family plan costing $5.58 in region DE.",
    "output": {
      "customer_id": "CUST-10119",
      "service_name": "Hulu",
      "subscription_plan": "Family",
      "monthly_price_usd": 5.58,
      "device_type": "Game Console",
      "region": "DE",
      "usage_hours": 10.32,
      "event_timestamp": "2024-12-20T13:13:09"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_hulu_legacy",
      "description": "Migration pipeline for legacy Hulu data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10166 used Hulu on Tablet under the Annual plan costing $17.96 in region CA.",
    "output": {
      "customer_id": "CUST-10166",
      "service_name": "Hulu",
      "subscription_plan": "Annual",
      "monthly_price_usd": 17.96,
      "device_type": "Tablet",
      "region": "CA",
      "usage_hours": 10.61,
      "event_timestamp": "2024-07-19T15:36:58"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Disney+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple Music subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Spotify subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_spotify_stream",
      "description": "Real-time streaming pipeline for Spotify events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple Music subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking YouTube Premium subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10062 used YouTube Premium on Laptop under the Annual plan costing $27.66 in region FR.",
    "output": {
      "customer_id": "CUST-10062",
      "service_name": "YouTube Premium",
      "subscription_plan": "Annual",
      "monthly_price_usd": 27.66,
      "device_type": "Laptop",
      "region": "FR",
      "usage_hours": 1.2,
      "event_timestamp": "2024-04-15T14:28:33"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10224 used Apple Music on Mobile under the Family plan costing $28.80 in region KR.",
    "output": {
      "customer_id": "CUST-10224",
      "service_name": "Apple Music",
      "subscription_plan": "Family",
      "monthly_price_usd": 28.8,
      "device_type": "Mobile",
      "region": "KR",
      "usage_hours": 4.75,
      "event_timestamp": "2024-04-19T17:42:58"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple TV+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_apple_tv+_legacy",
      "description": "Migration pipeline for legacy Apple TV+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_paramount+_etl",
      "description": "Daily ETL pipeline for Paramount+ subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Disney+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10099 used Amazon Prime Video on Mobile under the Family plan costing $8.38 in region ES.",
    "output": {
      "customer_id": "CUST-10099",
      "service_name": "Amazon Prime Video",
      "subscription_plan": "Family",
      "monthly_price_usd": 8.38,
      "device_type": "Mobile",
      "region": "ES",
      "usage_hours": 2.59,
      "event_timestamp": "2024-12-07T16:05:53"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking HBO Max subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Peacock subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process YouTube Premium subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_youtube_premium_legacy",
      "description": "Migration pipeline for legacy YouTube Premium data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10083 used Spotify on Tablet under the Family plan costing $28.75 in region BR.",
    "output": {
      "customer_id": "CUST-10083",
      "service_name": "Spotify",
      "subscription_plan": "Family",
      "monthly_price_usd": 28.75,
      "device_type": "Tablet",
      "region": "BR",
      "usage_hours": 1.95,
      "event_timestamp": "2024-06-28T02:22:14"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process ESPN+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_espn+_stream",
      "description": "Real-time streaming pipeline for ESPN+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple TV+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Crunchyroll subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_crunchyroll_etl",
      "description": "Daily ETL pipeline for Crunchyroll subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple TV+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process YouTube Premium subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_youtube_premium_legacy",
      "description": "Migration pipeline for legacy YouTube Premium data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Paramount+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process ESPN+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_espn+_stream",
      "description": "Real-time streaming pipeline for ESPN+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10315 used Apple TV+ on Smart TV under the Basic plan costing $21.23 in region AU.",
    "output": {
      "customer_id": "CUST-10315",
      "service_name": "Apple TV+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 21.23,
      "device_type": "Smart TV",
      "region": "AU",
      "usage_hours": 8.89,
      "event_timestamp": "2024-09-02T01:41:51"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10346 used Netflix on Mobile under the Student plan costing $15.16 in region KR.",
    "output": {
      "customer_id": "CUST-10346",
      "service_name": "Netflix",
      "subscription_plan": "Student",
      "monthly_price_usd": 15.16,
      "device_type": "Mobile",
      "region": "KR",
      "usage_hours": 6.37,
      "event_timestamp": "2024-07-04T11:47:52"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10140 used Hulu on Smart TV under the Basic plan costing $20.96 in region UK.",
    "output": {
      "customer_id": "CUST-10140",
      "service_name": "Hulu",
      "subscription_plan": "Basic",
      "monthly_price_usd": 20.96,
      "device_type": "Smart TV",
      "region": "UK",
      "usage_hours": 10.53,
      "event_timestamp": "2024-10-21T09:01:17"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "7x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple TV+ subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_apple_tv+_etl",
      "description": "Daily ETL pipeline for Apple TV+ subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10129 used YouTube Premium on Tablet under the Basic plan costing $13.87 in region AU.",
    "output": {
      "customer_id": "CUST-10129",
      "service_name": "YouTube Premium",
      "subscription_plan": "Basic",
      "monthly_price_usd": 13.87,
      "device_type": "Tablet",
      "region": "AU",
      "usage_hours": 1.66,
      "event_timestamp": "2024-07-13T10:53:14"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process ESPN+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_espn+_agg",
      "description": "Weekly aggregation pipeline for ESPN+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Crunchyroll subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_crunchyroll_agg",
      "description": "Weekly aggregation pipeline for Crunchyroll metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10222 used HBO Max on Smart TV under the Annual plan costing $22.85 in region MX.",
    "output": {
      "customer_id": "CUST-10222",
      "service_name": "HBO Max",
      "subscription_plan": "Annual",
      "monthly_price_usd": 22.85,
      "device_type": "Smart TV",
      "region": "MX",
      "usage_hours": 6.0,
      "event_timestamp": "2024-11-10T21:12:33"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Spotify subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_spotify_etl",
      "description": "Daily ETL pipeline for Spotify subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Amazon Prime Video subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_amazon_prime_video_agg",
      "description": "Weekly aggregation pipeline for Amazon Prime Video metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10167 used Apple TV+ on Smart TV under the Student plan costing $26.54 in region UK.",
    "output": {
      "customer_id": "CUST-10167",
      "service_name": "Apple TV+",
      "subscription_plan": "Student",
      "monthly_price_usd": 26.54,
      "device_type": "Smart TV",
      "region": "UK",
      "usage_hours": 7.56,
      "event_timestamp": "2024-01-13T16:35:22"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_apple_music_stream",
      "description": "Real-time streaming pipeline for Apple Music events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Twitch subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_twitch_etl",
      "description": "Daily ETL pipeline for Twitch subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Hulu subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking YouTube Premium subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_netflix_stream",
      "description": "Real-time streaming pipeline for Netflix events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10322 used Amazon Prime Video on Laptop under the Annual plan costing $9.85 in region FR.",
    "output": {
      "customer_id": "CUST-10322",
      "service_name": "Amazon Prime Video",
      "subscription_plan": "Annual",
      "monthly_price_usd": 9.85,
      "device_type": "Laptop",
      "region": "FR",
      "usage_hours": 1.75,
      "event_timestamp": "2024-06-25T12:23:59"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10143 used Twitch on Laptop under the Premium plan costing $17.66 in region CA.",
    "output": {
      "customer_id": "CUST-10143",
      "service_name": "Twitch",
      "subscription_plan": "Premium",
      "monthly_price_usd": 17.66,
      "device_type": "Laptop",
      "region": "CA",
      "usage_hours": 7.45,
      "event_timestamp": "2024-05-11T22:14:11"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10181 used Peacock on Mobile under the Student plan costing $12.67 in region CA.",
    "output": {
      "customer_id": "CUST-10181",
      "service_name": "Peacock",
      "subscription_plan": "Student",
      "monthly_price_usd": 12.67,
      "device_type": "Mobile",
      "region": "CA",
      "usage_hours": 5.99,
      "event_timestamp": "2024-04-23T05:10:48"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10353 used YouTube Premium on Tablet under the Basic plan costing $28.99 in region JP.",
    "output": {
      "customer_id": "CUST-10353",
      "service_name": "YouTube Premium",
      "subscription_plan": "Basic",
      "monthly_price_usd": 28.99,
      "device_type": "Tablet",
      "region": "JP",
      "usage_hours": 6.8,
      "event_timestamp": "2024-06-22T20:37:09"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Amazon Prime Video subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_amazon_prime_video_etl",
      "description": "Daily ETL pipeline for Amazon Prime Video subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Crunchyroll subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process ESPN+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_espn+_stream",
      "description": "Real-time streaming pipeline for ESPN+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10035 used Paramount+ on Tablet under the Student plan costing $26.66 in region DE.",
    "output": {
      "customer_id": "CUST-10035",
      "service_name": "Paramount+",
      "subscription_plan": "Student",
      "monthly_price_usd": 26.66,
      "device_type": "Tablet",
      "region": "DE",
      "usage_hours": 2.2,
      "event_timestamp": "2024-09-05T22:34:18"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Paramount+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10172 used HBO Max on Game Console under the Annual plan costing $27.93 in region CA.",
    "output": {
      "customer_id": "CUST-10172",
      "service_name": "HBO Max",
      "subscription_plan": "Annual",
      "monthly_price_usd": 27.93,
      "device_type": "Game Console",
      "region": "CA",
      "usage_hours": 6.27,
      "event_timestamp": "2024-10-15T04:26:24"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Peacock subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10331 used Apple TV+ on Tablet under the Annual plan costing $28.42 in region DE.",
    "output": {
      "customer_id": "CUST-10331",
      "service_name": "Apple TV+",
      "subscription_plan": "Annual",
      "monthly_price_usd": 28.42,
      "device_type": "Tablet",
      "region": "DE",
      "usage_hours": 4.29,
      "event_timestamp": "2024-11-16T04:46:16"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Amazon Prime Video subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_amazon_prime_video_etl",
      "description": "Daily ETL pipeline for Amazon Prime Video subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple Music subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple TV+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_paramount+_legacy",
      "description": "Migration pipeline for legacy Paramount+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10093 used Apple TV+ on Tablet under the Student plan costing $26.57 in region UK.",
    "output": {
      "customer_id": "CUST-10093",
      "service_name": "Apple TV+",
      "subscription_plan": "Student",
      "monthly_price_usd": 26.57,
      "device_type": "Tablet",
      "region": "UK",
      "usage_hours": 6.73,
      "event_timestamp": "2024-10-08T14:55:04"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "12x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_netflix_agg",
      "description": "Weekly aggregation pipeline for Netflix metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple TV+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10265 used Paramount+ on Laptop under the Premium plan costing $10.77 in region KR.",
    "output": {
      "customer_id": "CUST-10265",
      "service_name": "Paramount+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 10.77,
      "device_type": "Laptop",
      "region": "KR",
      "usage_hours": 5.2,
      "event_timestamp": "2024-03-02T02:30:27"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10154 used Twitch on Game Console under the Basic plan costing $7.42 in region BR.",
    "output": {
      "customer_id": "CUST-10154",
      "service_name": "Twitch",
      "subscription_plan": "Basic",
      "monthly_price_usd": 7.42,
      "device_type": "Game Console",
      "region": "BR",
      "usage_hours": 1.46,
      "event_timestamp": "2024-05-07T04:56:37"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10029 used Apple TV+ on Game Console under the Premium plan costing $12.19 in region IT.",
    "output": {
      "customer_id": "CUST-10029",
      "service_name": "Apple TV+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 12.19,
      "device_type": "Game Console",
      "region": "IT",
      "usage_hours": 8.45,
      "event_timestamp": "2024-10-27T17:37:40"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process YouTube Premium subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_youtube_premium_agg",
      "description": "Weekly aggregation pipeline for YouTube Premium metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple TV+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "7x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10385 used Amazon Prime Video on Game Console under the Basic plan costing $28.41 in region JP.",
    "output": {
      "customer_id": "CUST-10385",
      "service_name": "Amazon Prime Video",
      "subscription_plan": "Basic",
      "monthly_price_usd": 28.41,
      "device_type": "Game Console",
      "region": "JP",
      "usage_hours": 10.7,
      "event_timestamp": "2024-07-21T01:44:08"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_hulu_stream",
      "description": "Real-time streaming pipeline for Hulu events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_discovery+_agg",
      "description": "Weekly aggregation pipeline for Discovery+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_discovery+_etl",
      "description": "Daily ETL pipeline for Discovery+ subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_netflix_legacy",
      "description": "Migration pipeline for legacy Netflix data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10301 used Peacock on Mobile under the Basic plan costing $18.32 in region CA.",
    "output": {
      "customer_id": "CUST-10301",
      "service_name": "Peacock",
      "subscription_plan": "Basic",
      "monthly_price_usd": 18.32,
      "device_type": "Mobile",
      "region": "CA",
      "usage_hours": 0.54,
      "event_timestamp": "2024-01-04T00:22:21"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10183 used Discovery+ on Smart TV under the Annual plan costing $21.45 in region US.",
    "output": {
      "customer_id": "CUST-10183",
      "service_name": "Discovery+",
      "subscription_plan": "Annual",
      "monthly_price_usd": 21.45,
      "device_type": "Smart TV",
      "region": "US",
      "usage_hours": 4.14,
      "event_timestamp": "2024-07-03T03:24:12"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process HBO Max subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_hbo_max_legacy",
      "description": "Migration pipeline for legacy HBO Max data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Spotify subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_spotify_agg",
      "description": "Weekly aggregation pipeline for Spotify metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple TV+ subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_apple_tv+_etl",
      "description": "Daily ETL pipeline for Apple TV+ subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process HBO Max subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_hbo_max_agg",
      "description": "Weekly aggregation pipeline for HBO Max metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Crunchyroll subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_crunchyroll_etl",
      "description": "Daily ETL pipeline for Crunchyroll subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Crunchyroll subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10111 used Peacock on Game Console under the Student plan costing $20.24 in region BR.",
    "output": {
      "customer_id": "CUST-10111",
      "service_name": "Peacock",
      "subscription_plan": "Student",
      "monthly_price_usd": 20.24,
      "device_type": "Game Console",
      "region": "BR",
      "usage_hours": 6.54,
      "event_timestamp": "2024-06-16T19:25:38"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_hulu_agg",
      "description": "Weekly aggregation pipeline for Hulu metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10375 used Hulu on Game Console under the Premium plan costing $29.47 in region DE.",
    "output": {
      "customer_id": "CUST-10375",
      "service_name": "Hulu",
      "subscription_plan": "Premium",
      "monthly_price_usd": 29.47,
      "device_type": "Game Console",
      "region": "DE",
      "usage_hours": 1.11,
      "event_timestamp": "2024-03-07T22:01:04"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_apple_music_agg",
      "description": "Weekly aggregation pipeline for Apple Music metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Amazon Prime Video subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_amazon_prime_video_etl",
      "description": "Daily ETL pipeline for Amazon Prime Video subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10026 used Peacock on Desktop under the Student plan costing $5.50 in region KR.",
    "output": {
      "customer_id": "CUST-10026",
      "service_name": "Peacock",
      "subscription_plan": "Student",
      "monthly_price_usd": 5.5,
      "device_type": "Desktop",
      "region": "KR",
      "usage_hours": 2.2,
      "event_timestamp": "2024-02-01T02:50:42"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10031 used Disney+ on Mobile under the Student plan costing $27.34 in region US.",
    "output": {
      "customer_id": "CUST-10031",
      "service_name": "Disney+",
      "subscription_plan": "Student",
      "monthly_price_usd": 27.34,
      "device_type": "Mobile",
      "region": "US",
      "usage_hours": 9.91,
      "event_timestamp": "2024-06-03T12:25:36"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking YouTube Premium subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_netflix_etl",
      "description": "Daily ETL pipeline for Netflix subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Spotify subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_spotify_agg",
      "description": "Weekly aggregation pipeline for Spotify metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10294 used Hulu on Game Console under the Family plan costing $16.00 in region ES.",
    "output": {
      "customer_id": "CUST-10294",
      "service_name": "Hulu",
      "subscription_plan": "Family",
      "monthly_price_usd": 16.0,
      "device_type": "Game Console",
      "region": "ES",
      "usage_hours": 9.59,
      "event_timestamp": "2024-08-10T00:20:36"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking ESPN+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10320 used Hulu on Game Console under the Premium plan costing $20.63 in region MX.",
    "output": {
      "customer_id": "CUST-10320",
      "service_name": "Hulu",
      "subscription_plan": "Premium",
      "monthly_price_usd": 20.63,
      "device_type": "Game Console",
      "region": "MX",
      "usage_hours": 5.97,
      "event_timestamp": "2024-12-26T02:29:49"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking HBO Max subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10323 used Spotify on Mobile under the Basic plan costing $10.17 in region UK.",
    "output": {
      "customer_id": "CUST-10323",
      "service_name": "Spotify",
      "subscription_plan": "Basic",
      "monthly_price_usd": 10.17,
      "device_type": "Mobile",
      "region": "UK",
      "usage_hours": 9.6,
      "event_timestamp": "2024-11-12T06:37:33"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10307 used Netflix on Game Console under the Basic plan costing $18.43 in region ES.",
    "output": {
      "customer_id": "CUST-10307",
      "service_name": "Netflix",
      "subscription_plan": "Basic",
      "monthly_price_usd": 18.43,
      "device_type": "Game Console",
      "region": "ES",
      "usage_hours": 3.98,
      "event_timestamp": "2024-08-27T06:59:54"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10118 used ESPN+ on Tablet under the Student plan costing $6.87 in region SG.",
    "output": {
      "customer_id": "CUST-10118",
      "service_name": "ESPN+",
      "subscription_plan": "Student",
      "monthly_price_usd": 6.87,
      "device_type": "Tablet",
      "region": "SG",
      "usage_hours": 11.15,
      "event_timestamp": "2024-04-18T01:41:04"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking YouTube Premium subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_discovery+_legacy",
      "description": "Migration pipeline for legacy Discovery+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Twitch subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_twitch_agg",
      "description": "Weekly aggregation pipeline for Twitch metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10328 used Disney+ on Desktop under the Family plan costing $10.12 in region JP.",
    "output": {
      "customer_id": "CUST-10328",
      "service_name": "Disney+",
      "subscription_plan": "Family",
      "monthly_price_usd": 10.12,
      "device_type": "Desktop",
      "region": "JP",
      "usage_hours": 2.84,
      "event_timestamp": "2024-07-07T07:58:34"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10013 used Netflix on Laptop under the Family plan costing $14.99 in region US.",
    "output": {
      "customer_id": "CUST-10013",
      "service_name": "Netflix",
      "subscription_plan": "Family",
      "monthly_price_usd": 14.99,
      "device_type": "Laptop",
      "region": "US",
      "usage_hours": 10.67,
      "event_timestamp": "2024-10-02T09:17:51"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Crunchyroll subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_crunchyroll_stream",
      "description": "Real-time streaming pipeline for Crunchyroll events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Peacock subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_peacock_stream",
      "description": "Real-time streaming pipeline for Peacock events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Crunchyroll subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process YouTube Premium subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_youtube_premium_etl",
      "description": "Daily ETL pipeline for YouTube Premium subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10367 used Apple TV+ on Mobile under the Family plan costing $24.20 in region DE.",
    "output": {
      "customer_id": "CUST-10367",
      "service_name": "Apple TV+",
      "subscription_plan": "Family",
      "monthly_price_usd": 24.2,
      "device_type": "Mobile",
      "region": "DE",
      "usage_hours": 6.86,
      "event_timestamp": "2024-06-24T10:47:18"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10282 used Crunchyroll on Smart TV under the Basic plan costing $25.74 in region IT.",
    "output": {
      "customer_id": "CUST-10282",
      "service_name": "Crunchyroll",
      "subscription_plan": "Basic",
      "monthly_price_usd": 25.74,
      "device_type": "Smart TV",
      "region": "IT",
      "usage_hours": 0.92,
      "event_timestamp": "2024-07-21T15:09:04"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_netflix_stream",
      "description": "Real-time streaming pipeline for Netflix events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10295 used Disney+ on Laptop under the Family plan costing $25.60 in region CA.",
    "output": {
      "customer_id": "CUST-10295",
      "service_name": "Disney+",
      "subscription_plan": "Family",
      "monthly_price_usd": 25.6,
      "device_type": "Laptop",
      "region": "CA",
      "usage_hours": 1.51,
      "event_timestamp": "2024-04-11T10:25:46"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_paramount+_legacy",
      "description": "Migration pipeline for legacy Paramount+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10213 used Paramount+ on Mobile under the Student plan costing $28.01 in region BR.",
    "output": {
      "customer_id": "CUST-10213",
      "service_name": "Paramount+",
      "subscription_plan": "Student",
      "monthly_price_usd": 28.01,
      "device_type": "Mobile",
      "region": "BR",
      "usage_hours": 1.81,
      "event_timestamp": "2024-07-12T16:34:10"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10173 used Peacock on Laptop under the Basic plan costing $20.41 in region US.",
    "output": {
      "customer_id": "CUST-10173",
      "service_name": "Peacock",
      "subscription_plan": "Basic",
      "monthly_price_usd": 20.41,
      "device_type": "Laptop",
      "region": "US",
      "usage_hours": 3.7,
      "event_timestamp": "2024-12-27T00:45:45"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Hulu subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Peacock subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_peacock_etl",
      "description": "Daily ETL pipeline for Peacock subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10389 used Amazon Prime Video on Game Console under the Family plan costing $13.53 in region UK.",
    "output": {
      "customer_id": "CUST-10389",
      "service_name": "Amazon Prime Video",
      "subscription_plan": "Family",
      "monthly_price_usd": 13.53,
      "device_type": "Game Console",
      "region": "UK",
      "usage_hours": 3.11,
      "event_timestamp": "2024-03-04T03:43:18"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10148 used HBO Max on Mobile under the Premium plan costing $27.62 in region IN.",
    "output": {
      "customer_id": "CUST-10148",
      "service_name": "HBO Max",
      "subscription_plan": "Premium",
      "monthly_price_usd": 27.62,
      "device_type": "Mobile",
      "region": "IN",
      "usage_hours": 0.96,
      "event_timestamp": "2024-12-19T17:47:13"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process YouTube Premium subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_youtube_premium_legacy",
      "description": "Migration pipeline for legacy YouTube Premium data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_hulu_agg",
      "description": "Weekly aggregation pipeline for Hulu metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10215 used Paramount+ on Game Console under the Student plan costing $11.78 in region SG.",
    "output": {
      "customer_id": "CUST-10215",
      "service_name": "Paramount+",
      "subscription_plan": "Student",
      "monthly_price_usd": 11.78,
      "device_type": "Game Console",
      "region": "SG",
      "usage_hours": 7.27,
      "event_timestamp": "2024-03-16T19:32:28"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_netflix_legacy",
      "description": "Migration pipeline for legacy Netflix data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_discovery+_agg",
      "description": "Weekly aggregation pipeline for Discovery+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10007 used Twitch on Game Console under the Basic plan costing $11.25 in region KR.",
    "output": {
      "customer_id": "CUST-10007",
      "service_name": "Twitch",
      "subscription_plan": "Basic",
      "monthly_price_usd": 11.25,
      "device_type": "Game Console",
      "region": "KR",
      "usage_hours": 3.01,
      "event_timestamp": "2024-11-27T16:09:26"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10317 used Hulu on Laptop under the Family plan costing $28.03 in region JP.",
    "output": {
      "customer_id": "CUST-10317",
      "service_name": "Hulu",
      "subscription_plan": "Family",
      "monthly_price_usd": 28.03,
      "device_type": "Laptop",
      "region": "JP",
      "usage_hours": 7.98,
      "event_timestamp": "2024-05-07T23:44:04"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10152 used Hulu on Desktop under the Annual plan costing $21.21 in region AU.",
    "output": {
      "customer_id": "CUST-10152",
      "service_name": "Hulu",
      "subscription_plan": "Annual",
      "monthly_price_usd": 21.21,
      "device_type": "Desktop",
      "region": "AU",
      "usage_hours": 8.31,
      "event_timestamp": "2024-01-24T03:19:49"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10137 used Netflix on Tablet under the Annual plan costing $27.27 in region IN.",
    "output": {
      "customer_id": "CUST-10137",
      "service_name": "Netflix",
      "subscription_plan": "Annual",
      "monthly_price_usd": 27.27,
      "device_type": "Tablet",
      "region": "IN",
      "usage_hours": 4.18,
      "event_timestamp": "2024-04-23T05:12:33"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10396 used Crunchyroll on Smart TV under the Basic plan costing $17.34 in region JP.",
    "output": {
      "customer_id": "CUST-10396",
      "service_name": "Crunchyroll",
      "subscription_plan": "Basic",
      "monthly_price_usd": 17.34,
      "device_type": "Smart TV",
      "region": "JP",
      "usage_hours": 6.45,
      "event_timestamp": "2024-11-10T04:33:10"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Paramount+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10394 used Spotify on Tablet under the Premium plan costing $15.19 in region US.",
    "output": {
      "customer_id": "CUST-10394",
      "service_name": "Spotify",
      "subscription_plan": "Premium",
      "monthly_price_usd": 15.19,
      "device_type": "Tablet",
      "region": "US",
      "usage_hours": 7.82,
      "event_timestamp": "2024-11-03T10:05:28"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking ESPN+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "14x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_hulu_stream",
      "description": "Real-time streaming pipeline for Hulu events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_hulu_stream",
      "description": "Real-time streaming pipeline for Hulu events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10398 used Amazon Prime Video on Laptop under the Premium plan costing $14.22 in region JP.",
    "output": {
      "customer_id": "CUST-10398",
      "service_name": "Amazon Prime Video",
      "subscription_plan": "Premium",
      "monthly_price_usd": 14.22,
      "device_type": "Laptop",
      "region": "JP",
      "usage_hours": 9.88,
      "event_timestamp": "2024-02-28T19:30:23"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Peacock subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_peacock_agg",
      "description": "Weekly aggregation pipeline for Peacock metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Amazon Prime Video subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_amazon_prime_video_stream",
      "description": "Real-time streaming pipeline for Amazon Prime Video events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10241 used Discovery+ on Mobile under the Annual plan costing $8.12 in region AU.",
    "output": {
      "customer_id": "CUST-10241",
      "service_name": "Discovery+",
      "subscription_plan": "Annual",
      "monthly_price_usd": 8.12,
      "device_type": "Mobile",
      "region": "AU",
      "usage_hours": 1.02,
      "event_timestamp": "2024-11-07T08:02:32"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Peacock subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple TV+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_apple_tv+_legacy",
      "description": "Migration pipeline for legacy Apple TV+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_hulu_etl",
      "description": "Daily ETL pipeline for Hulu subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_hulu_legacy",
      "description": "Migration pipeline for legacy Hulu data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Peacock subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_peacock_legacy",
      "description": "Migration pipeline for legacy Peacock data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10090 used Hulu on Smart TV under the Premium plan costing $12.98 in region IT.",
    "output": {
      "customer_id": "CUST-10090",
      "service_name": "Hulu",
      "subscription_plan": "Premium",
      "monthly_price_usd": 12.98,
      "device_type": "Smart TV",
      "region": "IT",
      "usage_hours": 1.12,
      "event_timestamp": "2024-03-14T00:50:43"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10261 used YouTube Premium on Game Console under the Student plan costing $18.88 in region IT.",
    "output": {
      "customer_id": "CUST-10261",
      "service_name": "YouTube Premium",
      "subscription_plan": "Student",
      "monthly_price_usd": 18.88,
      "device_type": "Game Console",
      "region": "IT",
      "usage_hours": 3.58,
      "event_timestamp": "2024-04-17T13:39:33"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_netflix_stream",
      "description": "Real-time streaming pipeline for Netflix events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10381 used Apple Music on Laptop under the Premium plan costing $10.26 in region BR.",
    "output": {
      "customer_id": "CUST-10381",
      "service_name": "Apple Music",
      "subscription_plan": "Premium",
      "monthly_price_usd": 10.26,
      "device_type": "Laptop",
      "region": "BR",
      "usage_hours": 3.04,
      "event_timestamp": "2024-08-23T05:22:09"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_apple_music_agg",
      "description": "Weekly aggregation pipeline for Apple Music metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10131 used Apple TV+ on Game Console under the Basic plan costing $7.84 in region ES.",
    "output": {
      "customer_id": "CUST-10131",
      "service_name": "Apple TV+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 7.84,
      "device_type": "Game Console",
      "region": "ES",
      "usage_hours": 2.28,
      "event_timestamp": "2024-07-09T22:26:11"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process YouTube Premium subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_youtube_premium_stream",
      "description": "Real-time streaming pipeline for YouTube Premium events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Amazon Prime Video subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_amazon_prime_video_etl",
      "description": "Daily ETL pipeline for Amazon Prime Video subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10188 used Hulu on Mobile under the Basic plan costing $6.48 in region DE.",
    "output": {
      "customer_id": "CUST-10188",
      "service_name": "Hulu",
      "subscription_plan": "Basic",
      "monthly_price_usd": 6.48,
      "device_type": "Mobile",
      "region": "DE",
      "usage_hours": 9.71,
      "event_timestamp": "2024-08-16T18:35:59"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_discovery+_stream",
      "description": "Real-time streaming pipeline for Discovery+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10369 used Twitch on Mobile under the Premium plan costing $20.56 in region ES.",
    "output": {
      "customer_id": "CUST-10369",
      "service_name": "Twitch",
      "subscription_plan": "Premium",
      "monthly_price_usd": 20.56,
      "device_type": "Mobile",
      "region": "ES",
      "usage_hours": 5.02,
      "event_timestamp": "2024-09-23T18:41:13"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10066 used Apple TV+ on Smart TV under the Annual plan costing $19.06 in region AU.",
    "output": {
      "customer_id": "CUST-10066",
      "service_name": "Apple TV+",
      "subscription_plan": "Annual",
      "monthly_price_usd": 19.06,
      "device_type": "Smart TV",
      "region": "AU",
      "usage_hours": 8.72,
      "event_timestamp": "2024-07-11T01:29:37"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_paramount+_agg",
      "description": "Weekly aggregation pipeline for Paramount+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Crunchyroll subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_crunchyroll_etl",
      "description": "Daily ETL pipeline for Crunchyroll subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Disney+ subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_disney+_etl",
      "description": "Daily ETL pipeline for Disney+ subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Hulu subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10046 used Apple Music on Smart TV under the Basic plan costing $14.92 in region ES.",
    "output": {
      "customer_id": "CUST-10046",
      "service_name": "Apple Music",
      "subscription_plan": "Basic",
      "monthly_price_usd": 14.92,
      "device_type": "Smart TV",
      "region": "ES",
      "usage_hours": 4.49,
      "event_timestamp": "2024-10-16T21:39:46"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple Music subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Peacock subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "7x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process ESPN+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_espn+_agg",
      "description": "Weekly aggregation pipeline for ESPN+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10032 used Hulu on Desktop under the Premium plan costing $9.24 in region UK.",
    "output": {
      "customer_id": "CUST-10032",
      "service_name": "Hulu",
      "subscription_plan": "Premium",
      "monthly_price_usd": 9.24,
      "device_type": "Desktop",
      "region": "UK",
      "usage_hours": 1.67,
      "event_timestamp": "2024-11-05T02:37:48"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Crunchyroll subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "12x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Paramount+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Peacock subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10174 used Netflix on Game Console under the Family plan costing $12.10 in region US.",
    "output": {
      "customer_id": "CUST-10174",
      "service_name": "Netflix",
      "subscription_plan": "Family",
      "monthly_price_usd": 12.1,
      "device_type": "Game Console",
      "region": "US",
      "usage_hours": 7.57,
      "event_timestamp": "2024-07-05T09:07:03"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple TV+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_apple_tv+_stream",
      "description": "Real-time streaming pipeline for Apple TV+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Crunchyroll subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Crunchyroll subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_crunchyroll_etl",
      "description": "Daily ETL pipeline for Crunchyroll subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_netflix_agg",
      "description": "Weekly aggregation pipeline for Netflix metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10372 used Peacock on Mobile under the Annual plan costing $7.06 in region FR.",
    "output": {
      "customer_id": "CUST-10372",
      "service_name": "Peacock",
      "subscription_plan": "Annual",
      "monthly_price_usd": 7.06,
      "device_type": "Mobile",
      "region": "FR",
      "usage_hours": 6.31,
      "event_timestamp": "2024-05-22T21:14:51"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_hulu_agg",
      "description": "Weekly aggregation pipeline for Hulu metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10318 used Apple TV+ on Mobile under the Basic plan costing $27.17 in region CN.",
    "output": {
      "customer_id": "CUST-10318",
      "service_name": "Apple TV+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 27.17,
      "device_type": "Mobile",
      "region": "CN",
      "usage_hours": 0.7,
      "event_timestamp": "2024-11-18T20:50:02"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_discovery+_agg",
      "description": "Weekly aggregation pipeline for Discovery+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10074 used Discovery+ on Smart TV under the Premium plan costing $26.22 in region DE.",
    "output": {
      "customer_id": "CUST-10074",
      "service_name": "Discovery+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 26.22,
      "device_type": "Smart TV",
      "region": "DE",
      "usage_hours": 11.76,
      "event_timestamp": "2024-02-16T06:07:03"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking YouTube Premium subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Crunchyroll subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_crunchyroll_agg",
      "description": "Weekly aggregation pipeline for Crunchyroll metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process ESPN+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_espn+_stream",
      "description": "Real-time streaming pipeline for ESPN+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple TV+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Crunchyroll subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Paramount+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Peacock subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10077 used Paramount+ on Laptop under the Premium plan costing $6.18 in region MX.",
    "output": {
      "customer_id": "CUST-10077",
      "service_name": "Paramount+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 6.18,
      "device_type": "Laptop",
      "region": "MX",
      "usage_hours": 0.53,
      "event_timestamp": "2024-06-28T19:40:15"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10204 used Amazon Prime Video on Game Console under the Student plan costing $8.19 in region FR.",
    "output": {
      "customer_id": "CUST-10204",
      "service_name": "Amazon Prime Video",
      "subscription_plan": "Student",
      "monthly_price_usd": 8.19,
      "device_type": "Game Console",
      "region": "FR",
      "usage_hours": 6.59,
      "event_timestamp": "2024-09-04T22:03:55"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process ESPN+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_espn+_stream",
      "description": "Real-time streaming pipeline for ESPN+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10259 used HBO Max on Game Console under the Premium plan costing $27.74 in region DE.",
    "output": {
      "customer_id": "CUST-10259",
      "service_name": "HBO Max",
      "subscription_plan": "Premium",
      "monthly_price_usd": 27.74,
      "device_type": "Game Console",
      "region": "DE",
      "usage_hours": 9.91,
      "event_timestamp": "2024-09-21T03:00:40"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10043 used Crunchyroll on Mobile under the Student plan costing $16.04 in region UK.",
    "output": {
      "customer_id": "CUST-10043",
      "service_name": "Crunchyroll",
      "subscription_plan": "Student",
      "monthly_price_usd": 16.04,
      "device_type": "Mobile",
      "region": "UK",
      "usage_hours": 9.03,
      "event_timestamp": "2024-03-16T21:53:01"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Peacock subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10006 used YouTube Premium on Mobile under the Basic plan costing $25.97 in region BR.",
    "output": {
      "customer_id": "CUST-10006",
      "service_name": "YouTube Premium",
      "subscription_plan": "Basic",
      "monthly_price_usd": 25.97,
      "device_type": "Mobile",
      "region": "BR",
      "usage_hours": 5.33,
      "event_timestamp": "2024-03-02T01:44:49"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "7x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Amazon Prime Video subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_amazon_prime_video_legacy",
      "description": "Migration pipeline for legacy Amazon Prime Video data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Disney+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_disney+_legacy",
      "description": "Migration pipeline for legacy Disney+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10370 used Spotify on Desktop under the Basic plan costing $19.78 in region KR.",
    "output": {
      "customer_id": "CUST-10370",
      "service_name": "Spotify",
      "subscription_plan": "Basic",
      "monthly_price_usd": 19.78,
      "device_type": "Desktop",
      "region": "KR",
      "usage_hours": 0.82,
      "event_timestamp": "2024-02-14T03:11:31"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10384 used Peacock on Game Console under the Basic plan costing $7.55 in region CN.",
    "output": {
      "customer_id": "CUST-10384",
      "service_name": "Peacock",
      "subscription_plan": "Basic",
      "monthly_price_usd": 7.55,
      "device_type": "Game Console",
      "region": "CN",
      "usage_hours": 2.18,
      "event_timestamp": "2024-01-28T13:23:20"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "12x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Spotify subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_spotify_stream",
      "description": "Real-time streaming pipeline for Spotify events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_apple_music_etl",
      "description": "Daily ETL pipeline for Apple Music subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Peacock subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10278 used ESPN+ on Tablet under the Basic plan costing $25.68 in region JP.",
    "output": {
      "customer_id": "CUST-10278",
      "service_name": "ESPN+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 25.68,
      "device_type": "Tablet",
      "region": "JP",
      "usage_hours": 2.62,
      "event_timestamp": "2024-08-22T20:03:39"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10238 used Paramount+ on Game Console under the Premium plan costing $23.29 in region AU.",
    "output": {
      "customer_id": "CUST-10238",
      "service_name": "Paramount+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 23.29,
      "device_type": "Game Console",
      "region": "AU",
      "usage_hours": 4.61,
      "event_timestamp": "2024-02-01T00:51:50"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_hulu_stream",
      "description": "Real-time streaming pipeline for Hulu events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10072 used Apple TV+ on Tablet under the Family plan costing $17.89 in region MX.",
    "output": {
      "customer_id": "CUST-10072",
      "service_name": "Apple TV+",
      "subscription_plan": "Family",
      "monthly_price_usd": 17.89,
      "device_type": "Tablet",
      "region": "MX",
      "usage_hours": 5.69,
      "event_timestamp": "2024-03-23T02:36:09"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process HBO Max subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_hbo_max_etl",
      "description": "Daily ETL pipeline for HBO Max subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_paramount+_legacy",
      "description": "Migration pipeline for legacy Paramount+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Crunchyroll subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Crunchyroll subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_hulu_agg",
      "description": "Weekly aggregation pipeline for Hulu metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Disney+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_disney+_stream",
      "description": "Real-time streaming pipeline for Disney+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Disney+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_disney+_stream",
      "description": "Real-time streaming pipeline for Disney+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Disney+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_disney+_legacy",
      "description": "Migration pipeline for legacy Disney+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10070 used Spotify on Desktop under the Premium plan costing $21.40 in region BR.",
    "output": {
      "customer_id": "CUST-10070",
      "service_name": "Spotify",
      "subscription_plan": "Premium",
      "monthly_price_usd": 21.4,
      "device_type": "Desktop",
      "region": "BR",
      "usage_hours": 1.7,
      "event_timestamp": "2024-07-04T20:18:20"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking ESPN+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_netflix_stream",
      "description": "Real-time streaming pipeline for Netflix events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Spotify subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_spotify_legacy",
      "description": "Migration pipeline for legacy Spotify data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Peacock subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Amazon Prime Video subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_amazon_prime_video_agg",
      "description": "Weekly aggregation pipeline for Amazon Prime Video metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10297 used Hulu on Game Console under the Student plan costing $15.68 in region CN.",
    "output": {
      "customer_id": "CUST-10297",
      "service_name": "Hulu",
      "subscription_plan": "Student",
      "monthly_price_usd": 15.68,
      "device_type": "Game Console",
      "region": "CN",
      "usage_hours": 9.04,
      "event_timestamp": "2024-07-09T22:14:48"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Disney+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Peacock subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10257 used HBO Max on Desktop under the Family plan costing $16.50 in region KR.",
    "output": {
      "customer_id": "CUST-10257",
      "service_name": "HBO Max",
      "subscription_plan": "Family",
      "monthly_price_usd": 16.5,
      "device_type": "Desktop",
      "region": "KR",
      "usage_hours": 1.84,
      "event_timestamp": "2024-09-17T16:15:34"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_discovery+_stream",
      "description": "Real-time streaming pipeline for Discovery+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Disney+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10288 used Netflix on Smart TV under the Basic plan costing $7.66 in region FR.",
    "output": {
      "customer_id": "CUST-10288",
      "service_name": "Netflix",
      "subscription_plan": "Basic",
      "monthly_price_usd": 7.66,
      "device_type": "Smart TV",
      "region": "FR",
      "usage_hours": 6.3,
      "event_timestamp": "2024-09-11T12:50:54"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10180 used Apple TV+ on Game Console under the Premium plan costing $9.68 in region KR.",
    "output": {
      "customer_id": "CUST-10180",
      "service_name": "Apple TV+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 9.68,
      "device_type": "Game Console",
      "region": "KR",
      "usage_hours": 5.61,
      "event_timestamp": "2024-07-09T17:11:04"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Twitch subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_twitch_agg",
      "description": "Weekly aggregation pipeline for Twitch metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Hulu subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10109 used Peacock on Tablet under the Annual plan costing $8.14 in region IN.",
    "output": {
      "customer_id": "CUST-10109",
      "service_name": "Peacock",
      "subscription_plan": "Annual",
      "monthly_price_usd": 8.14,
      "device_type": "Tablet",
      "region": "IN",
      "usage_hours": 0.56,
      "event_timestamp": "2024-10-08T08:28:11"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process YouTube Premium subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_youtube_premium_legacy",
      "description": "Migration pipeline for legacy YouTube Premium data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Disney+ subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_disney+_etl",
      "description": "Daily ETL pipeline for Disney+ subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_hulu_legacy",
      "description": "Migration pipeline for legacy Hulu data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Disney+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10034 used Hulu on Game Console under the Basic plan costing $5.31 in region SG.",
    "output": {
      "customer_id": "CUST-10034",
      "service_name": "Hulu",
      "subscription_plan": "Basic",
      "monthly_price_usd": 5.31,
      "device_type": "Game Console",
      "region": "SG",
      "usage_hours": 0.56,
      "event_timestamp": "2024-06-06T13:50:06"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking HBO Max subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process HBO Max subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_hbo_max_stream",
      "description": "Real-time streaming pipeline for HBO Max events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10151 used Spotify on Mobile under the Family plan costing $19.09 in region FR.",
    "output": {
      "customer_id": "CUST-10151",
      "service_name": "Spotify",
      "subscription_plan": "Family",
      "monthly_price_usd": 19.09,
      "device_type": "Mobile",
      "region": "FR",
      "usage_hours": 5.05,
      "event_timestamp": "2024-11-25T13:41:14"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple TV+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_apple_tv+_legacy",
      "description": "Migration pipeline for legacy Apple TV+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple TV+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10169 used Disney+ on Tablet under the Family plan costing $21.11 in region CN.",
    "output": {
      "customer_id": "CUST-10169",
      "service_name": "Disney+",
      "subscription_plan": "Family",
      "monthly_price_usd": 21.11,
      "device_type": "Tablet",
      "region": "CN",
      "usage_hours": 3.68,
      "event_timestamp": "2024-01-11T19:18:45"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_discovery+_etl",
      "description": "Daily ETL pipeline for Discovery+ subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Amazon Prime Video subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_amazon_prime_video_agg",
      "description": "Weekly aggregation pipeline for Amazon Prime Video metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10233 used Twitch on Smart TV under the Basic plan costing $28.34 in region DE.",
    "output": {
      "customer_id": "CUST-10233",
      "service_name": "Twitch",
      "subscription_plan": "Basic",
      "monthly_price_usd": 28.34,
      "device_type": "Smart TV",
      "region": "DE",
      "usage_hours": 8.71,
      "event_timestamp": "2024-04-26T05:28:50"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_paramount+_stream",
      "description": "Real-time streaming pipeline for Paramount+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_apple_music_etl",
      "description": "Daily ETL pipeline for Apple Music subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process YouTube Premium subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_youtube_premium_etl",
      "description": "Daily ETL pipeline for YouTube Premium subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Paramount+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking HBO Max subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple Music subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_apple_music_etl",
      "description": "Daily ETL pipeline for Apple Music subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10395 used YouTube Premium on Tablet under the Basic plan costing $19.37 in region ES.",
    "output": {
      "customer_id": "CUST-10395",
      "service_name": "YouTube Premium",
      "subscription_plan": "Basic",
      "monthly_price_usd": 19.37,
      "device_type": "Tablet",
      "region": "ES",
      "usage_hours": 11.27,
      "event_timestamp": "2024-10-25T20:38:42"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking YouTube Premium subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "14x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10103 used Paramount+ on Desktop under the Student plan costing $17.47 in region JP.",
    "output": {
      "customer_id": "CUST-10103",
      "service_name": "Paramount+",
      "subscription_plan": "Student",
      "monthly_price_usd": 17.47,
      "device_type": "Desktop",
      "region": "JP",
      "usage_hours": 3.57,
      "event_timestamp": "2024-05-16T09:03:00"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10366 used Apple Music on Tablet under the Basic plan costing $28.96 in region CN.",
    "output": {
      "customer_id": "CUST-10366",
      "service_name": "Apple Music",
      "subscription_plan": "Basic",
      "monthly_price_usd": 28.96,
      "device_type": "Tablet",
      "region": "CN",
      "usage_hours": 4.62,
      "event_timestamp": "2024-04-05T07:08:42"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_netflix_agg",
      "description": "Weekly aggregation pipeline for Netflix metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10264 used Crunchyroll on Tablet under the Premium plan costing $11.90 in region MX.",
    "output": {
      "customer_id": "CUST-10264",
      "service_name": "Crunchyroll",
      "subscription_plan": "Premium",
      "monthly_price_usd": 11.9,
      "device_type": "Tablet",
      "region": "MX",
      "usage_hours": 2.86,
      "event_timestamp": "2024-07-07T17:28:14"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Paramount+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10220 used ESPN+ on Tablet under the Student plan costing $24.76 in region CN.",
    "output": {
      "customer_id": "CUST-10220",
      "service_name": "ESPN+",
      "subscription_plan": "Student",
      "monthly_price_usd": 24.76,
      "device_type": "Tablet",
      "region": "CN",
      "usage_hours": 7.75,
      "event_timestamp": "2024-12-12T12:05:46"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Hulu subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "7x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_apple_music_legacy",
      "description": "Migration pipeline for legacy Apple Music data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10258 used Apple Music on Desktop under the Annual plan costing $29.83 in region KR.",
    "output": {
      "customer_id": "CUST-10258",
      "service_name": "Apple Music",
      "subscription_plan": "Annual",
      "monthly_price_usd": 29.83,
      "device_type": "Desktop",
      "region": "KR",
      "usage_hours": 2.25,
      "event_timestamp": "2024-09-06T22:34:12"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple TV+ subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_apple_tv+_etl",
      "description": "Daily ETL pipeline for Apple TV+ subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10304 used Netflix on Smart TV under the Student plan costing $23.07 in region FR.",
    "output": {
      "customer_id": "CUST-10304",
      "service_name": "Netflix",
      "subscription_plan": "Student",
      "monthly_price_usd": 23.07,
      "device_type": "Smart TV",
      "region": "FR",
      "usage_hours": 3.57,
      "event_timestamp": "2024-06-06T13:06:50"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10260 used HBO Max on Desktop under the Premium plan costing $8.48 in region BR.",
    "output": {
      "customer_id": "CUST-10260",
      "service_name": "HBO Max",
      "subscription_plan": "Premium",
      "monthly_price_usd": 8.48,
      "device_type": "Desktop",
      "region": "BR",
      "usage_hours": 2.51,
      "event_timestamp": "2024-06-11T16:56:59"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process HBO Max subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_hbo_max_legacy",
      "description": "Migration pipeline for legacy HBO Max data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_discovery+_agg",
      "description": "Weekly aggregation pipeline for Discovery+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10002 used ESPN+ on Smart TV under the Premium plan costing $10.81 in region IT.",
    "output": {
      "customer_id": "CUST-10002",
      "service_name": "ESPN+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 10.81,
      "device_type": "Smart TV",
      "region": "IT",
      "usage_hours": 6.08,
      "event_timestamp": "2024-07-22T03:17:43"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple TV+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_hulu_etl",
      "description": "Daily ETL pipeline for Hulu subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10059 used Apple TV+ on Smart TV under the Student plan costing $8.54 in region US.",
    "output": {
      "customer_id": "CUST-10059",
      "service_name": "Apple TV+",
      "subscription_plan": "Student",
      "monthly_price_usd": 8.54,
      "device_type": "Smart TV",
      "region": "US",
      "usage_hours": 7.52,
      "event_timestamp": "2024-02-19T03:26:28"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_netflix_agg",
      "description": "Weekly aggregation pipeline for Netflix metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10330 used Disney+ on Game Console under the Basic plan costing $7.06 in region CN.",
    "output": {
      "customer_id": "CUST-10330",
      "service_name": "Disney+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 7.06,
      "device_type": "Game Console",
      "region": "CN",
      "usage_hours": 1.39,
      "event_timestamp": "2024-09-17T11:44:48"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10089 used ESPN+ on Tablet under the Annual plan costing $15.01 in region BR.",
    "output": {
      "customer_id": "CUST-10089",
      "service_name": "ESPN+",
      "subscription_plan": "Annual",
      "monthly_price_usd": 15.01,
      "device_type": "Tablet",
      "region": "BR",
      "usage_hours": 11.5,
      "event_timestamp": "2024-01-13T19:25:07"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Spotify subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_spotify_etl",
      "description": "Daily ETL pipeline for Spotify subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10053 used Netflix on Laptop under the Family plan costing $18.17 in region IT.",
    "output": {
      "customer_id": "CUST-10053",
      "service_name": "Netflix",
      "subscription_plan": "Family",
      "monthly_price_usd": 18.17,
      "device_type": "Laptop",
      "region": "IT",
      "usage_hours": 9.1,
      "event_timestamp": "2024-06-04T03:05:40"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10280 used Apple TV+ on Desktop under the Student plan costing $26.88 in region DE.",
    "output": {
      "customer_id": "CUST-10280",
      "service_name": "Apple TV+",
      "subscription_plan": "Student",
      "monthly_price_usd": 26.88,
      "device_type": "Desktop",
      "region": "DE",
      "usage_hours": 5.45,
      "event_timestamp": "2024-10-19T10:52:37"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10042 used Disney+ on Mobile under the Annual plan costing $26.09 in region US.",
    "output": {
      "customer_id": "CUST-10042",
      "service_name": "Disney+",
      "subscription_plan": "Annual",
      "monthly_price_usd": 26.09,
      "device_type": "Mobile",
      "region": "US",
      "usage_hours": 5.47,
      "event_timestamp": "2024-11-25T17:41:48"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10244 used YouTube Premium on Game Console under the Basic plan costing $27.66 in region KR.",
    "output": {
      "customer_id": "CUST-10244",
      "service_name": "YouTube Premium",
      "subscription_plan": "Basic",
      "monthly_price_usd": 27.66,
      "device_type": "Game Console",
      "region": "KR",
      "usage_hours": 11.75,
      "event_timestamp": "2024-01-21T09:56:00"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process YouTube Premium subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_youtube_premium_agg",
      "description": "Weekly aggregation pipeline for YouTube Premium metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10108 used Paramount+ on Tablet under the Family plan costing $28.96 in region CN.",
    "output": {
      "customer_id": "CUST-10108",
      "service_name": "Paramount+",
      "subscription_plan": "Family",
      "monthly_price_usd": 28.96,
      "device_type": "Tablet",
      "region": "CN",
      "usage_hours": 6.91,
      "event_timestamp": "2024-04-27T05:28:21"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_paramount+_stream",
      "description": "Real-time streaming pipeline for Paramount+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_discovery+_legacy",
      "description": "Migration pipeline for legacy Discovery+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple TV+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_apple_tv+_agg",
      "description": "Weekly aggregation pipeline for Apple TV+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Amazon Prime Video subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_amazon_prime_video_stream",
      "description": "Real-time streaming pipeline for Amazon Prime Video events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10329 used Spotify on Game Console under the Annual plan costing $24.86 in region DE.",
    "output": {
      "customer_id": "CUST-10329",
      "service_name": "Spotify",
      "subscription_plan": "Annual",
      "monthly_price_usd": 24.86,
      "device_type": "Game Console",
      "region": "DE",
      "usage_hours": 5.59,
      "event_timestamp": "2024-09-05T18:22:37"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_netflix_stream",
      "description": "Real-time streaming pipeline for Netflix events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process ESPN+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_espn+_stream",
      "description": "Real-time streaming pipeline for ESPN+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking HBO Max subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "7x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_discovery+_agg",
      "description": "Weekly aggregation pipeline for Discovery+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking ESPN+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10217 used YouTube Premium on Smart TV under the Family plan costing $25.37 in region KR.",
    "output": {
      "customer_id": "CUST-10217",
      "service_name": "YouTube Premium",
      "subscription_plan": "Family",
      "monthly_price_usd": 25.37,
      "device_type": "Smart TV",
      "region": "KR",
      "usage_hours": 4.59,
      "event_timestamp": "2024-10-03T06:28:21"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10296 used Paramount+ on Smart TV under the Annual plan costing $18.51 in region UK.",
    "output": {
      "customer_id": "CUST-10296",
      "service_name": "Paramount+",
      "subscription_plan": "Annual",
      "monthly_price_usd": 18.51,
      "device_type": "Smart TV",
      "region": "UK",
      "usage_hours": 9.66,
      "event_timestamp": "2024-11-06T08:24:11"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Twitch subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_twitch_stream",
      "description": "Real-time streaming pipeline for Twitch events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10270 used YouTube Premium on Desktop under the Premium plan costing $16.51 in region US.",
    "output": {
      "customer_id": "CUST-10270",
      "service_name": "YouTube Premium",
      "subscription_plan": "Premium",
      "monthly_price_usd": 16.51,
      "device_type": "Desktop",
      "region": "US",
      "usage_hours": 1.56,
      "event_timestamp": "2024-12-08T06:46:07"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10250 used Discovery+ on Mobile under the Annual plan costing $12.99 in region DE.",
    "output": {
      "customer_id": "CUST-10250",
      "service_name": "Discovery+",
      "subscription_plan": "Annual",
      "monthly_price_usd": 12.99,
      "device_type": "Mobile",
      "region": "DE",
      "usage_hours": 10.45,
      "event_timestamp": "2024-02-18T22:55:16"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple TV+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking YouTube Premium subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10068 used Twitch on Mobile under the Basic plan costing $25.41 in region JP.",
    "output": {
      "customer_id": "CUST-10068",
      "service_name": "Twitch",
      "subscription_plan": "Basic",
      "monthly_price_usd": 25.41,
      "device_type": "Mobile",
      "region": "JP",
      "usage_hours": 10.41,
      "event_timestamp": "2024-03-01T03:05:05"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple TV+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_apple_tv+_agg",
      "description": "Weekly aggregation pipeline for Apple TV+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10246 used Peacock on Mobile under the Annual plan costing $27.63 in region FR.",
    "output": {
      "customer_id": "CUST-10246",
      "service_name": "Peacock",
      "subscription_plan": "Annual",
      "monthly_price_usd": 27.63,
      "device_type": "Mobile",
      "region": "FR",
      "usage_hours": 9.01,
      "event_timestamp": "2024-01-02T02:02:11"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10355 used Netflix on Mobile under the Basic plan costing $19.25 in region BR.",
    "output": {
      "customer_id": "CUST-10355",
      "service_name": "Netflix",
      "subscription_plan": "Basic",
      "monthly_price_usd": 19.25,
      "device_type": "Mobile",
      "region": "BR",
      "usage_hours": 8.32,
      "event_timestamp": "2024-01-23T06:23:25"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple TV+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10364 used Apple Music on Mobile under the Annual plan costing $13.61 in region AU.",
    "output": {
      "customer_id": "CUST-10364",
      "service_name": "Apple Music",
      "subscription_plan": "Annual",
      "monthly_price_usd": 13.61,
      "device_type": "Mobile",
      "region": "AU",
      "usage_hours": 11.13,
      "event_timestamp": "2024-08-20T17:18:00"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process ESPN+ subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_espn+_etl",
      "description": "Daily ETL pipeline for ESPN+ subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10018 used Paramount+ on Desktop under the Basic plan costing $8.09 in region DE.",
    "output": {
      "customer_id": "CUST-10018",
      "service_name": "Paramount+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 8.09,
      "device_type": "Desktop",
      "region": "DE",
      "usage_hours": 8.87,
      "event_timestamp": "2024-12-15T07:05:37"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10209 used ESPN+ on Desktop under the Premium plan costing $10.09 in region UK.",
    "output": {
      "customer_id": "CUST-10209",
      "service_name": "ESPN+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 10.09,
      "device_type": "Desktop",
      "region": "UK",
      "usage_hours": 10.57,
      "event_timestamp": "2024-10-23T12:03:34"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_apple_music_agg",
      "description": "Weekly aggregation pipeline for Apple Music metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10025 used Crunchyroll on Game Console under the Basic plan costing $11.95 in region DE.",
    "output": {
      "customer_id": "CUST-10025",
      "service_name": "Crunchyroll",
      "subscription_plan": "Basic",
      "monthly_price_usd": 11.95,
      "device_type": "Game Console",
      "region": "DE",
      "usage_hours": 6.01,
      "event_timestamp": "2024-02-07T00:49:48"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10308 used Apple TV+ on Laptop under the Basic plan costing $7.87 in region SG.",
    "output": {
      "customer_id": "CUST-10308",
      "service_name": "Apple TV+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 7.87,
      "device_type": "Laptop",
      "region": "SG",
      "usage_hours": 11.62,
      "event_timestamp": "2024-05-24T12:05:44"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10101 used Apple Music on Desktop under the Annual plan costing $16.79 in region JP.",
    "output": {
      "customer_id": "CUST-10101",
      "service_name": "Apple Music",
      "subscription_plan": "Annual",
      "monthly_price_usd": 16.79,
      "device_type": "Desktop",
      "region": "JP",
      "usage_hours": 10.07,
      "event_timestamp": "2024-03-11T04:48:47"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Amazon Prime Video subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_amazon_prime_video_agg",
      "description": "Weekly aggregation pipeline for Amazon Prime Video metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_hulu_legacy",
      "description": "Migration pipeline for legacy Hulu data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple TV+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10377 used Twitch on Desktop under the Annual plan costing $27.53 in region CA.",
    "output": {
      "customer_id": "CUST-10377",
      "service_name": "Twitch",
      "subscription_plan": "Annual",
      "monthly_price_usd": 27.53,
      "device_type": "Desktop",
      "region": "CA",
      "usage_hours": 4.29,
      "event_timestamp": "2024-07-05T13:25:29"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Peacock subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10227 used Peacock on Desktop under the Student plan costing $25.88 in region BR.",
    "output": {
      "customer_id": "CUST-10227",
      "service_name": "Peacock",
      "subscription_plan": "Student",
      "monthly_price_usd": 25.88,
      "device_type": "Desktop",
      "region": "BR",
      "usage_hours": 10.18,
      "event_timestamp": "2024-06-16T12:24:58"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Peacock subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10262 used HBO Max on Mobile under the Basic plan costing $27.87 in region AU.",
    "output": {
      "customer_id": "CUST-10262",
      "service_name": "HBO Max",
      "subscription_plan": "Basic",
      "monthly_price_usd": 27.87,
      "device_type": "Mobile",
      "region": "AU",
      "usage_hours": 2.34,
      "event_timestamp": "2024-10-10T07:57:04"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple TV+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10091 used Twitch on Game Console under the Student plan costing $29.45 in region IT.",
    "output": {
      "customer_id": "CUST-10091",
      "service_name": "Twitch",
      "subscription_plan": "Student",
      "monthly_price_usd": 29.45,
      "device_type": "Game Console",
      "region": "IT",
      "usage_hours": 9.52,
      "event_timestamp": "2024-12-21T01:49:18"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Amazon Prime Video subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_amazon_prime_video_agg",
      "description": "Weekly aggregation pipeline for Amazon Prime Video metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10078 used Twitch on Smart TV under the Basic plan costing $18.77 in region CA.",
    "output": {
      "customer_id": "CUST-10078",
      "service_name": "Twitch",
      "subscription_plan": "Basic",
      "monthly_price_usd": 18.77,
      "device_type": "Smart TV",
      "region": "CA",
      "usage_hours": 11.15,
      "event_timestamp": "2024-01-28T15:29:39"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process HBO Max subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_hbo_max_etl",
      "description": "Daily ETL pipeline for HBO Max subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10316 used Hulu on Game Console under the Student plan costing $27.97 in region JP.",
    "output": {
      "customer_id": "CUST-10316",
      "service_name": "Hulu",
      "subscription_plan": "Student",
      "monthly_price_usd": 27.97,
      "device_type": "Game Console",
      "region": "JP",
      "usage_hours": 9.23,
      "event_timestamp": "2024-03-16T01:15:47"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking ESPN+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Paramount+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Hulu subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10391 used Hulu on Game Console under the Basic plan costing $11.60 in region UK.",
    "output": {
      "customer_id": "CUST-10391",
      "service_name": "Hulu",
      "subscription_plan": "Basic",
      "monthly_price_usd": 11.6,
      "device_type": "Game Console",
      "region": "UK",
      "usage_hours": 11.0,
      "event_timestamp": "2024-03-13T13:00:26"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple Music subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "7x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_hulu_stream",
      "description": "Real-time streaming pipeline for Hulu events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_netflix_legacy",
      "description": "Migration pipeline for legacy Netflix data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10110 used ESPN+ on Mobile under the Premium plan costing $27.53 in region CA.",
    "output": {
      "customer_id": "CUST-10110",
      "service_name": "ESPN+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 27.53,
      "device_type": "Mobile",
      "region": "CA",
      "usage_hours": 6.27,
      "event_timestamp": "2024-11-20T12:54:14"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple Music subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking HBO Max subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "12x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Hulu subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Disney+ subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_disney+_agg",
      "description": "Weekly aggregation pipeline for Disney+ metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Hulu subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10112 used HBO Max on Smart TV under the Student plan costing $19.53 in region CN.",
    "output": {
      "customer_id": "CUST-10112",
      "service_name": "HBO Max",
      "subscription_plan": "Student",
      "monthly_price_usd": 19.53,
      "device_type": "Smart TV",
      "region": "CN",
      "usage_hours": 3.49,
      "event_timestamp": "2024-07-02T12:48:29"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10373 used ESPN+ on Desktop under the Annual plan costing $25.30 in region MX.",
    "output": {
      "customer_id": "CUST-10373",
      "service_name": "ESPN+",
      "subscription_plan": "Annual",
      "monthly_price_usd": 25.3,
      "device_type": "Desktop",
      "region": "MX",
      "usage_hours": 2.54,
      "event_timestamp": "2024-06-13T20:34:10"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10371 used Discovery+ on Mobile under the Premium plan costing $9.66 in region SG.",
    "output": {
      "customer_id": "CUST-10371",
      "service_name": "Discovery+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 9.66,
      "device_type": "Mobile",
      "region": "SG",
      "usage_hours": 0.8,
      "event_timestamp": "2024-01-26T15:47:25"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10085 used Apple Music on Desktop under the Annual plan costing $6.37 in region MX.",
    "output": {
      "customer_id": "CUST-10085",
      "service_name": "Apple Music",
      "subscription_plan": "Annual",
      "monthly_price_usd": 6.37,
      "device_type": "Desktop",
      "region": "MX",
      "usage_hours": 7.02,
      "event_timestamp": "2024-07-02T22:04:04"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "15x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_apple_music_stream",
      "description": "Real-time streaming pipeline for Apple Music events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Spotify subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_spotify_legacy",
      "description": "Migration pipeline for legacy Spotify data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking YouTube Premium subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10290 used Apple TV+ on Smart TV under the Basic plan costing $5.42 in region AU.",
    "output": {
      "customer_id": "CUST-10290",
      "service_name": "Apple TV+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 5.42,
      "device_type": "Smart TV",
      "region": "AU",
      "usage_hours": 9.16,
      "event_timestamp": "2024-10-12T13:48:24"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_netflix_legacy",
      "description": "Migration pipeline for legacy Netflix data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10207 used Netflix on Game Console under the Premium plan costing $28.91 in region CN.",
    "output": {
      "customer_id": "CUST-10207",
      "service_name": "Netflix",
      "subscription_plan": "Premium",
      "monthly_price_usd": 28.91,
      "device_type": "Game Console",
      "region": "CN",
      "usage_hours": 6.36,
      "event_timestamp": "2024-02-26T02:03:25"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Twitch subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_twitch_stream",
      "description": "Real-time streaming pipeline for Twitch events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Disney+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10358 used Netflix on Mobile under the Premium plan costing $7.00 in region ES.",
    "output": {
      "customer_id": "CUST-10358",
      "service_name": "Netflix",
      "subscription_plan": "Premium",
      "monthly_price_usd": 7.0,
      "device_type": "Mobile",
      "region": "ES",
      "usage_hours": 9.18,
      "event_timestamp": "2024-08-13T03:10:31"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10234 used Amazon Prime Video on Game Console under the Basic plan costing $9.08 in region AU.",
    "output": {
      "customer_id": "CUST-10234",
      "service_name": "Amazon Prime Video",
      "subscription_plan": "Basic",
      "monthly_price_usd": 9.08,
      "device_type": "Game Console",
      "region": "AU",
      "usage_hours": 7.15,
      "event_timestamp": "2024-05-25T17:50:41"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10056 used Discovery+ on Laptop under the Basic plan costing $21.18 in region SG.",
    "output": {
      "customer_id": "CUST-10056",
      "service_name": "Discovery+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 21.18,
      "device_type": "Laptop",
      "region": "SG",
      "usage_hours": 2.36,
      "event_timestamp": "2024-11-23T13:40:28"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process HBO Max subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_hbo_max_agg",
      "description": "Weekly aggregation pipeline for HBO Max metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10306 used Crunchyroll on Mobile under the Annual plan costing $22.64 in region UK.",
    "output": {
      "customer_id": "CUST-10306",
      "service_name": "Crunchyroll",
      "subscription_plan": "Annual",
      "monthly_price_usd": 22.64,
      "device_type": "Mobile",
      "region": "UK",
      "usage_hours": 5.78,
      "event_timestamp": "2024-06-05T23:10:59"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10186 used Peacock on Laptop under the Student plan costing $22.67 in region AU.",
    "output": {
      "customer_id": "CUST-10186",
      "service_name": "Peacock",
      "subscription_plan": "Student",
      "monthly_price_usd": 22.67,
      "device_type": "Laptop",
      "region": "AU",
      "usage_hours": 11.57,
      "event_timestamp": "2024-06-14T04:51:26"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10201 used Twitch on Desktop under the Premium plan costing $28.16 in region IT.",
    "output": {
      "customer_id": "CUST-10201",
      "service_name": "Twitch",
      "subscription_plan": "Premium",
      "monthly_price_usd": 28.16,
      "device_type": "Desktop",
      "region": "IT",
      "usage_hours": 10.47,
      "event_timestamp": "2024-02-17T22:18:55"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Twitch subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_twitch_stream",
      "description": "Real-time streaming pipeline for Twitch events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process HBO Max subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_hbo_max_etl",
      "description": "Daily ETL pipeline for HBO Max subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10113 used Spotify on Desktop under the Family plan costing $12.68 in region CN.",
    "output": {
      "customer_id": "CUST-10113",
      "service_name": "Spotify",
      "subscription_plan": "Family",
      "monthly_price_usd": 12.68,
      "device_type": "Desktop",
      "region": "CN",
      "usage_hours": 5.57,
      "event_timestamp": "2024-06-21T04:50:31"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10190 used Discovery+ on Laptop under the Premium plan costing $10.84 in region AU.",
    "output": {
      "customer_id": "CUST-10190",
      "service_name": "Discovery+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 10.84,
      "device_type": "Laptop",
      "region": "AU",
      "usage_hours": 2.17,
      "event_timestamp": "2024-03-17T20:33:12"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10165 used Hulu on Smart TV under the Basic plan costing $7.76 in region MX.",
    "output": {
      "customer_id": "CUST-10165",
      "service_name": "Hulu",
      "subscription_plan": "Basic",
      "monthly_price_usd": 7.76,
      "device_type": "Smart TV",
      "region": "MX",
      "usage_hours": 6.82,
      "event_timestamp": "2024-04-19T03:40:32"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Disney+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "7x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Peacock subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Twitch subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_twitch_etl",
      "description": "Daily ETL pipeline for Twitch subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10382 used ESPN+ on Smart TV under the Family plan costing $5.90 in region IT.",
    "output": {
      "customer_id": "CUST-10382",
      "service_name": "ESPN+",
      "subscription_plan": "Family",
      "monthly_price_usd": 5.9,
      "device_type": "Smart TV",
      "region": "IT",
      "usage_hours": 9.43,
      "event_timestamp": "2024-09-12T03:42:53"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process HBO Max subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_hbo_max_legacy",
      "description": "Migration pipeline for legacy HBO Max data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Crunchyroll subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_crunchyroll_agg",
      "description": "Weekly aggregation pipeline for Crunchyroll metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10325 used Paramount+ on Tablet under the Premium plan costing $19.90 in region MX.",
    "output": {
      "customer_id": "CUST-10325",
      "service_name": "Paramount+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 19.9,
      "device_type": "Tablet",
      "region": "MX",
      "usage_hours": 9.21,
      "event_timestamp": "2024-02-26T23:18:48"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Hulu subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10054 used Apple Music on Game Console under the Annual plan costing $11.10 in region US.",
    "output": {
      "customer_id": "CUST-10054",
      "service_name": "Apple Music",
      "subscription_plan": "Annual",
      "monthly_price_usd": 11.1,
      "device_type": "Game Console",
      "region": "US",
      "usage_hours": 4.08,
      "event_timestamp": "2024-05-28T06:45:58"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Spotify subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_spotify_agg",
      "description": "Weekly aggregation pipeline for Spotify metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple Music subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_apple_music_stream",
      "description": "Real-time streaming pipeline for Apple Music events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple TV+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_apple_tv+_legacy",
      "description": "Migration pipeline for legacy Apple TV+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process YouTube Premium subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_youtube_premium_etl",
      "description": "Daily ETL pipeline for YouTube Premium subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Crunchyroll subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Peacock subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_peacock_legacy",
      "description": "Migration pipeline for legacy Peacock data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10147 used Peacock on Mobile under the Annual plan costing $16.67 in region UK.",
    "output": {
      "customer_id": "CUST-10147",
      "service_name": "Peacock",
      "subscription_plan": "Annual",
      "monthly_price_usd": 16.67,
      "device_type": "Mobile",
      "region": "UK",
      "usage_hours": 1.63,
      "event_timestamp": "2024-12-03T00:43:32"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10299 used Apple Music on Laptop under the Basic plan costing $13.23 in region DE.",
    "output": {
      "customer_id": "CUST-10299",
      "service_name": "Apple Music",
      "subscription_plan": "Basic",
      "monthly_price_usd": 13.23,
      "device_type": "Laptop",
      "region": "DE",
      "usage_hours": 1.3,
      "event_timestamp": "2024-08-28T23:04:36"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking HBO Max subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_hulu_legacy",
      "description": "Migration pipeline for legacy Hulu data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Peacock subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_peacock_legacy",
      "description": "Migration pipeline for legacy Peacock data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "14x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10120 used YouTube Premium on Smart TV under the Annual plan costing $7.26 in region MX.",
    "output": {
      "customer_id": "CUST-10120",
      "service_name": "YouTube Premium",
      "subscription_plan": "Annual",
      "monthly_price_usd": 7.26,
      "device_type": "Smart TV",
      "region": "MX",
      "usage_hours": 9.07,
      "event_timestamp": "2024-01-09T19:04:14"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10064 used Crunchyroll on Laptop under the Student plan costing $20.84 in region SG.",
    "output": {
      "customer_id": "CUST-10064",
      "service_name": "Crunchyroll",
      "subscription_plan": "Student",
      "monthly_price_usd": 20.84,
      "device_type": "Laptop",
      "region": "SG",
      "usage_hours": 7.35,
      "event_timestamp": "2024-06-13T06:47:35"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Peacock subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_peacock_stream",
      "description": "Real-time streaming pipeline for Peacock events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple Music subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10300 used Twitch on Desktop under the Annual plan costing $14.17 in region MX.",
    "output": {
      "customer_id": "CUST-10300",
      "service_name": "Twitch",
      "subscription_plan": "Annual",
      "monthly_price_usd": 14.17,
      "device_type": "Desktop",
      "region": "MX",
      "usage_hours": 7.65,
      "event_timestamp": "2024-02-26T23:29:37"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Disney+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10337 used Apple TV+ on Laptop under the Annual plan costing $25.66 in region AU.",
    "output": {
      "customer_id": "CUST-10337",
      "service_name": "Apple TV+",
      "subscription_plan": "Annual",
      "monthly_price_usd": 25.66,
      "device_type": "Laptop",
      "region": "AU",
      "usage_hours": 6.26,
      "event_timestamp": "2024-12-17T04:43:10"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Crunchyroll subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking ESPN+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple Music subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Disney+ subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_disney+_etl",
      "description": "Daily ETL pipeline for Disney+ subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10008 used Netflix on Smart TV under the Family plan costing $9.74 in region SG.",
    "output": {
      "customer_id": "CUST-10008",
      "service_name": "Netflix",
      "subscription_plan": "Family",
      "monthly_price_usd": 9.74,
      "device_type": "Smart TV",
      "region": "SG",
      "usage_hours": 6.66,
      "event_timestamp": "2024-12-02T20:38:21"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10160 used Amazon Prime Video on Game Console under the Family plan costing $12.61 in region IT.",
    "output": {
      "customer_id": "CUST-10160",
      "service_name": "Amazon Prime Video",
      "subscription_plan": "Family",
      "monthly_price_usd": 12.61,
      "device_type": "Game Console",
      "region": "IT",
      "usage_hours": 4.81,
      "event_timestamp": "2024-05-02T09:47:59"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "14x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10191 used Peacock on Tablet under the Premium plan costing $28.25 in region UK.",
    "output": {
      "customer_id": "CUST-10191",
      "service_name": "Peacock",
      "subscription_plan": "Premium",
      "monthly_price_usd": 28.25,
      "device_type": "Tablet",
      "region": "UK",
      "usage_hours": 6.98,
      "event_timestamp": "2024-03-16T22:49:03"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10392 used Disney+ on Game Console under the Family plan costing $25.71 in region IT.",
    "output": {
      "customer_id": "CUST-10392",
      "service_name": "Disney+",
      "subscription_plan": "Family",
      "monthly_price_usd": 25.71,
      "device_type": "Game Console",
      "region": "IT",
      "usage_hours": 4.37,
      "event_timestamp": "2024-04-20T04:13:08"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking YouTube Premium subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10281 used Crunchyroll on Game Console under the Premium plan costing $28.74 in region CN.",
    "output": {
      "customer_id": "CUST-10281",
      "service_name": "Crunchyroll",
      "subscription_plan": "Premium",
      "monthly_price_usd": 28.74,
      "device_type": "Game Console",
      "region": "CN",
      "usage_hours": 9.07,
      "event_timestamp": "2024-11-01T04:41:10"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_hulu_agg",
      "description": "Weekly aggregation pipeline for Hulu metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Hulu subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10305 used ESPN+ on Game Console under the Annual plan costing $12.18 in region MX.",
    "output": {
      "customer_id": "CUST-10305",
      "service_name": "ESPN+",
      "subscription_plan": "Annual",
      "monthly_price_usd": 12.18,
      "device_type": "Game Console",
      "region": "MX",
      "usage_hours": 5.09,
      "event_timestamp": "2024-09-11T17:06:51"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Twitch subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_twitch_etl",
      "description": "Daily ETL pipeline for Twitch subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_hulu_agg",
      "description": "Weekly aggregation pipeline for Hulu metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process ESPN+ subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_espn+_legacy",
      "description": "Migration pipeline for legacy ESPN+ data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10387 used Apple Music on Laptop under the Premium plan costing $9.37 in region SG.",
    "output": {
      "customer_id": "CUST-10387",
      "service_name": "Apple Music",
      "subscription_plan": "Premium",
      "monthly_price_usd": 9.37,
      "device_type": "Laptop",
      "region": "SG",
      "usage_hours": 11.89,
      "event_timestamp": "2024-03-23T08:25:39"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking ESPN+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Disney+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Peacock subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_peacock_legacy",
      "description": "Migration pipeline for legacy Peacock data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10075 used Disney+ on Laptop under the Premium plan costing $27.94 in region US.",
    "output": {
      "customer_id": "CUST-10075",
      "service_name": "Disney+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 27.94,
      "device_type": "Laptop",
      "region": "US",
      "usage_hours": 4.11,
      "event_timestamp": "2024-06-17T11:50:19"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Crunchyroll subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10036 used HBO Max on Smart TV under the Family plan costing $22.48 in region JP.",
    "output": {
      "customer_id": "CUST-10036",
      "service_name": "HBO Max",
      "subscription_plan": "Family",
      "monthly_price_usd": 22.48,
      "device_type": "Smart TV",
      "region": "JP",
      "usage_hours": 11.96,
      "event_timestamp": "2024-04-09T10:33:07"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple Music subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Peacock subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_peacock_agg",
      "description": "Weekly aggregation pipeline for Peacock metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Discovery+ subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_discovery+_etl",
      "description": "Daily ETL pipeline for Discovery+ subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Peacock subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_peacock_legacy",
      "description": "Migration pipeline for legacy Peacock data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10084 used Netflix on Game Console under the Basic plan costing $27.22 in region AU.",
    "output": {
      "customer_id": "CUST-10084",
      "service_name": "Netflix",
      "subscription_plan": "Basic",
      "monthly_price_usd": 27.22,
      "device_type": "Game Console",
      "region": "AU",
      "usage_hours": 11.13,
      "event_timestamp": "2024-06-04T13:23:47"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process HBO Max subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_hbo_max_etl",
      "description": "Daily ETL pipeline for HBO Max subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "12x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_paramount+_stream",
      "description": "Real-time streaming pipeline for Paramount+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10055 used Spotify on Tablet under the Premium plan costing $10.23 in region CN.",
    "output": {
      "customer_id": "CUST-10055",
      "service_name": "Spotify",
      "subscription_plan": "Premium",
      "monthly_price_usd": 10.23,
      "device_type": "Tablet",
      "region": "CN",
      "usage_hours": 6.26,
      "event_timestamp": "2024-08-24T16:38:13"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "11x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_paramount+_stream",
      "description": "Real-time streaming pipeline for Paramount+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "weekly_hulu_agg",
      "description": "Weekly aggregation pipeline for Hulu metrics",
      "frequency": "weekly",
      "schedule": "Sunday 02:00 UTC",
      "source": "data warehouse",
      "destination": "aggregation tables",
      "transformations": [
        "rollup aggregation",
        "metric calculation",
        "trend analysis"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Netflix subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_netflix_legacy",
      "description": "Migration pipeline for legacy Netflix data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "7x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10001 used Paramount+ on Desktop under the Student plan costing $5.25 in region IT.",
    "output": {
      "customer_id": "CUST-10001",
      "service_name": "Paramount+",
      "subscription_plan": "Student",
      "monthly_price_usd": 5.25,
      "device_type": "Desktop",
      "region": "IT",
      "usage_hours": 6.5,
      "event_timestamp": "2024-03-13T06:46:28"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "10x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Hulu subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Crunchyroll subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_crunchyroll_etl",
      "description": "Daily ETL pipeline for Crunchyroll subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10052 used Crunchyroll on Desktop under the Family plan costing $19.94 in region DE.",
    "output": {
      "customer_id": "CUST-10052",
      "service_name": "Crunchyroll",
      "subscription_plan": "Family",
      "monthly_price_usd": 19.94,
      "device_type": "Desktop",
      "region": "DE",
      "usage_hours": 2.26,
      "event_timestamp": "2024-09-26T22:05:26"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Hulu subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Paramount+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_paramount+_stream",
      "description": "Real-time streaming pipeline for Paramount+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Hulu subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10312 used Paramount+ on Tablet under the Basic plan costing $14.99 in region CN.",
    "output": {
      "customer_id": "CUST-10312",
      "service_name": "Paramount+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 14.99,
      "device_type": "Tablet",
      "region": "CN",
      "usage_hours": 5.03,
      "event_timestamp": "2024-11-19T11:18:45"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10040 used Apple TV+ on Game Console under the Student plan costing $21.34 in region FR.",
    "output": {
      "customer_id": "CUST-10040",
      "service_name": "Apple TV+",
      "subscription_plan": "Student",
      "monthly_price_usd": 21.34,
      "device_type": "Game Console",
      "region": "FR",
      "usage_hours": 5.93,
      "event_timestamp": "2024-06-24T21:11:04"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10168 used Hulu on Laptop under the Student plan costing $7.07 in region CN.",
    "output": {
      "customer_id": "CUST-10168",
      "service_name": "Hulu",
      "subscription_plan": "Student",
      "monthly_price_usd": 7.07,
      "device_type": "Laptop",
      "region": "CN",
      "usage_hours": 1.67,
      "event_timestamp": "2024-02-24T10:27:20"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "12x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Crunchyroll subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "13x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
    "output": {
      "original_query": "SELECT * FROM subscriptions WHERE DATE(event_timestamp) = '2024-06-15' AND region = 'AU'",
      "optimized_query": "SELECT * FROM subscriptions WHERE event_timestamp >= '2024-06-15' AND event_timestamp < '2024-06-16' AND region = 'AU'",
      "optimizations": [
        "Replace DATE() function with range comparison",
        "Add index on (region, event_timestamp)"
      ],
      "expected_improvement": "14x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10284 used Discovery+ on Tablet under the Premium plan costing $15.69 in region FR.",
    "output": {
      "customer_id": "CUST-10284",
      "service_name": "Discovery+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 15.69,
      "device_type": "Tablet",
      "region": "FR",
      "usage_hours": 7.64,
      "event_timestamp": "2024-07-17T09:25:18"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "4x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10267 used YouTube Premium on Tablet under the Basic plan costing $21.10 in region JP.",
    "output": {
      "customer_id": "CUST-10267",
      "service_name": "YouTube Premium",
      "subscription_plan": "Basic",
      "monthly_price_usd": 21.1,
      "device_type": "Tablet",
      "region": "JP",
      "usage_hours": 0.92,
      "event_timestamp": "2024-01-19T15:49:30"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Amazon Prime Video subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Hulu subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_hulu_etl",
      "description": "Daily ETL pipeline for Hulu subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking HBO Max subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Crunchyroll subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking ESPN+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking YouTube Premium subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "5x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10245 used ESPN+ on Game Console under the Family plan costing $28.74 in region CN.",
    "output": {
      "customer_id": "CUST-10245",
      "service_name": "ESPN+",
      "subscription_plan": "Family",
      "monthly_price_usd": 28.74,
      "device_type": "Game Console",
      "region": "CN",
      "usage_hours": 4.17,
      "event_timestamp": "2024-06-19T07:12:04"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "7x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10096 used Paramount+ on Mobile under the Premium plan costing $21.00 in region KR.",
    "output": {
      "customer_id": "CUST-10096",
      "service_name": "Paramount+",
      "subscription_plan": "Premium",
      "monthly_price_usd": 21.0,
      "device_type": "Mobile",
      "region": "KR",
      "usage_hours": 10.02,
      "event_timestamp": "2024-11-20T18:48:53"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Disney+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking HBO Max subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple TV+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_apple_tv+_stream",
      "description": "Real-time streaming pipeline for Apple TV+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10058 used YouTube Premium on Laptop under the Student plan costing $7.34 in region IT.",
    "output": {
      "customer_id": "CUST-10058",
      "service_name": "YouTube Premium",
      "subscription_plan": "Student",
      "monthly_price_usd": 7.34,
      "device_type": "Laptop",
      "region": "IT",
      "usage_hours": 11.38,
      "event_timestamp": "2024-06-14T12:20:32"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Spotify subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Apple TV+ subscription data for analytics.",
    "output": {
      "pipeline_name": "realtime_apple_tv+_stream",
      "description": "Real-time streaming pipeline for Apple TV+ events",
      "frequency": "continuous",
      "schedule": "24/7 streaming",
      "source": "Kafka topics",
      "destination": "AWS Redshift",
      "transformations": [
        "stream processing",
        "windowing",
        "aggregation"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "3x faster execution"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Twitch subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_twitch_etl",
      "description": "Daily ETL pipeline for Twitch subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Amazon Prime Video subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_amazon_prime_video_etl",
      "description": "Daily ETL pipeline for Amazon Prime Video subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Apple TV+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10344 used Paramount+ on Smart TV under the Annual plan costing $26.00 in region MX.",
    "output": {
      "customer_id": "CUST-10344",
      "service_name": "Paramount+",
      "subscription_plan": "Annual",
      "monthly_price_usd": 26.0,
      "device_type": "Smart TV",
      "region": "MX",
      "usage_hours": 2.18,
      "event_timestamp": "2024-04-18T08:42:39"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Discovery+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10237 used Apple TV+ on Smart TV under the Basic plan costing $14.55 in region FR.",
    "output": {
      "customer_id": "CUST-10237",
      "service_name": "Apple TV+",
      "subscription_plan": "Basic",
      "monthly_price_usd": 14.55,
      "device_type": "Smart TV",
      "region": "FR",
      "usage_hours": 10.62,
      "event_timestamp": "2024-10-05T09:36:32"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Twitch subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Crunchyroll subscription data for analytics.",
    "output": {
      "pipeline_name": "daily_crunchyroll_etl",
      "description": "Daily ETL pipeline for Crunchyroll subscription data",
      "frequency": "daily",
      "schedule": "00:30 UTC",
      "source": "CSV files in S3",
      "destination": "Snowflake data warehouse",
      "transformations": [
        "data validation",
        "type conversion",
        "enrichment"
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10009 used ESPN+ on Game Console under the Student plan costing $13.99 in region AU.",
    "output": {
      "customer_id": "CUST-10009",
      "service_name": "ESPN+",
      "subscription_plan": "Student",
      "monthly_price_usd": 13.99,
      "device_type": "Game Console",
      "region": "AU",
      "usage_hours": 6.82,
      "event_timestamp": "2024-04-22T20:54:59"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10141 used ESPN+ on Tablet under the Family plan costing $11.46 in region UK.",
    "output": {
      "customer_id": "CUST-10141",
      "service_name": "ESPN+",
      "subscription_plan": "Family",
      "monthly_price_usd": 11.46,
      "device_type": "Tablet",
      "region": "UK",
      "usage_hours": 10.56,
      "event_timestamp": "2024-08-16T20:05:33"
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Amazon Prime Video subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_amazon_prime_video_legacy",
      "description": "Migration pipeline for legacy Amazon Prime Video data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Netflix subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Paramount+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
    "output": {
      "original_query": "SELECT c.*, s.service_name FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.region = 'US'",
      "optimized_query": "SELECT c.*, s.service_name FROM subscriptions s JOIN customers c ON s.customer_id = c.customer_id WHERE s.region = 'US'",
      "optimizations": [
        "Reorder join to start with smaller table",
        "Add index on subscriptions.customer_id"
      ],
      "expected_improvement": "6x faster execution"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Peacock subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        },
        {
          "table_name": "usage_metrics",
          "columns": [
            {
              "name": "usage_id",
              "type": "BIGINT",
              "primary_key": true,
              "nullable": false,
              "auto_increment": true
            },
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "nullable": false,
              "foreign_key": "subscriptions.subscription_id"
            },
            {
              "name": "event_timestamp",
              "type": "TIMESTAMP",
              "nullable": false
            },
            {
              "name": "usage_hours",
              "type": "DECIMAL(5,2)",
              "nullable": false
            },
            {
              "name": "device_type",
              "type": "VARCHAR(50)",
              "nullable": false
            }
          ],
          "indexes": [
            "usage_id",
            "subscription_id",
            "event_timestamp"
          ]
        },
        {
          "table_name": "service_catalog",
          "columns": [
            {
              "name": "service_id",
              "type": "INT",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "category",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "supported_regions",
              "type": "JSON",
              "nullable": true
            },
            {
              "name": "device_support",
              "type": "JSON",
              "nullable": true
            }
          ],
          "indexes": [
            "service_id",
            "service_name"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id",
        "subscriptions.subscription_id → usage_metrics.subscription_id"
      ]
    }
  },
  {
    "task_type": "etl_pipeline",
    "input": "Design an ETL pipeline to process Spotify subscription data for analytics.",
    "output": {
      "pipeline_name": "migrate_spotify_legacy",
      "description": "Migration pipeline for legacy Spotify data",
      "frequency": "one_time",
      "schedule": "adhoc",
      "source": "legacy database",
      "destination": "modern data platform",
      "transformations": [
        "schema mapping",
        "data cleansing",
        "consistency checks"
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
    "output": {
      "original_query": "SELECT * FROM customers WHERE customer_id IN (SELECT customer_id FROM subscriptions WHERE monthly_price_usd > 20)",
      "optimized_query": "SELECT c.* FROM customers c JOIN subscriptions s ON c.customer_id = s.customer_id WHERE s.monthly_price_usd > 20",
      "optimizations": [
        "Replace IN subquery with JOIN",
        "Add index on subscriptions.monthly_price_usd"
      ],
      "expected_improvement": "8x faster execution"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ101",
          "rule_name": "price_plan_consistency",
          "rule": "CASE WHEN subscription_plan = 'Basic' THEN monthly_price_usd <= 9.99 WHEN subscription_plan = 'Family' THEN monthly_price_usd <= 19.99 WHEN subscription_plan = 'Premium' THEN monthly_price_usd <= 29.99 ELSE true END",
          "severity": "critical",
          "description": "Price must be consistent with plan type"
        },
        {
          "rule_id": "DQ102",
          "rule_name": "usage_hours_range",
          "rule": "usage_hours >= 0 AND usage_hours <= 24",
          "severity": "warning",
          "description": "Usage hours must be reasonable"
        }
      ]
    }
  },
  {
    "task_type": "sql_optimization",
    "input": "Optimize this SQL query: SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
    "output": {
      "original_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimized_query": "SELECT service_name, COUNT(*) as total_subscriptions FROM subscriptions WHERE event_timestamp >= '2024-01-01' GROUP BY service_name ORDER BY total_subscriptions DESC",
      "optimizations": [
        "Add WHERE clause to reduce data",
        "Use materialized view for frequent aggregations"
      ],
      "expected_improvement": "9x faster execution"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10065 used Twitch on Laptop under the Family plan costing $20.25 in region US.",
    "output": {
      "customer_id": "CUST-10065",
      "service_name": "Twitch",
      "subscription_plan": "Family",
      "monthly_price_usd": 20.25,
      "device_type": "Laptop",
      "region": "US",
      "usage_hours": 7.6,
      "event_timestamp": "2024-12-01T11:39:46"
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10116 used Spotify on Laptop under the Family plan costing $5.86 in region IN.",
    "output": {
      "customer_id": "CUST-10116",
      "service_name": "Spotify",
      "subscription_plan": "Family",
      "monthly_price_usd": 5.86,
      "device_type": "Laptop",
      "region": "IN",
      "usage_hours": 2.33,
      "event_timestamp": "2024-05-02T16:22:40"
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ001",
          "rule_name": "customer_id_not_null",
          "rule": "customer_id IS NOT NULL",
          "severity": "critical",
          "description": "Customer ID must be present"
        },
        {
          "rule_id": "DQ002",
          "rule_name": "service_name_valid",
          "rule": "service_name IN ('Netflix', 'Amazon Prime Video', 'Disney+', 'Apple Music', 'Spotify')",
          "severity": "critical",
          "description": "Service name must be from approved list"
        }
      ]
    }
  },
  {
    "task_type": "extraction",
    "input": "Extract subscription usage details:\nCustomer 10279 used Peacock on Smart TV under the Student plan costing $8.82 in region IT.",
    "output": {
      "customer_id": "CUST-10279",
      "service_name": "Peacock",
      "subscription_plan": "Student",
      "monthly_price_usd": 8.82,
      "device_type": "Smart TV",
      "region": "IT",
      "usage_hours": 11.82,
      "event_timestamp": "2024-12-28T21:23:54"
    }
  },
  {
    "task_type": "schema_inference",
    "input": "Design a database schema for tracking Paramount+ subscription usage. Include customer details, subscription info, and usage metrics.",
    "output": {
      "tables": [
        {
          "table_name": "customers",
          "columns": [
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "email",
              "type": "VARCHAR(255)",
              "nullable": false
            },
            {
              "name": "signup_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "country",
              "type": "VARCHAR(2)",
              "nullable": false
            },
            {
              "name": "preferred_device",
              "type": "VARCHAR(50)",
              "nullable": true
            }
          ],
          "indexes": [
            "customer_id",
            "email",
            "signup_date",
            "country"
          ]
        },
        {
          "table_name": "subscriptions",
          "columns": [
            {
              "name": "subscription_id",
              "type": "VARCHAR(30)",
              "primary_key": true,
              "nullable": false
            },
            {
              "name": "customer_id",
              "type": "VARCHAR(20)",
              "nullable": false,
              "foreign_key": "customers.customer_id"
            },
            {
              "name": "service_name",
              "type": "VARCHAR(100)",
              "nullable": false
            },
            {
              "name": "subscription_plan",
              "type": "VARCHAR(50)",
              "nullable": false
            },
            {
              "name": "monthly_price_usd",
              "type": "DECIMAL(10,2)",
              "nullable": false
            },
            {
              "name": "start_date",
              "type": "DATE",
              "nullable": false
            },
            {
              "name": "end_date",
              "type": "DATE",
              "nullable": true
            },
            {
              "name": "is_active",
              "type": "BOOLEAN",
              "nullable": false,
              "default": "true"
            }
          ],
          "indexes": [
            "subscription_id",
            "customer_id",
            "service_name",
            "is_active",
            "start_date"
          ]
        }
      ],
      "relationships": [
        "customers.customer_id → subscriptions.customer_id"
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ301",
          "rule_name": "event_timestamp_not_future",
          "rule": "event_timestamp <= CURRENT_TIMESTAMP",
          "severity": "critical",
          "description": "Event timestamp cannot be in the future"
        },
        {
          "rule_id": "DQ302",
          "rule_name": "signup_before_usage",
          "rule": "event_timestamp >= (SELECT signup_date FROM customers c WHERE c.customer_id = subscriptions.customer_id)",
          "severity": "critical",
          "description": "Usage must occur after signup"
        }
      ]
    }
  },
  {
    "task_type": "data_quality",
    "input": "Generate data quality rules for subscription data with fields: customer_id, service_name, subscription_plan, monthly_price_usd, device_type, region, usage_hours, event_timestamp",
    "output": {
      "table_name": "subscriptions",
      "quality_rules": [
        {
          "rule_id": "DQ201",
          "rule_name": "device_region_compatibility",
          "rule": "NOT (device_type = 'Game Console' AND region IN ('IN', 'BR')) OR service_name = 'Game Pass'",
          "severity": "warning",
          "description": "Device-region compatibility check"
        },
        {
          "rule_id": "DQ202",
          "rule_name": "subscription_duration",
          "rule": "DATEDIFF(day, start_date, COALESCE(end_date, CURRENT_DATE)) >= 0",
          "severity": "critical",
          "description": "End date must be after start date"
        }
      ]
    }
  }
]